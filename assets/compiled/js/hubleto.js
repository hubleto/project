(()=>{var e,t,a,s={866:()=>{},1244:(e,t,a)=>{"use strict";var s=a(9471),r=a(6643),n=a(4721),i=a(4457),l=a(6797),o=(a(6771),a(9913));class c extends n.A{static defaultProps={...n.A.defaultProps,model:"HubletoApp/Community/Reports/Models/Team"};translationContext="HubletoApp\\Community\\Reports::Components\\FormReport";constructor(e){super(e)}renderTitle(){return s.createElement(s.Fragment,null,s.createElement("h2",null,"Record #",this.state.record.id??"0"),s.createElement("small",null,"Report"))}renderContent(){const e=this.state.record;return console.log(e,e._QUERY_BUILDER.fields),s.createElement(s.Fragment,null,s.createElement("div",{className:"w-full flex gap-2"},s.createElement("div",{className:"flex-1 border-r border-gray-100"},this.inputWrapper("title"),this.inputWrapper("model")),s.createElement("div",{className:"flex-1"},this.inputWrapper("notes"))),this.divider("Query"),s.createElement("div",{className:"w-full flex gap-2"},s.createElement("div",{className:"flex-1 border-r border-gray-100"},s.createElement(i.oS,{fields:e._QUERY_BUILDER.fields,defaultQuery:(0,o.parseJsonLogic)(e.query),onQueryChange:e=>{this.updateRecord({query:JSON.stringify((0,l.OJZ)(e,{format:"jsonlogic"}))}),console.log((0,l.OJZ)(e,{format:"natural_language",parseNumbers:!0,getOperators:()=>l.lVp,fields:[{value:"firstName",label:"First Name"},{value:"lastName",label:"Last Name"},{value:"age",label:"Age"}]}))}})),s.createElement("div",{className:"flex-1"},this.inputWrapper("query",{readonly:!0}))))}}class d extends r.A{static defaultProps={...r.A.defaultProps,formUseModalSimple:!0,model:"HubletoApp/Community/Reports/Models/Report"};translationContext="HubletoApp\\Community\\Reports::Components\\TableReports";constructor(e){super(e),this.state=this.getStateFromProps(e)}getStateFromProps(e){return{...super.getStateFromProps(e)}}getFormModalProps(){let e=super.getFormModalProps();return e.type="right wide",e}getEndpointParams(){return{...super.getEndpointParams()}}renderForm(){let e=this.getFormProps();return s.createElement(c,e)}}globalThis.main.registerReactComponent("ReportsTableReports",d)},1596:(e,t,a)=>{"use strict";var s=a(9471),r=a(1056),n=a(1194);class i extends n.A{static defaultProps={...n.A.defaultProps,model:"HubletoApp/Community/Customers/Models/CustomerActivity"};translationContext="HubletoApp\\Community\\CalendarSync\\Loader::Components\\FormSource";renderContent(){return s.createElement(s.Fragment,null,this.inputWrapper("name"),this.inputWrapper("type"),this.inputWrapper("link"),"google"==this.state.record.type?s.createElement("div",{className:"alert-info mt-1"},"Enter the Calendar ID from the settings of your calendar in Google Calendar (look at the bottom of the page).",s.createElement("br",null)," It should be in the form of ",s.createElement("span",null,"<","Google Calendar identifier",">","@group.calendar.google.com"),".",s.createElement("br",null)," The calendar must also be set to public or the API Key specified in the config file must have access to it."):s.createElement(s.Fragment,null),"ics"==this.state.record.type?s.createElement("div",{className:"alert-info mt-1"},"Enter the URL that points to an ICS file."):s.createElement(s.Fragment,null),this.inputWrapper("color"),this.inputWrapper("active"),"google"==this.state.record.type?s.createElement("div",{className:"alert-warning mt-1"},"When using Google calendar, make sure you define an API key in ConfigEnv.php: $config['google-api-key'] = ..."):s.createElement(s.Fragment,null))}}class l extends r.A{static defaultProps={...r.A.defaultProps,formUseModalSimple:!0,model:"HubletoApp/Community/CalendarSync/Models/Source"};translationContext="HubletoApp\\Community\\CalendarSync\\Loader::Components\\TableSources";constructor(e){super(e),this.state=this.getStateFromProps(e)}renderForm(){let e=this.getFormProps();return s.createElement(i,e)}}globalThis.main.registerReactComponent("TableCalendarSyncSources",l)},1767:()=>{},1895:(e,t,a)=>{"use strict";var s=a(9471),r=a(6643),n=a(4721),i=a(9348),l=a(1612),o=a(2921);class c extends r.A{static defaultProps={...r.A.defaultProps,formUseModalSimple:!0,model:"HubletoApp/Community/Discussions/Models/Message"};translationContext="HubletoApp\\Community\\Discussions::Components\\Messages";constructor(e){super(e),this.refMessageTextarea=s.createRef(),this.state=this.getStateFromProps(e)}getStateFromProps(e){return{...super.getStateFromProps(e)}}getFormModalProps(){let e=super.getFormModalProps();return e.type="right wide",e}getEndpointParams(){return{...super.getEndpointParams(),idDiscussion:this.props.idDiscussion}}render(){return this.state.data?s.createElement(s.Fragment,null,s.createElement("div",{className:"list"},Object.keys(this.state.data.data??{}).map(e=>{const t=this.state.data.data[e];return s.createElement("div",{className:"btn btn-list-item btn-transparent gap-2 p-2 justify-between  ",key:e},s.createElement("div",null,s.createElement("div",null,t.id_from!=globalThis.main.idUser&&t.FROM?.nick?s.createElement("span",{className:"badge"},t.FROM?.nick):s.createElement("span",{className:"badge badge-blue"},"you"),s.createElement("small",{className:"ml-2"},t.sent),s.createElement("br",null)),s.createElement("div",null,s.createElement(o.Ay,null,t.message))))})),s.createElement("div",{className:"flex gap-2 items-end"},s.createElement("div",{className:"grow"},s.createElement("textarea",{id:this.props.uid+"_message",className:"w-full h-24 shadow mt-2 border-gray-200",ref:this.refMessageTextarea,placeholder:"Type your message here..."})),s.createElement("div",{className:"shrink"},s.createElement("button",{className:"btn btn-large mb-2",onClick:()=>{l.A.post("discussions/api/send-message",{idDiscussion:this.props.idDiscussion,message:this.refMessageTextarea.current.value},{},e=>{let t=this.state.data;t.data.push(e.sentMessage),this.setState({data:t},()=>{this.refMessageTextarea.current.value=""})})}},s.createElement("span",{className:"icon"},s.createElement("i",{className:"fas fa-paper-plane"}))))),"Tip: You can use **markdown** syntax."):s.createElement(i.z,{mode:"indeterminate",style:{height:"8px"}})}}class d extends n.A{static defaultProps={...n.A.defaultProps,model:"HubletoApp/Community/Discussions/Models/Discussion"};translationContext="HubletoApp\\Community\\Discussions::Components\\FormDiscussion";constructor(e){super(e),this.state=this.getStateFromProps(e)}getStateFromProps(e){let t={};return t=this.props.id<0?{default:{title:"About"}}:{default:{title:"Messages"},about:{title:"About"}},{...super.getStateFromProps(e),tabs:t}}renderTitle(){return s.createElement(s.Fragment,null,s.createElement("h2",null,this.state.record.topic??"-"),s.createElement("small",null,"Discussion"))}renderTab(e){const t=this.state.record,a=s.createElement("div",{className:"w-full flex gap-2 flex-col md:flex-row"},s.createElement("div",{className:"flex-1 border-r border-gray-100"},this.inputWrapper("topic"),this.inputWrapper("description"),this.inputWrapper("id_main_mod"),this.inputWrapper("is_closed")),s.createElement("div",{className:"flex-1"},this.inputWrapper("notes"),this.inputWrapper("date_created"),s.createElement("div",{className:"flex w-full gap-2"},this.inputWrapper("external_model"),this.inputWrapper("external_id")))),r=s.createElement(c,{uid:this.props.uid+"_table_messages",tag:"DiscussionMessages",parentForm:this,idDiscussion:t.id});switch(e){case"default":return this.state.id<0?a:r;case"about":return this.state.id<0?null:a}}}class m extends r.A{static defaultProps={...r.A.defaultProps,formUseModalSimple:!0,model:"HubletoApp/Community/Discussions/Models/Discussion"};translationContext="HubletoApp\\Community\\Discussions::Components\\TableDiscussions";constructor(e){super(e),this.state=this.getStateFromProps(e)}getStateFromProps(e){return{...super.getStateFromProps(e)}}getFormModalProps(){let e=super.getFormModalProps();return e.type="right wide",e}getEndpointParams(){return{...super.getEndpointParams(),externalModel:this.props.externalModel,externalId:this.props.externalId}}renderForm(){let e=this.getFormProps();return e.customEndpointParams.externalModel=this.props.externalModel,e.customEndpointParams.externalId=this.props.externalId,e.description||(e.description={}),e.description.defaultValues={external_model:this.props.externalModel,external_id:this.props.externalId},s.createElement(d,e)}}class p extends n.A{static defaultProps={...n.A.defaultProps,model:"HubletoApp/Community/Discussions/Models/Team",tabs:{default:{title:"Task"}}};translationContext="HubletoApp\\Community\\Discussions::Components\\FormMember";constructor(e){super(e)}renderTitle(){return s.createElement(s.Fragment,null,s.createElement("h2",null,"Record #",this.state.record.id??"0"),s.createElement("small",null,"Member"))}renderTab(e){if(this.state.record,"default"===e)return s.createElement(s.Fragment,null)}}class u extends r.A{static defaultProps={...r.A.defaultProps,formUseModalSimple:!0,model:"HubletoApp/Community/Discussions/Models/Member"};translationContext="HubletoApp\\Community\\Discussions::Components\\TableMembers";constructor(e){super(e),this.state=this.getStateFromProps(e)}getStateFromProps(e){return{...super.getStateFromProps(e)}}getFormModalProps(){let e=super.getFormModalProps();return e.type="right wide",e}getEndpointParams(){return{...super.getEndpointParams(),idDiscussion:this.props.idDiscussion}}renderForm(){let e=this.getFormProps();return e.customEndpointParams.idDiscussion=this.props.idDiscussion,e.description||(e.description={}),e.description.defaultValues={id_discussion:this.props.idDiscussion},s.createElement(p,e)}}class h extends n.A{static defaultProps={...n.A.defaultProps,model:"HubletoApp/Community/Discussions/Models/Team",tabs:{default:{title:"Task"}}};translationContext="HubletoApp\\Community\\Discussions::Components\\FormMessage";constructor(e){super(e)}renderTitle(){return s.createElement(s.Fragment,null,s.createElement("h2",null,"Record #",this.state.record.id??"0"),s.createElement("small",null,"Message"))}renderTab(e){if(this.state.record,"default"===e)return s.createElement(s.Fragment,null)}}class g extends r.A{static defaultProps={...r.A.defaultProps,formUseModalSimple:!0,model:"HubletoApp/Community/Discussions/Models/Message"};translationContext="HubletoApp\\Community\\Discussions::Components\\TableMessages";constructor(e){super(e),this.state=this.getStateFromProps(e)}getStateFromProps(e){return{...super.getStateFromProps(e)}}getFormModalProps(){let e=super.getFormModalProps();return e.type="right wide",e}getEndpointParams(){return{...super.getEndpointParams(),idDiscussion:this.props.idDiscussion}}renderForm(){let e=this.getFormProps();return e.customEndpointParams.idDiscussion=this.props.idDiscussion,e.description||(e.description={}),e.description.defaultValues={id_discussion:this.props.idDiscussion},s.createElement(h,e)}}globalThis.main.registerReactComponent("DiscussionsTableMembers",u),globalThis.main.registerReactComponent("DiscussionsTableDiscussions",m),globalThis.main.registerReactComponent("DiscussionsTableMessages",g)},2062:(e,t,a)=>{"use strict";var s=a(9100),r=a(4876),n=a(9471),i=a(191),l=a(9605);class o extends l.A{translationContext="HubletoApp\\Community\\Leads\\Loader::Components\\FormLead";constructor(e){super(e),this.state={showLeads:!1}}render(){const e=this.props.form,t=e.state.record;if(t.id>0)return n.createElement(n.Fragment,null,n.createElement("button",{className:"btn btn-transparent",onClick:()=>{this.setState({showLeads:!this.state.showLeads})}},n.createElement("span",{className:"icon"},n.createElement("i",{className:"fas fa-people-arrows"})),n.createElement("span",{className:"text"},this.translate("Leads"))),this.state.showLeads?n.createElement(i.A,{uid:"customer_table_leads_modal",isOpen:!0,type:"centered",showHeader:!0,title:"Leads",onClose:e=>{this.setState({showLeads:!1})}},n.createElement(s.A,{uid:e.props.uid+"_table_leads",tag:"CustomerLeads",parentForm:e,idCustomer:t.id})):null)}}class c extends l.A{translationContext="HubletoApp\\Community\\Deals\\Loader::Components\\FormDeal";constructor(e){super(e),this.state={showDeals:!1}}render(){const e=this.props.form.state.record;return null!=e.id_lead?n.createElement("a",{className:"btn btn-transparent",href:`${globalThis.main.config.rootUrl}/leads/${e.id_lead}`},n.createElement("span",{className:"icon"},n.createElement("i",{className:"fas fa-arrow-up-right-from-square"})),n.createElement("span",{className:"text"},this.translate("Go to original lead"))):null}}var d=a(6643),m=a(4721);class p extends m.A{static defaultProps={...m.A.defaultProps,model:"HubletoApp/Community/Leads/Models/Team"};translationContext="HubletoApp\\Community\\Leads::Components\\FormLevel";constructor(e){super(e)}renderTitle(){return n.createElement(n.Fragment,null,n.createElement("h2",null,this.translate("Record")," #",this.state.record.id??"0"),n.createElement("small",null,this.translate("Level")))}}class u extends d.A{static defaultProps={...d.A.defaultProps,formUseModalSimple:!0,model:"HubletoApp/Community/Leads/Models/Level"};translationContext="HubletoApp\\Community\\Leads::Components\\TableLevels";constructor(e){super(e),this.state=this.getStateFromProps(e)}getStateFromProps(e){return{...super.getStateFromProps(e)}}getFormModalProps(){let e=super.getFormModalProps();return e.type="right wide",e}getEndpointParams(){return{...super.getEndpointParams()}}renderForm(){let e=this.getFormProps();return n.createElement(p,e)}}globalThis.main.registerReactComponent("LeadsTableLeads",s.A),globalThis.main.registerReactComponent("LeadsFormActivity",r.A),globalThis.main.registerReactComponent("LeadsTableLevels",u),globalThis.main.registerDynamicContent("FormCustomer:TopMenu",o),globalThis.main.registerDynamicContent("FormDeal:TopMenu",c)},2213:(e,t,a)=>{"use strict";var s=a(9471),r=a(1056),n=a(8242);class i extends r.A{static defaultProps={...r.A.defaultProps,formUseModalSimple:!0,orderBy:{field:"id",direction:"desc"},model:"HubletoApp/Community/Documents/Models/Document"};translationContext="HubletoApp\\Community\\Documents\\Loader::Components\\TableDocuments";constructor(e){super(e),this.state=this.getStateFromProps(e)}getStateFromProps(e){return{...super.getStateFromProps(e)}}getFormModalProps(){let e=super.getFormModalProps();return e.type="centered small",e}renderForm(){let e=this.getFormProps();return s.createElement(n.A,e)}}var l=a(1612),o=a(1194),c=a(9348),d=a(2395);class m extends r.A{static defaultProps={...r.A.defaultProps,formUseModalSimple:!0,orderBy:{field:"id",direction:"desc"},model:"HubletoApp/Community/Documents/Models/Document"};translationContext="HubletoApp\\Community\\Documents\\Loader::Components\\Browser";constructor(e){super(e),this.state={...this.getStateFromProps(e),folderUid:this.props.folderUid?this.props.folderUid:"_ROOT_",documentUid:this.props.documentUid,folderContent:null,path:this.props.path??[],showFolderProperties:0}}getStateFromProps(e){return{...super.getStateFromProps(e)}}loadData(){this.setState({loadingData:!0},()=>{l.A.get("",{route:"documents/api/get-folder-content",folderUid:this.state.folderUid,fulltextSearch:this.state.fulltextSearch},e=>{this.setState({loadingData:!1,folderContent:e})})})}getFormModalProps(){let e=super.getFormModalProps();return e.type="right",e}renderForm(){let e=this.getFormProps();return e.customEndpointParams={idFolder:this.state.folderContent.folder.id},s.createElement(n.A,e)}changeFolder(e,t){this.setState({recordId:0,folderUid:e,path:t,showFolderProperties:0},()=>{this.loadData()})}createSubFolder(){this.setState({showFolderProperties:-1})}render(){return this.state.folderContent?s.createElement(s.Fragment,null,s.createElement("div",{className:"flex gap-2"},s.createElement("button",{className:"btn btn-info text-xl",onClick:()=>{this.changeFolder("_ROOT_",[])}},s.createElement("span",{className:"icon"},s.createElement("i",{className:"fas fa-home"}))),this.state.path.map((e,t)=>{const a=t==this.state.path.length-1;return s.createElement("button",{key:t,className:"btn text-xl "+(a?"btn-info":"btn-cancel"),onClick:()=>{if(a)this.setState({showFolderProperties:this.state.folderContent.folder.id});else{let a=[];for(let e=0;e<=t;e++)a.push(this.state.path[e]);this.changeFolder(e.uid,a)}}},s.createElement("span",{className:"text"},e.name))}),s.createElement("button",{className:"btn btn-transparent text-xl",onClick:()=>{this.createSubFolder()}},s.createElement("span",{className:"icon"},s.createElement("i",{className:"fas fa-plus"})),s.createElement("span",{className:"text"},this.translate("Add folder")))),s.createElement("div",{className:"flex gap-2 mt-2"},this.state.folderContent.subFolders?this.state.folderContent.subFolders.map((e,t)=>s.createElement("button",{key:t,className:"btn btn-square btn-light w-32",onClick:()=>{let t=e.uid,a=this.state.path;a.push(e),this.changeFolder(t,a)}},s.createElement("span",{className:"icon"},s.createElement("i",{className:"fas fa-folder"})),s.createElement("span",{className:"text"},e.name??""))):null,this.state.folderContent.documents?this.state.folderContent.documents.map((e,t)=>s.createElement("button",{key:t,className:"btn btn-square btn-primary-outline",onClick:()=>{this.setState({recordId:e.id})}},s.createElement("span",{className:"icon"},s.createElement("i",{className:"fas fa-file"})),s.createElement("span",{className:"text"},e.name??""))):null,s.createElement("button",{className:"btn btn-square btn-transparent",onClick:()=>{this.setState({recordId:-1})}},s.createElement("span",{className:"icon"},s.createElement("i",{className:"fas fa-plus"})),s.createElement("span",{className:"text"},this.translate("Add document")))),this.renderFormModal(),this.state.showFolderProperties?s.createElement(d.A,{uid:"create_sub_folder_modal",isOpen:!0,type:"right"},s.createElement(o.A,{uid:"create_sub_folder_form",model:"HubletoApp/Community/Documents/Models/Folder",customEndpointParams:{idParentFolder:this.state.folderContent.folder.id},id:this.state.showFolderProperties,showInModal:!0,showInModalSimple:!0,onClose:()=>{this.setState({showFolderProperties:0})}})):null):s.createElement(c.z,{mode:"indeterminate",style:{height:"8px"}})}}globalThis.main.registerReactComponent("DocumentsTableDocuments",i),globalThis.main.registerReactComponent("DocumentsBrowser",m)},2233:(e,t,a)=>{"use strict";var s=a(9534),r=a(9471),n=a(9605),i=a(1612),l=a(191);class o extends n.A{translationContext="HubletoApp\\Community\\Deals\\Loader::Components\\FormDeal";constructor(e){super(e),this.state={showTasks:!1}}componentDidMount(){i.A.get("api/record/get-list",{model:"HubletoApp\\Community\\Tasks\\Models\\Task",externalModel:"HubletoApp\\Community\\Deals\\Models\\Deal",externalId:this.props.form.state.record?.id},e=>{this.setState({tasks:e.data})})}render(){const e=this.props.form,t=e.state.record;if(t.id>0)return r.createElement(r.Fragment,null,r.createElement("button",{className:"btn btn-transparent",onClick:()=>{this.setState({showTasks:!this.state.showTasks})}},r.createElement("span",{className:"icon"},r.createElement("i",{className:"fas fa-list-check"})),r.createElement("span",{className:"text"},this.translate("Tasks"),this.state.tasks?" ("+this.state.tasks.length+")":null)),this.state.showTasks?r.createElement(r.Fragment,null,r.createElement(l.A,{uid:"deals_table_tasks_modal",isOpen:!0,type:"centered",showHeader:!0,title:r.createElement(r.Fragment,null,r.createElement("h2",null,"Tasks"),r.createElement("small",null,"Deal: ",t.title?t.title:"-")),onClose:e=>{this.setState({showTasks:!1})}},r.createElement(s.A,{uid:e.props.uid+"_table_tasks",tag:"DealTasks",parentForm:e,externalModel:"HubletoApp\\Community\\Deals\\Models\\Deal",externalId:t.id}))):null)}}globalThis.main.registerReactComponent("TasksTableTasks",s.A),globalThis.main.registerDynamicContent("FormDeal:TopMenu",o)},2770:(e,t,a)=>{"use strict";var s=a(8399),r=a(9471),n=a(6643),i=a(4721);class l extends i.A{static defaultProps={...i.A.defaultProps,model:"HubletoApp/Community/Worksheets/Models/Team",tabs:{default:{title:"Task"}}};translationContext="HubletoApp\\Community\\Worksheets::Components\\FormActivityType";constructor(e){super(e)}renderTitle(){return r.createElement(r.Fragment,null,r.createElement("h2",null,"Record #",this.state.record.id??"0"),r.createElement("small",null,"ActivityType"))}renderTab(e){if(this.state.record,"default"===e)return r.createElement(r.Fragment,null)}}class o extends n.A{static defaultProps={...n.A.defaultProps,formUseModalSimple:!0,model:"HubletoApp/Community/Worksheets/Models/ActivityType"};translationContext="HubletoApp\\Community\\Worksheets::Components\\TableActivityTypes";constructor(e){super(e),this.state=this.getStateFromProps(e)}getStateFromProps(e){return{...super.getStateFromProps(e)}}getFormModalProps(){let e=super.getFormModalProps();return e.type="right wide",e}getEndpointParams(){return{...super.getEndpointParams()}}renderForm(){let e=this.getFormProps();return r.createElement(l,e)}}globalThis.main.registerReactComponent("WorksheetsTableActivities",s.A),globalThis.main.registerReactComponent("WorksheetsTableActivityTypes",o)},2850:(e,t,a)=>{"use strict";var s=a(9471),r=a(6643),n=a(4721),i=a(7498),l=a(9534);class o extends n.A{static defaultProps={...n.A.defaultProps,model:"HubletoApp/Community/Projects/Models/Team",tabs:{default:{title:"Project"},tasks:{title:"Tasks"},statistics:{title:"Statistics"}}};translationContext="HubletoApp\\Community\\Projects::Components\\FormProject";constructor(e){super(e)}renderTitle(){return s.createElement(s.Fragment,null,s.createElement("h2",null,(this.state.record.identifier??"")+" "+(this.state.record.title??"")),s.createElement("small",null,"Project"))}renderTab(e){const t=this.state.record;switch(e){case"default":return s.createElement(s.Fragment,null,s.createElement("div",{className:"w-full flex gap-2 flex-col md:flex-row"},s.createElement("div",{className:"flex-1 border-r border-gray-100"},this.inputWrapper("identifier"),this.inputWrapper("title"),this.inputWrapper("description"),this.inputWrapper("id_main_developer"),this.inputWrapper("id_account_manager"),this.inputWrapper("priority"),this.inputWrapper("date_start"),this.inputWrapper("date_deadline"),this.inputWrapper("budget")),s.createElement("div",{className:"flex-1"},this.inputWrapper("id_customer"),this.inputWrapper("id_contact"),this.inputWrapper("color"),this.inputWrapper("online_documentation_folder"),this.inputWrapper("notes"),this.inputWrapper("id_deal"))),this.state.id<=0?null:s.createElement(i.A,{idPipeline:t.id_pipeline,idPipelineStep:t.id_pipeline_step,onPipelineChange:(e,t)=>{this.updateRecord({id_pipeline:e,id_pipeline_step:t})},onPipelineStepChange:e=>{this.updateRecord({id_pipeline_step:e})}}));case"tasks":try{return s.createElement(s.Fragment,null,this.state.id<0?s.createElement("div",{className:"badge badge-info"},"First create the project, then you will be prompted to add tasks."):s.createElement(l.A,{uid:this.props.uid+"_table_tasks",tag:"ProjectTasks",parentForm:this,externalModel:"HubletoApp\\Community\\Projects\\Models\\Project",externalId:t.id,selectionMode:"multiple"}))}catch(e){return s.createElement("div",{className:"alert alert-error"},"Failed to display tasks. Check if you have 'Tasks' app installed.")}}}}class c extends r.A{static defaultProps={...r.A.defaultProps,formUseModalSimple:!0,model:"HubletoApp/Community/Projects/Models/Project"};translationContext="HubletoApp\\Community\\Projects::Components\\TableProjects";constructor(e){super(e),this.state=this.getStateFromProps(e)}getStateFromProps(e){return{...super.getStateFromProps(e)}}getFormModalProps(){let e=super.getFormModalProps();return e.type="right wide",e}getEndpointParams(){return{...super.getEndpointParams(),idDeal:this.props.idDeal}}renderForm(){let e=this.getFormProps();return e.customEndpointParams.idDeal=this.props.idDeal,e.description||(e.description={}),e.description.defaultValues={id_deal:this.props.idDeal},s.createElement(o,e)}}class d extends n.A{static defaultProps={...n.A.defaultProps,model:"HubletoApp/Community/Projects/Models/Team"};translationContext="HubletoApp\\Community\\Projects::Components\\FormPhase";constructor(e){super(e)}renderTitle(){return s.createElement(s.Fragment,null,s.createElement("h2",null,"Record #",this.state.record.id??"0"),s.createElement("small",null,"Phase"))}}class m extends r.A{static defaultProps={...r.A.defaultProps,formUseModalSimple:!0,model:"HubletoApp/Community/Projects/Models/Phase"};translationContext="HubletoApp\\Community\\Projects::Components\\TablePhases";constructor(e){super(e),this.state=this.getStateFromProps(e)}getStateFromProps(e){return{...super.getStateFromProps(e)}}getFormModalProps(){let e=super.getFormModalProps();return e.type="right wide",e}getEndpointParams(){return{...super.getEndpointParams()}}renderForm(){let e=this.getFormProps();return s.createElement(d,e)}}var p=a(9605),u=a(1612),h=a(191);class g extends p.A{translationContext="HubletoApp\\Community\\Projects\\Loader::Components\\FormProject";constructor(e){super(e),this.refTableProjects=(0,s.createRef)(),this.state={showProjects:!1,showIdProject:0}}componentDidMount(){u.A.get("api/record/get-list",{model:"HubletoApp\\Community\\Projects\\Models\\Project",idDeal:this.props.form.state.record?.id},e=>{this.setState({projects:e.data})})}convertToProject(e){u.A.get("projects/api/convert-deal-to-project",{idDeal:e},e=>{"success"==e.status&&(console.log(this.refTableProjects,this.refTableProjects.current),this.refTableProjects.current.reload())})}confirmConvertToProject(e){globalThis.main.showDialogDanger("Are you sure you want to convert this deal to a project?",{headerClassName:"dialog-warning-header",header:"Convert to project",footer:s.createElement(s.Fragment,null,s.createElement("button",{className:"btn btn-yellow",onClick:()=>{this.convertToProject(e)}},s.createElement("span",{className:"icon"},s.createElement("i",{className:"fas fa-forward"})),s.createElement("span",{className:"text"},"Yes, convert to project")),s.createElement("button",{className:"btn btn-transparent",onClick:()=>{globalThis.main.lastShownDialogRef.current.hide()}},s.createElement("span",{className:"icon"},s.createElement("i",{className:"fas fa-times"})),s.createElement("span",{className:"text"},"No, do not convert")))})}render(){const e=this.props.form,t=e.state.record;if(t.id>0)return s.createElement(s.Fragment,null,s.createElement("button",{className:"btn btn-transparent",onClick:()=>{this.setState({showProjects:!this.state.showProjects})}},s.createElement("span",{className:"icon"},s.createElement("i",{className:"fas fa-handshake"})),s.createElement("span",{className:"text"},this.translate("Projects"),this.state.projects?" ("+this.state.projects.length+")":null)),this.state.showProjects?s.createElement(s.Fragment,null,s.createElement(h.A,{uid:"deals_table_projects_modal",isOpen:!0,type:"centered",showHeader:!0,title:s.createElement(s.Fragment,null,s.createElement("h2",null,"Projects"),s.createElement("small",null,"Deal: ",t.title?t.title:"-")),topMenu:s.createElement("a",{className:"btn btn-transparent",onClick:()=>this.convertToProject(t.id)},s.createElement("span",{className:"icon"},s.createElement("i",{className:"fas fa-rotate-right"})),s.createElement("span",{className:"text"},"Convert deal to project")),onClose:e=>{this.setState({showProjects:!1})}},s.createElement(c,{ref:this.refTableProjects,uid:e.props.uid+"_table_projects",tag:"DealProjects",parentForm:e,idDeal:t.id,recordId:this.state.showIdProject,descriptionSource:"both"}))):null)}}globalThis.main.registerReactComponent("ProjectsTableProjects",c),globalThis.main.registerReactComponent("ProjectsTablePhases",m),globalThis.main.registerDynamicContent("FormDeal:TopMenu",g)},3041:(e,t,a)=>{"use strict";a.d(t,{A:()=>c});var s=a(9471),r=a(1663),n=a(2455),i=a(5237),l=a(9601),o=a(9018);class c extends s.Component{constructor(e){super(e),this.state={events:[],dateClicked:"",timeClicked:"",headerToolbar:this.props.headerToolbar??{left:"prev,next today",center:"title",right:this.props.views??"timeGridDay,timeGridWeek,dayGridMonth"}}}renderCell=e=>s.createElement(s.Fragment,null,e.event.extendedProps.icon?s.createElement("i",{className:"ml-2 "+e.event.extendedProps.icon}):null,s.createElement("b",{className:"ml-2"},e.timeText),s.createElement("span",{className:"ml-2"},e.event.title),e.event.extendedProps.details?s.createElement("div",{className:"ml-2"},s.createElement("small",null,s.createElement("i",null,e.event.extendedProps.details))):null);render(){return s.createElement("div",null,s.createElement(r.A,{eventClassNames:"truncate cursor-pointer",height:this.props.height,plugins:[n.A,i.A,l.Ay,o.A],firstDay:1,scrollTime:"10:30:00",headerToolbar:this.state.headerToolbar,initialView:this.props.initialView,eventTimeFormat:{hour:"2-digit",minute:"2-digit",meridiem:!1,hour12:!1},editable:!1,selectable:!1,selectMirror:!1,dayMaxEvents:!0,weekends:!0,events:{url:this.props.eventsEndpoint},eventsSet:e=>{this.props.onEventsLoaded&&this.props.onEventsLoaded(e)},dateClick:e=>{if(this.props.readonly)return;const t=`${e.date.getFullYear()}-${String(e.date.getMonth()+1).padStart(2,"0")}-${String(e.date.getDate()).padStart(2,"0")}`,a=`${String(e.date.getHours()).padStart(2,"0")}:${String(e.date.getMinutes()).padStart(2,"0")}:${String(e.date.getSeconds()).padStart(2,"0")}`;this.props.onDateClick(t,a,e)},eventContent:this.renderCell,eventClick:e=>this.props.onEventClick(e)}))}}},3266:(e,t,a)=>{"use strict";var s=a(9471),r=a(1056),n=a(9292),i=a(4721);class l extends r.A{static defaultProps={...r.A.defaultProps,orderBy:{field:"id",direction:"desc"},formUseModalSimple:!0,model:"HubletoApp/Community/Orders/Models/OrderProduct"};translationContext="HubletoApp\\Community\\Orders\\Loader::Components\\TableOrderProducts";constructor(e){super(e),this.state=this.getStateFromProps(e)}getStateFromProps(e){return{...super.getStateFromProps(e)}}getFormModalProps(){let e=super.getFormModalProps();return e.type="right",e}getEndpointParams(){return{...super.getEndpointParams()}}renderHeaderRight(){return super.renderHeaderRight()}renderFooter(){return s.createElement(s.Fragment,null,s.createElement("div",{className:"flex flex-row justify-start md:justify-end"},s.createElement("strong",{className:"mr-5"},this.props.sum)))}}var o=a(436),c=a(470),d=a(6365);class m extends r.A{static defaultProps={...r.A.defaultProps,orderBy:{field:"date",direction:"desc"},formUseModalSimple:!0,model:"HubletoApp/Community/Orders/Models/History"};translationContext="HubletoApp\\Community\\Orders\\Loader::Components\\TableHistories";constructor(e){super(e),this.state=this.getStateFromProps(e)}getStateFromProps(e){return{...super.getStateFromProps(e)}}getFormModalProps(){let e=super.getFormModalProps();return e.type="right",e}getEndpointParams(){return{...super.getEndpointParams()}}renderHeaderRight(){return super.renderHeaderRight()}}function p(){return p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},p.apply(null,arguments)}class u extends i.A{static defaultProps={...i.A.defaultProps,model:"HubletoApp/Community/Orders/Models/Order"};translationContext="HubletoApp\\Community\\Orders\\Loader::Components\\FormOrder";constructor(e){super(e),this.state={...this.getStateFromProps(e),newEntryId:-1}}getStateFromProps(e){return{...super.getStateFromProps(e)}}renderTitle(){return-1==(0,n.P3)("recordId")?s.createElement("h2",null,globalThis.main.translate("New Order")):s.createElement("h2",null,this.state.record.id_customer?this.state.record.order_number:"[Undefined Order]")}getSumPrice(e){var t=0;return e.map((e,a)=>{if(e.unit_price&&e.amount&&1!=e._toBeDeleted_){var s=e.unit_price*e.amount;e.vat&&(s+=s*(e.vat/100)),e.discount&&(s-=s*(e.discount/100)),t+=s}}),Number(t.toFixed(2))}renderContent(){const e=(0,s.createRef)();var t;const a=()=>{e.current&&(t=e.current.state.data)},r=this.state.record,n=r.id>0;return s.createElement(s.Fragment,null,s.createElement(d.J,null,s.createElement(d.K,{header:this.translate("Order")},s.createElement("div",{className:"card"},s.createElement("div",{className:"card-body flex flex-row gap-2"},s.createElement("div",{className:"grow"},n?this.inputWrapper("order_number"):s.createElement(s.Fragment,null),n?s.createElement("div",{className:"flex flex-row *:w-1/2"},this.inputWrapper("price"),this.inputWrapper("id_currency")):s.createElement(s.Fragment,null),this.inputWrapper("date_order"),this.inputWrapper("required_delivery_date"),this.inputWrapper("shipping_info")),s.createElement("div",{className:"border-l border-gray-200"}),s.createElement("div",{className:"grow"},this.inputWrapper("id_customer"),this.inputWrapper("note"))),r.id>0?s.createElement(s.Fragment,null,s.createElement("div",{className:"card-body border-t border-gray-200"},s.createElement("a",{className:"btn btn-add-outline mb-2",onClick:()=>{this.setState({isInlineEditing:!0}),r.PRODUCTS||(r.PRODUCTS=[]),r.PRODUCTS.push({id:this.state.newEntryId,id_order:{_useMasterRecordId_:!0},amount:1,unit_price:0,vat:0,discount:0}),this.setState({record:r}),this.setState({newEntryId:this.state.newEntryId-1})}},s.createElement("span",{className:"icon"},s.createElement("i",{className:"fas fa-add"})),s.createElement("span",{className:"text"},"Add product")),s.createElement("div",{className:"w-full h-full overflow-x-auto"},s.createElement(l,{sum:"Total: "+r.price+" "+r.CURRENCY.code,uid:this.props.uid+"_table_order_products",readonly:!this.state.isInlineEditing,isUsedAsInput:!0,isInlineEditing:this.state.isInlineEditing,data:{data:r.PRODUCTS},customEndpointParams:{idOrder:r.id},descriptionSource:"props",description:{permissions:this.props.tableOrderProductsDescription.permissions,ui:{showHeader:!1,showFooter:!0,addButtonText:"Add Product"},columns:{title:{type:"varchar",title:this.translate("Title")},id_product:{type:"lookup",title:"Product",model:"HubletoApp/Community/Products/Models/Product",cellRenderer:(n,i,l)=>s.createElement(o.A,null,s.createElement(c.A,p({},this.getInputProps(),{ref:e,model:"HubletoApp/Community/Products/Models/Product",cssClass:"min-w-44",value:i.id_product,onChange:(e,s)=>{a(),t[s]&&(i.id_product=s,i.unit_price=t[s].unit_price,i.vat=t[s].vat,this.updateRecord({PRODUCTS:n.state.data?.data}),this.updateRecord({price:this.getSumPrice(r.PRODUCTS)}))}})))},amount:{type:"int",title:"Amount"},unit_price:{type:"float",title:"Unit Price"},vat:{type:"float",title:"Vat (%)"},discount:{type:"float",title:"Discount (%)"},__sum:{type:"none",title:"Sum after vat",cellRenderer:(e,t,a)=>{if(t.unit_price&&t.amount){let e=t.unit_price*t.amount;return t.vat&&(e+=e*(t.vat/100)),t.discount&&(e-=e*(t.discount/100)),e=Number(e.toFixed(2)),s.createElement(s.Fragment,null,s.createElement("span",null,e+" "+r.CURRENCY.code))}}}},inputs:{id_product:{type:"lookup",title:"Product",model:"HubletoApp/Community/Products/Models/Product",cellRenderer:(n,i,l)=>s.createElement(o.A,null,s.createElement(c.A,p({},this.getInputProps("product_lookup"),{ref:e,model:"HubletoApp/Community/Products/Models/Product",cssClass:"min-w-44",value:i.id_product,onChange:(e,s)=>{a(),t[s]&&(i.id_product=s,i.unit_price=t[s].unit_price,i.vat=t[s].vat,this.updateRecord({PRODUCTS:n.state.data?.data}),this.updateRecord({price:this.getSumPrice(r.PRODUCTS)}))}})))},amount:{type:"int",title:"Amount"},unit_price:{type:"float",title:"Unit Price"},vat:{type:"float",title:"Vat (%)"},discount:{type:"float",title:"Discount (%)"},__sum:{type:"none",title:"Sum after vat"}}},onRowClick:()=>this.setState({isInlineEditing:!0}),onChange:e=>{this.updateRecord({price:this.getSumPrice(r.PRODUCTS),PRODUCTS:e.state.data?.data})},onDeleteSelectionChange:e=>{this.updateRecord({PRODUCTS:e.state.data?.data??[],price:this.getSumPrice(r.PRODUCTS)})}})))):s.createElement(s.Fragment,null))),n?s.createElement(d.K,{header:this.translate("History")},s.createElement(m,{uid:this.props.uid+"_table_order_history",data:{data:r.HISTORY},descriptionSource:"props",description:{ui:{showHeader:!1,showFooter:!1},permissions:{canCreate:!1,canUpdate:!1,canDelete:!1,canRead:!0},columns:{short_description:{type:"text",title:"Short Description"},date:{type:"datetime",title:"Date Time"}},inputs:{short_description:{type:"text",title:"Short Description"},date:{type:"datetime",title:"Date Time"}}},isUsedAsInput:!0,isInlineEditing:!1,onRowClick:(e,t)=>e.openForm(t.id)})):s.createElement(s.Fragment,null)))}}var h=a(1612);class g extends r.A{static defaultProps={...r.A.defaultProps,orderBy:{field:"id",direction:"desc"},formUseModalSimple:!0,model:"HubletoApp/Community/Orders/Models/Order"};translationContext="HubletoApp\\Community\\Orders\\Loader::Components\\TableOrders";constructor(e){super(e),this.state=this.getStateFromProps(e)}getStateFromProps(e){return{...super.getStateFromProps(e)}}getFormModalProps(){let e=super.getFormModalProps();return e.type="right wide",e}getEndpointParams(){return{...super.getEndpointParams()}}renderHeaderRight(){return super.renderHeaderRight()}onAfterLoadTableDescription(e){return h.A.get("api/table/describe",{model:"HubletoApp/Community/Orders/Models/OrderProduct",idOrder:this.props.recordId},e=>{this.setState({tableOrderProductsDescription:e})}),e}renderForm(){let e=this.getFormProps();return e.tableOrderProductsDescription=this.state.tableOrderProductsDescription,s.createElement(u,e)}}globalThis.main.registerReactComponent("OrdersTableOrders",g)},3283:(e,t,a)=>{"use strict";var s=a(9471),r=a(6643),n=a(4721);class i extends n.A{static defaultProps={...n.A.defaultProps,model:"HubletoApp/Community/Inventory/Models/Team"};translationContext="HubletoApp\\Community\\Inventory::Components\\FormInventory";constructor(e){super(e)}renderTitle(){return s.createElement(s.Fragment,null,s.createElement("h2",null,"Record #",this.state.record.id??"0"),s.createElement("small",null,"Inventory"))}}class l extends r.A{static defaultProps={...r.A.defaultProps,formUseModalSimple:!0,model:"HubletoApp/Community/Inventory/Models/Inventory"};translationContext="HubletoApp\\Community\\Inventory::Components\\TableInventory";constructor(e){super(e),this.state=this.getStateFromProps(e)}getStateFromProps(e){return{...super.getStateFromProps(e)}}getFormModalProps(){let e=super.getFormModalProps();return e.type="right wide",e}getEndpointParams(){return{...super.getEndpointParams()}}renderForm(){let e=this.getFormProps();return s.createElement(i,e)}}class o extends n.A{static defaultProps={...n.A.defaultProps,model:"HubletoApp/Community/Inventory/Models/Team"};translationContext="HubletoApp\\Community\\Inventory::Components\\FormTransaction";constructor(e){super(e)}renderTitle(){return s.createElement(s.Fragment,null,s.createElement("h2",null,"Record #",this.state.record.id??"0"),s.createElement("small",null,"Transaction"))}}class c extends r.A{static defaultProps={...r.A.defaultProps,formUseModalSimple:!0,model:"HubletoApp/Community/Inventory/Models/Transaction"};translationContext="HubletoApp\\Community\\Inventory::Components\\TableTransaction";constructor(e){super(e),this.state=this.getStateFromProps(e)}getStateFromProps(e){return{...super.getStateFromProps(e)}}getFormModalProps(){let e=super.getFormModalProps();return e.type="right wide",e}getEndpointParams(){return{...super.getEndpointParams()}}renderForm(){let e=this.getFormProps();return s.createElement(o,e)}}globalThis.main.registerReactComponent("InventoryTableInventory",l),globalThis.main.registerReactComponent("InventoryTableTransactions",c)},3396:(e,t,a)=>{"use strict";var s=a(9471),r=a(6643),n=a(4721),i=a(436),l=a(1612),o=a(1056);class c extends o.A{static defaultProps={...o.A.defaultProps,formUseModalSimple:!0,model:"HubletoApp/Community/Deals/Models/DealProduct"};translationContext="HubletoApp\\Community\\Deals\\Loader::Components\\TableDealProducts";constructor(e){super(e),this.state=this.getStateFromProps(e)}}var d=a(470),m=a(3041);class p extends o.A{static defaultProps={...o.A.defaultProps,formUseModalSimple:!0,model:"HubletoApp/Community/Deals/Models/DealDocument"};translationContext="HubletoApp\\Community\\Deals\\Loader::Components\\TableDealDocuments";constructor(e){super(e),this.state=this.getStateFromProps(e)}getStateFromProps(e){return{...super.getStateFromProps(e)}}}var u=a(8242),h=a(5882);function g(){return g=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},g.apply(null,arguments)}class E extends h.A{static defaultProps={...h.A.defaultProps,model:"HubletoApp/Community/Deals/Models/DealActivity"};translationContext="HubletoApp\\Community\\Deals\\Loader::Components\\FormActivity";getActivitySourceReadable(){return this.translate("Deal")}renderCustomInputs(){const e=this.state.record;return s.createElement(s.Fragment,null,this.inputWrapper("id_deal"),s.createElement(i.A,{title:this.translate("Contact")},s.createElement(d.A,g({},this.getInputProps("id_contact"),{model:"HubletoApp/Community/Contacts/Models/Contact",endpoint:"contacts/get-customer-contacts",customEndpointParams:{id_customer:this.props.idCustomer},value:e.id_contact,onChange:(t,a)=>{this.updateRecord({id_contact:a}),0==e.id_contact&&(e.id_contact=null,this.setState({record:e}))}}))))}}var b=a(2395),C=a(2908),y=a(2198),v=a.n(y);class f extends o.A{static defaultProps={...o.A.defaultProps,formUseModalSimple:!0,model:"HubletoApp/Community/Deals/Models/DealHistory"};translationContext="HubletoApp\\Community\\Deals\\Loader::Components\\TableDealHistory";constructor(e){super(e),this.state=this.getStateFromProps(e)}getStateFromProps(e){return{...super.getStateFromProps(e)}}}var P=a(7498);function A(){return A=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},A.apply(null,arguments)}class S extends n.A{static defaultProps={...n.A.defaultProps,model:"HubletoApp/Community/Deals/Models/Deal",tabs:{default:{title:"Deal"},items:{title:"Items"},calendar:{title:"Calendar"},documents:{title:"Documents"},history:{title:"History"}}};translationContext="HubletoApp\\Community\\Deals\\Loader::Components\\FormDeal";constructor(e){super(e),this.refLogActivityInput=s.createRef(),this.refServicesLookup=s.createRef(),this.refProductsLookup=s.createRef(),this.state={...this.getStateFromProps(e),newEntryId:this.props.newEntryId??-1,showIdDocument:0,showIdActivity:0,activityTime:"",activityDate:"",activitySubject:"",activityAllDay:!1,tableDealProductsDescription:null,tableDealDocumentsDescription:null,tablesKey:0},this.onCreateActivityCallback=this.onCreateActivityCallback.bind(this)}getStateFromProps(e){return{...super.getStateFromProps(e)}}onAfterLoadFormDescription(e){return l.A.get("api/table/describe",{model:"HubletoApp/Community/Deals/Models/DealProduct",idDeal:this.state.id},e=>{this.setState({tableDealProductsDescription:e})}),l.A.get("api/table/describe",{model:"HubletoApp/Community/Deals/Models/DealDocument",idDeal:this.state.id},e=>{this.setState({tableDealDocumentsDescription:e})}),e}onAfterSaveRecord(e){let t=this.getEndpointParams(),a=e.savedRecord.is_archived;0==t.showArchive&&1==a||1==t.showArchive&&0==a?(this.props.onClose(),this.props.parentTable.loadData()):super.onAfterSaveRecord(e)}renderTitle(){return s.createElement(s.Fragment,null,s.createElement("h2",null,this.state.record.title?this.state.record.title:"-"),s.createElement("small",null,this.translate("Deal")))}renderSubTitle(){return s.createElement("small",null,this.translate("Deal"))}pipelineChange(e){l.A.get("deals/change-pipeline",{idPipeline:e},e=>{if("success"==e.status){var t=this.state.record;e.newPipeline.STEPS?.length>0?(t.id_pipeline=e.newPipeline.id,t.id_pipeline_step=e.newPipeline.STEPS[0].id,t.deal_result=e.newPipeline.STEPS[0].set_result,t.PIPELINE=e.newPipeline,t.PIPELINE_STEP=e.newPipeline.STEPS[0],this.setState({record:t})):(t.id_pipeline=e.newPipeline.id,t.id_pipeline_step=null,t.PIPELINE=e.newPipeline,t.PIPELINE_STEP=null,this.setState({record:t}))}})}calculateWeightedProfit(e,t){return e/100*t}changePipelineStepFromResult(){this.state.record.PIPELINE.STEPS.length>0&&this.state.record.PIPELINE.STEPS.some(e=>{if(e.set_result==this.state.record.deal_result){let t=this.state.record;return t.id_pipeline_step=e.id,t.PIPELINE_STEP=e,this.setState({record:t}),!0}return!1})}onCreateActivityCallback(){this.loadRecord()}componentDidUpdate(e,t){t.isInlineEditing!=this.state.isInlineEditing&&this.setState({tablesKey:Math.random()})}logCompletedActivity(){l.A.get("deals/api/log-activity",{idDeal:this.state.record.id,activity:this.refLogActivityInput.current.value},e=>{this.loadRecord(),this.refLogActivityInput.current.value=""})}scheduleActivity(){this.setState({showIdActivity:-1,activityDate:v()().add(1,"week").format("YYYY-MM-DD"),activityTime:v()().add(1,"week").format("H:00:00"),activitySubject:this.refLogActivityInput.current.value,activityAllDay:!1})}renderTab(e){const t=this.state.record;switch(e){case"default":const e=s.createElement(s.Fragment,null,this.inputWrapper("identifier",{cssClass:"text-2xl text-primary",readonly:t.is_archived}),this.inputWrapper("title",{cssClass:"text-2xl text-primary",readonly:t.is_archived}),s.createElement(i.A,{title:"Customer"},s.createElement(d.A,A({},this.getInputProps("id_customer"),{model:"HubletoApp/Community/Customers/Models/Customer",urlAdd:"customers/add",value:t.id_customer,readonly:t.is_archived,onChange:(e,a)=>{this.updateRecord({id_customer:a,id_contact:null}),0==t.id_customer&&(t.id_customer=null,this.setState({record:t}))}}))),s.createElement(i.A,{title:"Contact"},s.createElement(d.A,A({},this.getInputProps("id_contact"),{model:"HubletoApp/Community/Contacts/Models/Contact",customEndpointParams:{idCustomer:t.id_customer},value:t.id_contact,urlAdd:"contacts/add",readonly:t.is_archived,onChange:(e,a)=>{this.updateRecord({id_contact:a}),0==t.id_contact&&(t.id_contact=null,this.setState({record:t}))}}))),t.CONTACT&&t.CONTACT.VALUES?s.createElement("div",{className:"ml-4 text-sm p-2 bg-lime-100 text-lime-900 mb-2"},t.CONTACT.VALUES.map((e,t)=>s.createElement("div",{key:t},e.value))):null,this.state.isInlineEditing&&t.PRODUCTS&&t.PRODUCTS.length>0||t.SERVICES&&t.SERVICES.length>0?s.createElement("div",{className:"text-yellow-500 mb-3"},s.createElement("span",{className:"icon mr-2"},s.createElement("i",{className:"fas fa-warning"})),s.createElement("span",{className:"text"},"The price is locked because the deal has some products or services")):s.createElement(s.Fragment,null),s.createElement("div",{className:"flex flex-row *:w-1/2"},this.inputWrapper("price",{cssClass:"text-2xl",readonly:!!(t.PRODUCTS&&t.PRODUCTS.length>0||t.SERVICES&&t.SERVICES.length>0||t.is_archived)}),this.inputWrapper("id_currency")),this.inputWrapper("shared_folder",{readonly:t.is_archived}),this.inputWrapper("customer_order_number",{readonly:t.is_archived}),this.inputWrapper("is_closed",{readonly:t.is_archived})),r=s.createElement(s.Fragment,null,s.createElement("div",{className:"flex gap-2"},this.inputWrapper("id_owner",{readonly:t.is_archived}),this.inputWrapper("id_manager",{readonly:t.is_archived})),this.inputWrapper("date_expected_close",{readonly:t.is_archived}),s.createElement("div",{className:"flex gap-2"},this.inputWrapper("source_channel",{readonly:t.is_archived}),this.inputWrapper("is_new_customer",{readonly:t.is_archived,onChange:(e,t)=>{this.state.record.is_new_customer&&this.updateRecord({business_type:1})}})),s.createElement("div",{className:"flex gap-2"},this.inputWrapper("business_type",{uiStyle:"buttons",readonly:t.is_archived,onChange:(e,t)=>{2==this.state.record.business_type&&this.updateRecord({is_new_customer:!1})}}),this.inputWrapper("deal_result",{uiStyle:"buttons",readonly:t.is_archived,onChange:(e,t)=>{this.updateRecord({lost_reason:null}),this.state.record.PIPELINE&&this.state.record.PIPELINE.STEPS?.length>0&&this.changePipelineStepFromResult()}})),this.inputWrapper("date_created"),this.inputWrapper("is_archived"),this.inputWrapper("id_lead"),this.inputWrapper("note",{cssClass:"bg-yellow-50",readonly:t.is_archived}),3==this.state.record.deal_result?this.inputWrapper("lost_reason",{readonly:t.is_archived}):null),n=s.createElement(P.A,{idPipeline:t.id_pipeline,idPipelineStep:t.id_pipeline_step,onPipelineChange:(e,t)=>{this.pipelineChange(e)},onPipelineStepChange:(e,a)=>{t.is_archived||(0==this.state.isInlineEditing&&this.setState({isInlineEditing:!0}),t.id_pipeline_step=e,t.deal_result=a.set_result,t.PIPELINE_STEP=a,this.updateRecord(t))}}),l=s.createElement("div",{className:"card card-body shadow-blue-200"},s.createElement("div",{className:"mb-2"},s.createElement(m.A,{onCreateCallback:()=>this.loadRecord(),readonly:t.is_archived,initialView:"dayGridMonth",headerToolbar:{start:"title",center:"",end:"prev,today,next"},eventsEndpoint:globalThis.main.config.rootUrl+"/calendar/api/get-calendar-events?source=deals&idDeal="+t.id,onDateClick:(e,t,a)=>{this.setState({activityDate:e,activityTime:t,activityAllDay:!1,showIdActivity:-1})},onEventClick:e=>{this.setState({showIdActivity:parseInt(e.event.id)}),e.jsEvent.preventDefault()}})),s.createElement("div",{className:"adios component input"},s.createElement("div",{className:"input-element w-full flex gap-2"},s.createElement("input",{className:"w-full bg-blue-50 border border-blue-800 p-1 text-blue-800 placeholder-blue-300",placeholder:this.translate("Type recent activity here"),ref:this.refLogActivityInput,onKeyUp:e=>{13==e.keyCode&&(e.shiftKey?this.scheduleActivity():this.logCompletedActivity())},onChange:e=>{this.refLogActivityInput.current.value=e.target.value}}))),s.createElement("div",{className:"mt-2"},s.createElement("button",{onClick:()=>{this.logCompletedActivity()},className:"btn btn-blue-outline btn-small w-full"},s.createElement("span",{className:"icon"},s.createElement("i",{className:"fas fa-check"})),s.createElement("span",{className:"text"},this.translate("Log completed activity")),s.createElement("span",{className:"shortcut"},this.translate("Enter"))),s.createElement("button",{onClick:()=>{this.scheduleActivity()},className:"btn btn-small w-full btn-blue-outline"},s.createElement("span",{className:"icon"},s.createElement("i",{className:"fas fa-clock"})),s.createElement("span",{className:"text"},this.translate("Schedule activity")),s.createElement("span",{className:"shortcut"},this.translate("Shift+Enter")))),this.divider(this.translate("Most recent activities")),t.ACTIVITIES?s.createElement("div",{className:"list"},t.ACTIVITIES.reverse().slice(0,7).map((e,t)=>s.createElement("button",{key:t,className:"btn btn-small btn-transparent btn-list-item "+(e.completed?"bg-green-50":"bg-red-50"),onClick:()=>this.setState({showIdActivity:e.id})},s.createElement("span",{className:"icon"},e.date_start," ",e.time_start,s.createElement("br",null),"@",e["_LOOKUP[id_owner]"]),s.createElement("span",{className:"text"},e.subject,e.completed?null:s.createElement("div",{className:"text-red-800"},this.translate("Not completed yet")))))):null);return s.createElement(s.Fragment,null,1==t.is_archived?s.createElement("div",{className:"alert-warning mt-2 mb-1"},s.createElement("span",{className:"icon mr-2"},s.createElement("i",{className:"fas fa-triangle-exclamation"})),s.createElement("span",{className:"text"},this.translate("This deal is archived"))):null,s.createElement("div",{className:"flex gap-2 flex-col md:flex-row"},s.createElement("div",{className:"flex-2"},s.createElement("div",{className:"card card-body flex flex-col md:flex-row gap-2"},s.createElement("div",{className:"grow"},e),s.createElement("div",{className:"border-t md:border-l border-gray-200"}),s.createElement("div",{className:"grow"},r)),n),s.createElement("div",{className:"flex-1"},this.state.id>0?s.createElement("div",{className:"flex flex-col"},s.createElement("div",{className:"badge badge-violet badge-large"},this.translate("Deal value:"),"  ",globalThis.main.numberFormat(t.price,2,","," ")," ",t.CURRENCY.code),t.PIPELINE_STEP&&t.PIPELINE_STEP.probability?s.createElement("div",{className:"badge badge-violet badge-large"},s.createElement("p",null,this.translate("Weighted profit")," (",t.PIPELINE_STEP?.probability," %):",s.createElement("strong",null," ",globalThis.main.numberFormat(this.calculateWeightedProfit(t.PIPELINE_STEP?.probability,t.price),2,","," ")," ",t.CURRENCY.code))):null):null,this.state.id>0?l:null)));case"items":var a;const o=e=>{e.current&&(a=e.current.state.data)};return s.createElement(s.Fragment,null,s.createElement("div",{className:"flex gap-2 mt-2"},s.createElement("div",{className:"card flex-2"},s.createElement("div",{className:"card-header"},this.translate("Products & Services")),s.createElement("div",{className:"card-body"},this.state.isInlineEditing?s.createElement("div",{className:"text-yellow-500 mb-3"},s.createElement("span",{className:"icon mr-2"},s.createElement("i",{className:"fas fa-warning"})),s.createElement("span",{className:"text"},this.translate("The sums of product and services prices will be updated after saving"))):s.createElement(s.Fragment,null),t.is_archived?null:s.createElement("a",{className:"btn btn-add-outline mb-2 mr-2",onClick:()=>{t.SERVICES||(t.SERVICES=[]),t.SERVICES.push({id:this.state.newEntryId,id_deal:{_useMasterRecordId_:!0},amount:1}),this.setState({isInlineEditing:!0,newEntryId:this.state.newEntryId-1})}},s.createElement("span",{className:"icon"},s.createElement("i",{className:"fas fa-add"})),s.createElement("span",{className:"text"},this.translate("Add service"))),t.is_archived?null:s.createElement("a",{className:"btn btn-add-outline mb-2",onClick:()=>{t.PRODUCTS||(t.PRODUCTS=[]),t.PRODUCTS.push({id:this.state.newEntryId,id_deal:{_useMasterRecordId_:!0},amount:1}),this.setState({isInlineEditing:!0,newEntryId:this.state.newEntryId-1})}},s.createElement("span",{className:"icon"},s.createElement("i",{className:"fas fa-add"})),s.createElement("span",{className:"text"},"Add product")),s.createElement("div",{className:"w-full h-full overflow-x-auto"},s.createElement(c,{key:"services_"+this.state.tablesKey,uid:this.props.uid+"_table_deal_services",className:"mb-4",data:{data:t.SERVICES},descriptionSource:"props",customEndpointParams:{idDeal:t.id},description:{permissions:this.state.tableDealProductsDescription?.permissions,columns:{id_product:{type:"lookup",title:this.translate("Service"),model:"HubletoApp/Community/Products/Models/Product",cellRenderer:(e,t,r)=>s.createElement(i.A,null,s.createElement(d.A,A({},this.getInputProps("services_input"),{ref:this.refServicesLookup,model:"HubletoApp/Community/Products/Models/Product",customEndpointParams:{getServices:!0},cssClass:"min-w-44",value:t.id_product,onChange:(s,r)=>{o(this.refServicesLookup),a[r]&&(t.id_product=r,t.unit_price=a[r].unit_price,t.vat=a[r].vat,this.updateRecord({SERVICES:e.state.data?.data}),this.setState({tablesKey:Math.random()}))}})))},unit_price:{type:"float",title:this.translate("Service Price")},amount:{type:"int",title:this.translate("Commitment")},discount:{type:"float",title:this.translate("Discount (%)")},vat:{type:"float",title:this.translate("Vat (%)")},sum:{type:"float",title:this.translate("Sum")}},inputs:{id_product:{type:"lookup",title:this.translate("Product"),model:"HubletoApp/Community/Products/Models/Product"},unit_price:{type:"float",title:this.translate("Unit Price")},amount:{type:"int",title:this.translate("Amount")},vat:{type:"float",title:this.translate("Vat (%)")},discount:{type:"float",title:this.translate("Discount (%)")},sum:{type:"float",title:this.translate("Sum")}}},isUsedAsInput:!0,isInlineEditing:this.state.isInlineEditing,readonly:1!=t.is_archived&&!this.state.isInlineEditing,onRowClick:()=>this.setState({isInlineEditing:!0}),onChange:e=>{this.updateRecord({SERVICES:e.state.data?.data??[]})},onDeleteSelectionChange:e=>{this.updateRecord({SERVICES:e.state.data?.data??[]}),this.setState({tablesKey:Math.random()})}}),s.createElement(c,{key:"products_"+this.state.tablesKey,uid:this.props.uid+"_table_deal_products",data:{data:t.PRODUCTS},descriptionSource:"props",customEndpointParams:{idLead:t.id},description:{permissions:this.state.tableDealProductsDescription?.permissions,columns:{id_product:{type:"lookup",title:this.translate("Product"),model:"HubletoApp/Community/Products/Models/Product",cellRenderer:(e,t,r)=>s.createElement(i.A,null,s.createElement(d.A,A({},this.getInputProps("products_input"),{ref:this.refProductsLookup,model:"HubletoApp/Community/Products/Models/Product",customEndpointParams:{getProducts:!0},cssClass:"min-w-44",value:t.id_product,onChange:(s,r)=>{o(this.refProductsLookup),a[r]&&(t.id_product=r,t.unit_price=a[r].unit_price,t.vat=a[r].vat,this.updateRecord({PRODUCTS:e.state.data?.data}),this.setState({tablesKey:Math.random()}))}})))},unit_price:{type:"float",title:this.translate("Unit Price")},amount:{type:"int",title:this.translate("Amount")},discount:{type:"float",title:this.translate("Discount (%)")},vat:{type:"float",title:this.translate("Vat (%)")},sum:{type:"float",title:this.translate("Sum")}},inputs:{id_product:{type:"lookup",title:this.translate("Product"),model:"HubletoApp/Community/Products/Models/Product"},unit_price:{type:"float",title:this.translate("Unit Price")},amount:{type:"int",title:this.translate("Amount")},vat:{type:"float",title:this.translate("Vat (%)")},discount:{type:"float",title:this.translate("Discount (%)")},sum:{type:"float",title:this.translate("Sum")}}},isUsedAsInput:!0,isInlineEditing:this.state.isInlineEditing,readonly:1!=t.is_archived&&!this.state.isInlineEditing,onRowClick:()=>this.setState({isInlineEditing:!0}),onChange:e=>{this.updateRecord({PRODUCTS:e.state.data?.data??[]})},onDeleteSelectionChange:e=>{this.updateRecord({PRODUCTS:e.state.data?.data??[]}),this.setState({tablesKey:Math.random()})}}))))));case"calendar":return s.createElement(s.Fragment,null,s.createElement(m.A,{onCreateCallback:()=>this.loadRecord(),readonly:t.is_archived,initialView:"timeGridWeek",views:"timeGridDay,timeGridWeek,dayGridMonth,listYear",eventsEndpoint:globalThis.main.config.rootUrl+"/calendar/api/get-calendar-events?source=deals&idDeal="+t.id,onDateClick:(e,t,a)=>{this.setState({activityDate:e,activityTime:t,activityAllDay:!1,showIdActivity:-1})},onEventClick:e=>{this.setState({showIdActivity:parseInt(e.event.id)}),e.jsEvent.preventDefault()}}));case"documents":return s.createElement(s.Fragment,null,s.createElement("div",{className:"divider"},s.createElement("div",null,s.createElement("div",null,s.createElement("div",null)),s.createElement("div",null,s.createElement("span",null,this.translate("Local documents"))))),t.is_archived?null:s.createElement("a",{className:"btn btn-add-outline mb-2",onClick:()=>this.setState({showIdDocument:-1})},s.createElement("span",{className:"icon"},s.createElement("i",{className:"fas fa-add"})),s.createElement("span",{className:"text"},this.translate("Add document"))),s.createElement(p,{key:this.state.tablesKey+"_table_deal_document",uid:this.props.uid+"_table_deal_documents",data:{data:t.DOCUMENTS},customEndpointParams:{idDeal:t.id},descriptionSource:"props",description:{permissions:this.state.tableDealDocumentsDescription?.permissions,ui:{showFooter:!1,showHeader:!1},columns:{id_document:{type:"lookup",title:this.translate("Document"),model:"HubletoApp/Community/Documents/Models/Document"},hyperlink:{type:"varchar",title:this.translate("Link"),cellRenderer:(e,t,a)=>s.createElement(i.A,null,s.createElement(C.A,A({},this.getInputProps("document-link"),{value:t.DOCUMENT.hyperlink?t.DOCUMENT.hyperlink:null,readonly:!0})))}},inputs:{id_document:{type:"lookup",title:this.translate("Document"),model:"HubletoApp/Community/Documents/Models/Document"},hyperlink:{type:"varchar",title:this.translate("Link"),readonly:!0}}},isUsedAsInput:!0,readonly:1!=t.is_archived&&!this.state.isInlineEditing,onRowClick:(e,t)=>{this.setState({showIdDocument:t.id_document})},onDeleteSelectionChange:e=>{this.updateRecord({DOCUMENTS:e.state.data?.data??[]}),this.setState({tablesKey:Math.random()})}}),0!=this.state.showIdDocument?s.createElement(b.A,{uid:"document_form",isOpen:!0,type:"right"},s.createElement(u.A,{id:this.state.showIdDocument,onClose:()=>this.setState({showIdDocument:0}),showInModal:!0,descriptionSource:"both",description:{defaultValues:{creatingForModel:"HubletoApp/Community/Deals/Models/DealDocument",creatingForId:this.state.record.id,origin_link:window.location.pathname+"?recordId="+this.state.record.id}},isInlineEditing:this.state.showIdDocument<0,showInModalSimple:!0,onSaveCallback:(e,t)=>{(t.status="success")&&(this.loadRecord(),this.setState({showIdDocument:0}))},onDeleteCallback:(e,t)=>{(t.status="success")&&(this.loadRecord(),this.setState({showIdDocument:0}))}})):null);case"history":return t.HISTORY&&t.HISTORY.length>0&&t.HISTORY.length>1&&t.HISTORY[0].id<t.HISTORY[t.HISTORY.length-1].id&&(t.HISTORY=this.state.record.HISTORY.reverse()),s.createElement(s.Fragment,null,s.createElement("div",{className:"card"},s.createElement("div",{className:"card-body [&_*]:whitespace-normal"},s.createElement(f,{uid:this.props.uid+"_table_deal_history",data:{data:t.HISTORY},descriptionSource:"props",onRowClick:e=>{},description:{permissions:{canCreate:!1,canDelete:!1,canRead:!0,canUpdate:!1},ui:{showFooter:!1,showHeader:!1},columns:{description:{type:"varchar",title:this.translate("Description")},change_date:{type:"date",title:this.translate("Change Date")}},inputs:{description:{type:"varchar",title:this.translate("Description"),readonly:!0},change_date:{type:"date",title:this.translate("Change Date")}}},readonly:!0}))))}}renderContent(){const e=this.state.record;return s.createElement(s.Fragment,null,super.renderContent(),0==this.state.showIdActivity?s.createElement(s.Fragment,null):s.createElement(b.A,{uid:"activity_form",isOpen:!0,type:"right"},s.createElement(E,{id:this.state.showIdActivity,isInlineEditing:!0,description:{defaultValues:{id_deal:e.id,id_contact:e.id_contact,date_start:this.state.activityDate,time_start:"00:00:00"==this.state.activityTime?null:this.state.activityTime,date_end:this.state.activityDate,all_day:this.state.activityAllDay,subject:this.state.activitySubject}},idCustomer:e.id_customer,showInModal:!0,showInModalSimple:!0,onClose:()=>{this.setState({showIdActivity:0})},onSaveCallback:(e,t)=>{"success"==t.status&&this.setState({showIdActivity:0})}})))}}class _ extends r.A{static defaultProps={...r.A.defaultProps,orderBy:{field:"id",direction:"desc"},formUseModalSimple:!0,model:"HubletoApp/Community/Deals/Models/Deal"};translationContext="HubletoApp\\Community\\Deals\\Loader::Components\\TableDeals";constructor(e){super(e),this.state=this.getStateFromProps(e)}getStateFromProps(e){return{...super.getStateFromProps(e),showArchive:e.showArchive??!1}}getFormModalProps(){let e=super.getFormModalProps();return e.type="right wide",e}getEndpointParams(){return{...super.getEndpointParams(),showArchive:this.props.showArchive?1:0,idCustomer:this.props.idCustomer}}renderCell(e,t,a,r){return"title"==e?s.createElement(s.Fragment,null,super.renderCell(e,t,a,r),a.note?s.createElement("div",{className:"badge badge-extra-small badge-warning block whitespace-pre truncate",style:{maxHeight:"2.7em",maxWidth:"20em",overflow:"hidden"}},s.createElement("i",{className:"fas fa-note-sticky mr-2"}),a.note):null):super.renderCell(e,t,a,r)}renderForm(){let e=this.getFormProps();return e.customEndpointParams.idCustomer=this.props.idCustomer,e.customEndpointParams.showArchive=this.props.showArchive??!1,s.createElement(S,e)}}var N=a(191),F=a(9605);class x extends F.A{translationContext="HubletoApp\\Community\\Deals\\Loader::Components\\FormDeal";constructor(e){super(e),this.state={showDeals:!1}}render(){const e=this.props.form,t=e.state.record;if(t.id>0)return s.createElement(s.Fragment,null,s.createElement("button",{className:"btn btn-transparent",onClick:()=>{this.setState({showDeals:!this.state.showDeals})}},s.createElement("span",{className:"icon"},s.createElement("i",{className:"fas fa-handshake"})),s.createElement("span",{className:"text"},this.translate("Deals"))),this.state.showDeals?s.createElement(N.A,{uid:"customer_table_deals_modal",isOpen:!0,type:"centered",showHeader:!0,title:this.translate("Deals"),onClose:e=>{this.setState({showDeals:!1})}},s.createElement(_,{uid:e.props.uid+"_table_deals",parentForm:e,idCustomer:t.id})):null)}}class T extends F.A{translationContext="HubletoApp\\Community\\Deals\\Loader::Components\\FormDeal";constructor(e){super(e),this.state={showDeals:!1}}convertToDeal(e){l.A.get("deals/api/convert-lead-to-deal",{recordId:e},e=>{"success"==e.status&&location.assign(globalThis.main.config.rootUrl+`/deals?recordId=${e.idDeal}&recordTitle=${e.title}`)})}convertDealWarning(e){globalThis.main.showDialogDanger(s.createElement(s.Fragment,null,s.createElement("div",null,"Are you sure you want to convert this Lead to a Deal?",s.createElement("br",null))),{headerClassName:"dialog-warning-header",header:"Convert to a Deal",footer:s.createElement(s.Fragment,null,s.createElement("button",{className:"btn btn-yellow",onClick:()=>{this.convertToDeal(e)}},s.createElement("span",{className:"icon"},s.createElement("i",{className:"fas fa-forward"})),s.createElement("span",{className:"text"},"Yes, convert to a Deal")),s.createElement("button",{className:"btn btn-transparent",onClick:()=>{globalThis.main.lastShownDialogRef.current.hide()}},s.createElement("span",{className:"icon"},s.createElement("i",{className:"fas fa-times"})),s.createElement("span",{className:"text"},"No, do not convert to a Deal")))})}render(){const e=this.props.form.state.record;return null!=e.DEAL?s.createElement("a",{className:"btn btn-transparent",href:`${globalThis.main.config.rootUrl}/deals/${e.DEAL.id}`},s.createElement("span",{className:"icon"},s.createElement("i",{className:"fas fa-arrow-up-right-from-square"})),s.createElement("span",{className:"text"},this.translate("Go to deal"))):s.createElement("a",{className:"btn btn-transparent",onClick:()=>this.convertDealWarning(e.id)},s.createElement("span",{className:"icon"},s.createElement("i",{className:"fas fa-rotate-right"})),s.createElement("span",{className:"text"},"Convert to Deal"))}}globalThis.main.registerReactComponent("DealsTableDeals",_),globalThis.main.registerReactComponent("DealsFormActivity",E),globalThis.main.registerDynamicContent("FormCustomer:TopMenu",x),globalThis.main.registerDynamicContent("FormLead:TopMenu",T)},4319:(e,t,a)=>{"use strict";var s=a(9471),r=a(1056),n=a(4721),i=a(9100);class l extends n.A{static defaultProps={...n.A.defaultProps,model:"HubletoApp/Community/Campaigns/Models/Campaign"};translationContext="HubletoApp\\Community\\Campaigns\\Loader::Components\\FormCampaign";constructor(e){super(e),this.state=this.getStateFromProps(e)}getStateFromProps(e){return{...super.getStateFromProps(e)}}renderTitle(){return s.createElement(s.Fragment,null,s.createElement("h2",null,this.state.record.subject?this.state.record.subject:""),s.createElement("small",null,this.translate("Campaign")))}renderContent(){const e=this.state.record;return e?s.createElement(s.Fragment,null,s.createElement("div",{className:"w-full flex gap-2"},s.createElement("div",{className:"flex-1 border-r border-gray-100"},this.inputWrapper("name"),this.inputWrapper("target_audience"),this.inputWrapper("goal")),s.createElement("div",{className:"flex-1"},this.inputWrapper("id_manager"),this.inputWrapper("notes"),this.inputWrapper("color"),this.inputWrapper("datetime_created"))),this.divider(this.translate("Leads")),this.state.id<0?s.createElement("div",{className:"badge badge-info"},this.translate("First create the campaign, then you will be prompted to create leads.")):s.createElement(i.A,{uid:this.props.uid+"_table_leads",tag:"CampaignLeads",parentForm:this,idCampaign:e.id,selectionMode:"multiple"})):null}}class o extends r.A{static defaultProps={...r.A.defaultProps,formUseModalSimple:!0,model:"HubletoApp/Community/Campaigns/Models/Campaign"};translationContext="HubletoApp\\Community\\Campaigns\\Loader::Components\\TableCampaigns";constructor(e){super(e),this.state=this.getStateFromProps(e)}getStateFromProps(e){return{...super.getStateFromProps(e)}}getFormModalProps(){return{...super.getFormModalProps(),type:"right wide"}}renderForm(){let e=this.getFormProps();return s.createElement(l,e)}}globalThis.main.registerReactComponent("CampaignsTableCampaigns",o)},4358:(e,t,a)=>{"use strict";var s=a(9471),r=a(6643),n=a(4721),i=a(3568),l=a(436),o=a(8947),c=a(470),d=a(5882);function m(){return m=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},m.apply(null,arguments)}class p extends d.A{static defaultProps={...d.A.defaultProps,model:"HubletoApp/Community/Customers/Models/CustomerActivity"};translationContext="HubletoApp\\Community\\Customers\\Loader::Components\\CustomerFormActivity";getActivitySourceReadable(){return this.translate("Customer")}renderCustomInputs(){const e=this.state.record;return s.createElement(s.Fragment,null,s.createElement(l.A,{title:this.translate("Customer"),required:!0},s.createElement(c.A,m({},this.getInputProps("id_customer"),{model:"HubletoApp/Community/Contacts/Models/Customer",endpoint:"customers/api/get-customer",value:e.id_customer,onChange:(e,t)=>{this.updateRecord({id_customer:t})}}))),s.createElement(l.A,{title:this.translate("Contact")},s.createElement(c.A,m({},this.getInputProps("id_contact"),{model:"HubletoApp/Community/Contacts/Models/Contact",endpoint:"contacts/get-customer-contacts",customEndpointParams:{id_customer:e.id_customer},value:e.id_contact,onChange:(t,a)=>{this.updateRecord({id_contact:a}),0==e.id_contact&&(e.id_contact=null,this.setState({record:e}))}}))))}}var u=a(2395),h=a(1056);class g extends h.A{static defaultProps={...h.A.defaultProps,formUseModalSimple:!0,model:"HubletoApp/Community/Customers/Models/CustomerDocument"};translationContext="HubletoApp\\Community\\Customers\\Loader::Components\\TableCustomerDocuments";constructor(e){super(e),this.state=this.getStateFromProps(e)}getStateFromProps(e){return{...super.getStateFromProps(e)}}}var E=a(8242),b=a(5247),C=a(3041),y=a(2908),v=a(1612),f=a(2198),P=a.n(f);function A(){return A=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},A.apply(null,arguments)}class S extends n.A{static defaultProps={...n.A.defaultProps,model:"HubletoApp/Community/Customers/Models/Customer",tabs:{default:{title:"Customer"},contacts:{title:"Contacts"},calendar:{title:"Calendar"},documents:{title:"Documents"}}};translationContext="HubletoApp\\Community\\Customers\\Loader::Components\\FormCustomer";constructor(e){super(e),this.refLogActivityInput=s.createRef(),this.state={...this.getStateFromProps(e),highlightIdActivity:this.props.highlightIdActivity??0,createNewLead:!1,createNewDeal:!1,createNewContact:!1,showIdDocument:0,newEntryId:this.props.newEntryId??-1,showIdActivity:0,activityTime:"",activityDate:"",activitySubject:"",activityAllDay:!1,tablesKey:0}}componentDidUpdate(e,t){t.isInlineEditing!=this.state.isInlineEditing&&this.setState({tablesKey:Math.random()})}getStateFromProps(e){return{...super.getStateFromProps(e)}}onBeforeSaveRecord(e){return e.tax_id&&(e.tax_id=e.tax_id.replace(/\s+/g,"")),e.vat_id&&(e.vat_id=e.vat_id.replace(/\s+/g,"")),e.customer_id&&(e.customer_id=e.customer_id.replace(/\s+/g,"")),e}renderTitle(){return s.createElement(s.Fragment,null,s.createElement("h2",null,this.state.record.name?this.state.record.name:""),s.createElement("small",null,this.translate("Customer")))}onAfterFormInitialized(){v.A.get("api/table/describe",{model:"HubletoApp/Community/Contacts/Models/Value",idContact:-1},e=>{this.setState({tableValuesDescription:e})})}renderNewContactForm(e){return s.createElement(u.A,{uid:"contact_form",isOpen:!0,type:"right wide"},s.createElement(b.A,{id:-1,creatingNew:!0,isInlineEditing:!0,descriptionSource:"both",tableValuesDescription:this.state.tableValuesDescription,description:{defaultValues:{id_customer:e.id}},showInModal:!0,showInModalSimple:!0,onClose:()=>{this.setState({createNewContact:!1})},onSaveCallback:(e,t)=>{(t.status="success")&&(this.setState({createNewContact:!1}),this.loadRecord())}}))}renderActivityForm(e){return s.createElement(u.A,{uid:"activity_form",isOpen:!0,type:"right theme-secondary"},s.createElement(p,{id:this.state.showIdActivity,isInlineEditing:!0,description:{defaultValues:{id_customer:e.id,date_start:this.state.activityDate,time_start:"00:00:00"==this.state.activityTime?null:this.state.activityTime,date_end:this.state.activityDate,subject:this.state.activitySubject,all_day:this.state.activityAllDay}},showInModal:!0,showInModalSimple:!0,onClose:()=>{this.setState({showIdActivity:0})},onSaveCallback:(e,t)=>{"success"==t.status&&this.setState({showIdActivity:0})}}))}renderDocumentForm(){return s.createElement(u.A,{uid:"document_form",isOpen:!0,type:"right"},s.createElement(E.A,{id:this.state.showIdDocument,onClose:()=>this.setState({showIdDocument:0}),showInModal:!0,descriptionSource:"both",description:{defaultValues:{creatingForModel:"HubletoApp/Community/Customers/Models/CustomerDocument",creatingForId:this.state.record.id,origin_link:window.location.pathname+"?recordId="+this.state.record.id}},isInlineEditing:this.state.showIdDocument<0,showInModalSimple:!0,onSaveCallback:(e,t)=>{(t.status="success")&&(this.loadRecord(),this.setState({showIdDocument:0}))},onDeleteCallback:(e,t)=>{(t.status="success")&&(this.loadRecord(),this.setState({showIdDocument:0}))}}))}logCompletedActivity(){v.A.get("customers/api/log-activity",{idCustomer:this.state.record.id,activity:this.refLogActivityInput.current.value},e=>{this.loadRecord(),this.refLogActivityInput.current.value=""})}scheduleActivity(){this.setState({showIdActivity:-1,activityDate:P()().add(1,"week").format("YYYY-MM-DD"),activityTime:P()().add(1,"week").format("H:00:00"),activitySubject:this.refLogActivityInput.current.value,activityAllDay:!1})}renderTab(e){const t=this.state.record;switch(e){case"default":const e=this.renderCustomInputs();let a="";""!=t.street_line_1&&""!=t.city&&t.COUNTRY&&""!=t.COUNTRY.name&&(a=t.street_line_1+", "+t.postal_code+" "+t.city+", "+(t.region?t.region+", ":"")+t.COUNTRY.name);const r=s.createElement("div",{className:"card card-body shadow-blue-200"},s.createElement("div",{className:"mb-2"},s.createElement(C.A,{onCreateCallback:()=>this.loadRecord(),readonly:t.is_archived,initialView:"dayGridMonth",headerToolbar:{start:"title",center:"",end:"prev,today,next"},eventsEndpoint:globalThis.main.config.rootUrl+"/calendar/api/get-calendar-events?source=customers&idCustomer="+t.id,onDateClick:(e,t,a)=>{this.setState({activityDate:e,activityTime:t,activityAllDay:!1,showIdActivity:-1})},onEventClick:e=>{this.setState({showIdActivity:parseInt(e.event.id)}),e.jsEvent.preventDefault()}})),s.createElement("div",{className:"adios component input"},s.createElement("div",{className:"input-element w-full flex gap-2"},s.createElement("input",{className:"w-full bg-blue-50 border border-blue-800 p-1 text-blue-800 placeholder-blue-300",placeholder:this.translate("Type recent activity here"),ref:this.refLogActivityInput,onKeyUp:e=>{13==e.keyCode&&(e.shiftKey?this.scheduleActivity():this.logCompletedActivity())},onChange:e=>{this.refLogActivityInput.current.value=e.target.value}}))),s.createElement("div",{className:"mt-2"},s.createElement("button",{onClick:()=>{this.logCompletedActivity()},className:"btn btn-blue-outline btn-small w-full"},s.createElement("span",{className:"icon"},s.createElement("i",{className:"fas fa-check"})),s.createElement("span",{className:"text"},this.translate("Log completed activity")),s.createElement("span",{className:"shortcut"},this.translate("Enter"))),s.createElement("button",{onClick:()=>{this.scheduleActivity()},className:"btn btn-small w-full btn-blue-outline"},s.createElement("span",{className:"icon"},s.createElement("i",{className:"fas fa-clock"})),s.createElement("span",{className:"text"},this.translate("Schedule activity")),s.createElement("span",{className:"shortcut"},this.translate("Shift+Enter")))),this.divider(this.translate("Most recent activities")),t.ACTIVITIES?s.createElement("div",{className:"list"},t.ACTIVITIES.reverse().slice(0,7).map((e,t)=>s.createElement(s.Fragment,null,s.createElement("button",{key:t,className:"btn btn-small btn-transparent btn-list-item "+(e.completed?"bg-green-50":"bg-red-50"),onClick:()=>this.setState({showIdActivity:e.id})},s.createElement("span",{className:"icon"},e.date_start," ",e.time_start,s.createElement("br",null),"@",e["_LOOKUP[id_owner]"]),s.createElement("span",{className:"text"},e.subject,e.completed?null:s.createElement("div",{className:"text-red-800"},this.translate("Not completed yet"))))))):null);return s.createElement(s.Fragment,null,s.createElement("div",{className:"flex gap-2"},s.createElement("div",{className:"flex-2 card"},s.createElement("div",{className:"card-body flex flex-row gap-2"},s.createElement("div",{className:"w-1/2"},this.inputWrapper("name",{cssClass:"text-2xl text-primary"}),this.inputWrapper("customer_id"),this.inputWrapper("street_line_1"),this.inputWrapper("street_line_2"),this.inputWrapper("city"),this.inputWrapper("region"),this.inputWrapper("id_country"),s.createElement("div",{className:"flex justify-between"},this.inputWrapper("postal_code"),""==a?null:s.createElement("div",null,s.createElement("a",{href:"https://maps.google.com/?q="+encodeURIComponent(a),target:"_blank",className:"btn btn-transparent"},s.createElement("span",{className:"icon"},s.createElement("i",{className:"fas fa-map"})),s.createElement("span",{className:"text"},this.translate("Show on map"))))),this.inputWrapper("shared_folder",{readonly:t.is_archived})),s.createElement("div",{className:"border-l border-gray-200"}),s.createElement("div",{className:"w-1/2"},this.inputWrapper("note",{cssClass:"bg-yellow-50",readonly:t.is_archived}),this.inputWrapper("vat_id"),this.inputWrapper("tax_id"),this.inputWrapper("date_created"),this.inputWrapper("is_active"),s.createElement(l.A,{title:"Tags"},s.createElement(i.A,A({},this.getInputProps("tags"),{value:this.state.record.TAGS,model:"HubletoApp/Community/Customers/Models/Tag",targetColumn:"id_customer",sourceColumn:"id_tag",colorColumn:"color",onChange:(e,a)=>{t.TAGS=a,this.setState({record:t})}}))),this.inputWrapper("id_owner"),this.inputWrapper("id_manager")))),this.state.id>0?s.createElement(s.Fragment,null,s.createElement("div",{className:"flex-1"},r)):null),e.length>0?s.createElement("div",{className:"card mt-2"},s.createElement("div",{className:"card-header"},"Custom data"),s.createElement("div",{className:"card-body"},e)):s.createElement(s.Fragment,null));case"contacts":return s.createElement(s.Fragment,null,s.createElement("a",{className:"btn btn-add-outline mr-2 float-left",onClick:()=>{t.CONTACTS||(t.CONTACTS=[]),this.setState({createNewContact:!0})}},s.createElement("span",{className:"icon"},s.createElement("i",{className:"fas fa-add"})),s.createElement("span",{className:"text"},this.translate("Add contact"))),s.createElement(o.A,{uid:this.props.uid+"_table_contacts",parentForm:this,isUsedAsInput:!0,readonly:!this.state.isInlineEditing,customEndpointParams:{idCustomer:t.id},descriptionSource:"props",description:{ui:{showFulltextSearch:!0},permissions:this.props.tableContactsDescription?.permissions??{},columns:{first_name:{type:"varchar",title:this.translate("First name")},last_name:{type:"varchar",title:this.translate("Last name")},virt_email:{type:"varchar",title:this.translate("Email")},virt_number:{type:"varchar",title:this.translate("Phone number")},is_primary:{type:"boolean",title:this.translate("Primary Contact")},tags:{type:"none",title:this.translate("Tags")}},inputs:{first_name:{type:"varchar",title:this.translate("First name")},last_name:{type:"varchar",title:this.translate("Last name")},is_primary:{type:"boolean",title:this.translate("Primary Contact")}}},onRowClick:(e,t)=>{var a=this.props.tableContactsDescription;a.idContact=t.id,e.onAfterLoadTableDescription(a),e.openForm(t.id)},onChange:e=>{this.updateRecord({CONTACTS:e.state.data?.data})},onDeleteSelectionChange:e=>{this.updateRecord({CONTACTS:e.state.data?.data??[]})}}),this.state.createNewContact?this.renderNewContactForm(t):null);case"calendar":return s.createElement(s.Fragment,null,s.createElement(C.A,{onCreateCallback:()=>this.loadRecord(),readonly:t.is_archived,initialView:"timeGridWeek",views:"timeGridDay,timeGridWeek,dayGridMonth,listYear",eventsEndpoint:globalThis.main.config.rootUrl+"/calendar/api/get-calendar-events?source=customers&idCustomer="+t.id,onDateClick:(e,t,a)=>{this.setState({activityDate:e,activityTime:t,showIdActivity:-1})},onEventClick:e=>{this.setState({showIdActivity:parseInt(e.event.id)}),e.jsEvent.preventDefault()}}),0==this.state.showIdActivity?null:this.renderActivityForm(t));case"documents":return s.createElement(s.Fragment,null,s.createElement("a",{className:"btn btn-add-outline mb-2",onClick:()=>this.setState({showIdDocument:-1})},s.createElement("span",{className:"icon"},s.createElement("i",{className:"fas fa-add"})),s.createElement("span",{className:"text"},"Add document")),s.createElement(g,{key:this.state.tablesKey+"_table_documents",uid:this.props.uid+"_table_documents",data:{data:t.DOCUMENTS},descriptionSource:"props",customEndpointParams:{idCustomer:t.id},isUsedAsInput:!0,readonly:!this.state.isInlineEditing,description:{permissions:this.props.tableDocumentsDescription?.permissions,ui:{showFooter:!1,showHeader:!1},columns:{id_document:{type:"lookup",title:"Document",model:"HubletoApp/Community/Documents/Models/Document"},hyperlink:{type:"varchar",title:"Link",cellRenderer:(e,t,a)=>s.createElement(l.A,null,s.createElement(y.A,A({},this.getInputProps("document_link"),{value:t.DOCUMENT.hyperlink,readonly:!0})))}},inputs:{id_document:{type:"lookup",title:"Document",model:"HubletoApp/Community/Documents/Models/Document"},hyperlink:{type:"varchar",title:"Link",readonly:!0}}},onRowClick:(e,t)=>{this.setState({showIdDocument:t.id_document})},onDeleteSelectionChange:e=>{this.updateRecord({DOCUMENTS:e.state.data?.data??[]}),this.setState({tablesKey:Math.random()})}}),0!=this.state.showIdDocument?this.renderDocumentForm():null)}}}class _ extends r.A{static defaultProps={...r.A.defaultProps,orderBy:{field:"id",direction:"desc"},formUseModalSimple:!0,model:"HubletoApp/Community/Customers/Models/Customer"};translationContext="HubletoApp\\Community\\Customers\\Loader::Components\\TableCustomers";getFormModalProps(){return{...super.getFormModalProps(),type:"right wide"}}renderCell(e,t,a,r){return"tags"==e?s.createElement(s.Fragment,null,a.TAGS.map((e,t)=>s.createElement("div",{style:{backgroundColor:e.TAG.color},className:"badge",key:"tag-"+a.id+"-"+t},e.TAG.name))):super.renderCell(e,t,a,r)}onAfterLoadTableDescription(e){return v.A.get("api/table/describe",{model:"HubletoApp/Community/Contacts/Models/Contact",idCustomer:this.props.recordId},e=>{this.setState({tableContactsDescription:e})}),v.A.get("api/table/describe",{model:"HubletoApp/Community/Leads/Models/Lead",idCustomer:this.props.recordId},e=>{this.setState({tableLeadsDescription:e})}),v.A.get("api/table/describe",{model:"HubletoApp/Community/Deals/Models/Deal",idCustomer:this.props.recordId},e=>{this.setState({tableDealsDescription:e})}),v.A.get("api/table/describe",{model:"HubletoApp/Community/Customers/Models/CustomerDocument",idCustomer:this.props.recordId},e=>{this.setState({tableDocumentsDescription:e})}),e}renderForm(){let e=this.getFormProps();return e.uid="form_customer",e.tableContactsDescription=this.state.tableContactsDescription,e.tableLeadsDescription=this.state.tableLeadsDescription,e.tableDealsDescription=this.state.tableDealsDescription,e.tableDocumentsDescription=this.state.tableDocumentsDescription,s.createElement(S,e)}}class N extends h.A{static defaultProps={...h.A.defaultProps,formUseModalSimple:!0,model:"HubletoApp/Community/Customers/Models/Activity"};translationContext="HubletoApp\\Community\\Customers\\Loader::Components\\TableActivities";constructor(e){super(e),this.state=this.getStateFromProps(e)}getStateFromProps(e){return{...super.getStateFromProps(e)}}renderForm(){let e=this.getFormProps();return s.createElement(p,e)}}globalThis.main.registerReactComponent("CustomersTableCustomers",_),globalThis.main.registerReactComponent("CustomersTableActivities",N),globalThis.main.registerReactComponent("CustomersFormActivity",p)},4418:(e,t,a)=>{"use strict";var s=a(9471),r=a(1056),n=a(9292),i=a(4721);class l extends r.A{static defaultProps={...r.A.defaultProps,formUseModalSimple:!0,model:"HubletoApp/Community/Pipeline/Models/PipelineStep"};translationContext="HubletoApp\\Community\\Pipeline\\Loader::Components\\TablePipelineSteps";constructor(e){super(e),this.state=this.getStateFromProps(e)}getFormModalProps(){return{...super.getFormModalProps(),type:"right wide"}}}class o extends i.A{static defaultProps={...i.A.defaultProps,model:"HubletoApp/Community/Pipeline/Models/Pipeline"};translationContext="HubletoApp\\Community\\Pipeline\\Loader::Components\\FormPipeline";constructor(e){super(e),this.state={...this.getStateFromProps(e),tablesKey:0}}getStateFromProps(e){return{...super.getStateFromProps(e)}}renderTitle(){return-1==(0,n.P3)("recordId")?s.createElement(s.Fragment,null,s.createElement("h2",null,"New Pipeline")):s.createElement(s.Fragment,null,s.createElement("h2",null,this.state.record.name?this.state.record.name:"[Undefined Name]"))}componentDidUpdate(e,t){t.isInlineEditing!=this.state.isInlineEditing&&this.setState({tablesKey:Math.random()})}renderContent(){const e=this.state.record;return e.id,s.createElement(s.Fragment,null,s.createElement("div",{className:"grid grid-cols-2 gap-1",style:{gridTemplateAreas:"\n            'info info'\n            'steps steps'\n          "}},s.createElement("div",{className:"card mt-4",style:{gridArea:"info"}},s.createElement("div",{className:"card-header"},"Pipeline Information"),s.createElement("div",{className:"card-body flex flex-row justify-around"},this.inputWrapper("name"),this.inputWrapper("type"),this.inputWrapper("description"))),s.createElement("div",{className:"card mt-4",style:{gridArea:"steps"}},s.createElement("div",{className:"card-header"},"Pipeline Steps"),s.createElement("div",{className:"card-body"},s.createElement("a",{className:"btn btn-add-outline mb-2",onClick:()=>{e.STEPS||(e.STEPS=[]),e.STEPS.push({id_pipeline:{_useMasterRecordId_:!0}}),this.setState({record:e,isInlineEditing:!0})}},s.createElement("span",{className:"icon"},s.createElement("i",{className:"fas fa-add"})),s.createElement("span",{className:"text"},"Add step")),s.createElement(l,{key:this.state.tablesKey,uid:this.props.uid+"_table_pipeline_steps_input",context:"Hello World",descriptionSource:"props",data:{data:e.STEPS},isUsedAsInput:!0,isInlineEditing:this.state.isInlineEditing,onRowClick:()=>this.setState({isInlineEditing:!0}),onChange:e=>{this.updateRecord({STEPS:e.state.data?.data})},description:{ui:{showFooter:!1,showHeader:!1},permissions:{canCreate:!0,canDelete:!0,canRead:!0,canUpdate:!0},columns:{name:{type:"varchar",title:"Name"},order:{type:"int",title:"Order"},color:{type:"color",title:"Color"},probability:{type:"int",title:"Probability",unit:"%"},set_result:{type:"integer",title:"Sets result of a deal to",enumValues:{1:"Pending",2:"Won",3:"Lost"}}},inputs:{name:{type:"varchar",title:"Name"},order:{type:"int",title:"Order"},color:{type:"color",title:"Color"},probability:{type:"int",title:"Probability",unit:"%"},set_result:{type:"integer",title:"Sets result of a deal to",enumValues:{1:"Pending",2:"Won",3:"Lost"}}}}})))))}}class c extends r.A{static defaultProps={...r.A.defaultProps,formUseModalSimple:!0,model:"HubletoApp/Community/Pipeline/Models/Pipeline"};translationContext="HubletoApp\\Community\\Pipeline\\Loader::Components\\TablePipelines";constructor(e){super(e),this.state=this.getStateFromProps(e)}renderForm(){let e=this.getFormProps();return s.createElement(o,e)}}globalThis.main.registerReactComponent("SettingsTablePipelines",c)},4432:(e,t,a)=>{"use strict";var s=a(9471),r=(a(5056),a(624)),n=a(1612),i=a(191),l=a(7540),o=a(2469),c=a(470),d=a(2281),m=a(298),p=a(5664),u=a(2908),h=a(6654),g=a(4721),E=a(6643),b=a(5513),C=a(6561),y=a(7992);class v extends r.x{language="en";idUser=0;apps={};dynamicContentInjectors={};constructor(e){super(e),this.registerReactComponent("Modal",i.A),this.registerReactComponent("InputVarchar",l.A),this.registerReactComponent("InputInt",o.A),this.registerReactComponent("InputLookup",c.A),this.registerReactComponent("InputBoolean",m.A),this.registerReactComponent("InputImage",d.A),this.registerReactComponent("InputColor",p.A),this.registerReactComponent("InputHyperlink",u.A),this.registerReactComponent("TableCellRendererHyperlink",h.A),this.registerReactComponent("Form",g.A),this.registerReactComponent("Table",E.A),this.registerReactComponent("TableColumnsCustomize",C.A),this.registerReactComponent("Chart",b.A),this.registerReactComponent("Tooltip",y.m)}translate(e,t){let a=e,s=(t??"").split("::");const r=s[0],n=s[1];return null===this.dictionary?e:(this.dictionary[r]&&this.dictionary[r][n]&&this.dictionary[r][n][e]&&""!=this.dictionary[r][n][e]?(console.log("tr1"),a=this.dictionary[r][n][e]??""):(console.log("tr2"),a="",this.addToDictionary(e,t)),""==a&&(a=t+"#"+e),a)}loadDictionary(e){"en"!=e&&(this.language=e,n.A.get("api/dictionary",{language:e},e=>{this.dictionary=e}))}addToDictionary(e,t){n.A.get("api/dictionary",{language:this.language,addNew:{orig:e,context:t}})}registerApp(e,t){this.apps[e]=new t(this)}createThemeObserver(){new MutationObserver((e,t)=>{"dark"==localStorage.theme?$("*").addClass("dark"):$("*").removeClass("dark")}).observe(document,{subtree:!0,attributes:!0})}startConsoleErrorLogger(){if(console.log("Hubleto: Starting console.error debugger."),window.console&&console.error){const e=console.error;console.error=function(){n.A.post("api/log-javascript-error",{},{errorRoute:"{{ route }}",errors:arguments}),e.apply(this,arguments)}}}numberFormat(e,t=2,a=",",s=" "){e=(e??"").toString().replace(/[^0-9+\-Ee.]/g,"");let r=parseFloat(e);r=Math.round(r*Math.pow(10,t))/Math.pow(10,t);let[n,i]=r.toString().split(".");for(n=n.replace(/\B(?=(\d{3})+(?!\d))/g,s),void 0===i&&(i="");i.length<t;)i+="0";return n+(t>0?a+i:"")}registerDynamicContent(e,t){this.dynamicContentInjectors[e]||(this.dynamicContentInjectors[e]=[]),this.dynamicContentInjectors[e].push(t)}injectDynamicContent(e,t){if(this.dynamicContentInjectors&&this.dynamicContentInjectors[e]){let a=[];for(let r in this.dynamicContentInjectors[e])a.push(s.createElement(this.dynamicContentInjectors[e][r],t));return a}return null}}const f=new v(window.ConfigEnv);globalThis.app=f,globalThis.main=f},4876:(e,t,a)=>{"use strict";a.d(t,{A:()=>c});var s=a(9471),r=a(4721),n=a(5882),i=a(436),l=a(470);function o(){return o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},o.apply(null,arguments)}class c extends n.A{static defaultProps={...r.A.defaultProps,model:"HubletoApp/Community/Leads/Models/LeadActivity"};translationContext="HubletoApp\\Community\\Leads\\Loader::Components\\FormActivity";constructor(e){super(e)}getActivitySourceReadable(){return this.translate("Lead")}renderCustomInputs(){const e=this.state.record;return s.createElement(s.Fragment,null,this.inputWrapper("id_lead"),s.createElement(i.A,{title:this.translate("Contact")},s.createElement(l.A,o({},this.getInputProps("id_contact"),{model:"HubletoApp/Community/Contacts/Models/Contact",endpoint:"contacts/get-customer-contacts",customEndpointParams:{id_customer:this.props.idCustomer},value:e.id_contact,onChange:(t,a)=>{this.updateRecord({id_contact:a}),0==e.id_contact&&(e.id_contact=null,this.setState({record:e}))}}))))}}},5241:(e,t,a)=>{"use strict";var s=a(1056);class r extends s.A{static defaultProps={...s.A.defaultProps,formUseModalSimple:!0,model:"HubletoApp/Community/Billing/Models/BillingAccountService"};translationContext="HubletoApp\\Community\\Billing\\Loader::Components\\TableBillingAccountServices";constructor(e){super(e),this.state=this.getStateFromProps(e)}}globalThis.main.registerReactComponent("BillingTableBillingAccountService",r)},5247:(e,t,a)=>{"use strict";a.d(t,{A:()=>g});var s=a(9471),r=a(9292),n=a(4721),i=a(3568),l=a(436),o=a(1056),c=a(9348),d=a(470);class m extends o.A{static defaultProps={...o.A.defaultProps,formUseModalSimple:!0,model:"HubletoApp/Community/Contacts/Models/Value"};translationContext="HubletoApp\\Community\\Customers\\Loader::Components\\TableValues";constructor(e){super(e),this.state=this.getStateFromProps(e)}getStateFromProps(e){return{...super.getStateFromProps(e)}}getType(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)?"email":/^[\+|0-9| ]+$/.test(e)?"number":/(https:\/\/www\.|http:\/\/www\.|https:\/\/|http:\/\/)?[a-zA-Z0-9]{2,}(\.[a-zA-Z0-9]{2,})(\.[a-zA-Z0-9]{2,})?/.test(e)?"url":"other"}getIcon(e){switch(this.getType(e)){case"email":return"envelope";case"number":return"phone";case"url":return"link";default:return"grip-lines"}}render(){return this.state.data?s.createElement(s.Fragment,null,this.renderFormModal(),s.createElement("div",{className:"flex flex-col gap-2"},this.state.data?.data?Object.keys(this.state.data?.data).map(e=>{const t=this.state.data.data[e],a=this.getType(t.value);return s.createElement("div",{key:e,className:"flex gap-2 items-center"},s.createElement("button",{className:"btn btn-transparent w-3/4",onClick:e=>{if(this.props.parentForm.state.isInlineEditing)e.stopPropagation();else switch(a){case"url":window.open(t.value),e.stopPropagation();break;case"email":window.open("mailto://"+t.value),e.stopPropagation();break;default:this.props.parentForm.setState({isInlineEditing:!0})}}},s.createElement("span",{className:"icon"},s.createElement("i",{className:"fas fa-"+this.getIcon(t.value)})),s.createElement("span",{className:"text w-full",style:{maxHeight:"10em"}},this.props.parentForm.state.isInlineEditing?s.createElement(s.Fragment,null,s.createElement("div",{className:"adios component input w-full"},s.createElement("div",{className:"input-element w-full"},s.createElement("input",{className:"w-full bg-blue-50",onChange:t=>{let a=this.state.data.data;a[e].value=t.currentTarget.value,a[e].type=this.getType(t.currentTarget.value),this.props.parentForm.updateRecord({VALUES:a})},value:t.value})))):t.value??"")),s.createElement("div",{className:"w-1/4"},this.props.parentForm.state.isInlineEditing?s.createElement(d.A,{uid:"value_"+t.id+"_id_category",model:"HubletoApp/Community/Contacts/Models/Category",value:t.id_category,onChange:(t,a)=>{let s=this.state.data.data;s[e].id_category=a,this.props.parentForm.updateRecord({VALUES:s})}}):t.CATEGORY?.name??""),this.props.parentForm.state.isInlineEditing?null:s.createElement("div",null,s.createElement("button",{className:"btn btn-transparent",onClick:()=>{this.props.parentForm.setState({isInlineEditing:!0})}},s.createElement("span",{className:"icon"},s.createElement("i",{className:"fas fa-pencil"})))),this.props.parentForm.state.isInlineEditing?s.createElement("button",{className:"btn btn-danger",onClick:()=>{let t=this.state.data.data;delete t[e],this.props.parentForm.updateRecord({VALUES:t})}},s.createElement("span",{className:"icon"},s.createElement("i",{className:"fas fa-trash-can"}))):null)}):null)):s.createElement(c.z,{mode:"indeterminate",style:{height:"8px"}})}}var p=a(298),u=a(1612);function h(){return h=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},h.apply(null,arguments)}class g extends n.A{static defaultProps={...n.A.defaultProps,model:"HubletoApp/Community/Contacts/Models/Contact"};translationContext="HubletoApp\\Community\\Contacts\\Loader::Components\\FormContact";constructor(e){super(e),this.state={...this.getStateFromProps(e),newEntryId:this.props.newEntryId??-1,primaryContactMessage:!1,contactsTableKey:0}}getStateFromProps(e){return{...super.getStateFromProps(e)}}renderTitle(){return-1==(0,r.P3)("recordId")?s.createElement("h2",null,"New Contact"):s.createElement(s.Fragment,null,s.createElement("h2",null,this.state.record.first_name??"","",this.state.record.last_name??""),s.createElement("small",null,this.translate("Contact")))}checkPrimaryContact(e){if(e.TAGS&&e.TAGS.length>0){var t=[];for(const[a,s]of Object.entries(e.TAGS))t.push(s.id_tag??0);u.A.get("contacts/check-primary-contact",{idContact:this.state.record.id??-1,idCustomer:e.id_customer,tags:t},e=>{1==e.result?this.updateRecord({is_primary:1}):globalThis.main.showDialogDanger(s.createElement(s.Fragment,null,s.createElement("p",{className:"text"},e.error??"Unknown error"),s.createElement("p",{className:"text"},null!=e.names?e.names:"")),{})})}else this.updateRecord({is_primary:1})}componentDidUpdate(e,t){t.isInlineEditing!=this.state.isInlineEditing&&this.setState({contactsTableKey:Math.random()})}renderContent(){const e=this.state.record,t=e.id>0,a=this.renderCustomInputs();return s.createElement(s.Fragment,null,s.createElement("div",{className:"card"},s.createElement("div",{className:"card-body flex flex-row gap-2"},s.createElement("div",{className:"w-3/4"},s.createElement("div",{className:"flex gap-2 w-full"},s.createElement("div",null,s.createElement("i",{className:"fas fa-user text-2xl p-4 text-gray-500"})),s.createElement("div",{className:"w-full"},this.inputWrapper("salutation"),s.createElement("div",{className:"flex gap-2"},s.createElement("div",{className:"flex-1"},this.inputWrapper("title_before",{cssClass:"text-2xl"})),s.createElement("div",{className:"flex-2"},this.inputWrapper("first_name",{cssClass:"text-2xl text-primary"})),s.createElement("div",{className:"flex-2"},this.inputWrapper("middle_name",{cssClass:"text-2xl text-primary"})),s.createElement("div",{className:"flex-2"},this.inputWrapper("last_name",{cssClass:"text-2xl text-primary"})),s.createElement("div",{className:"flex-1"},this.inputWrapper("title_after",{cssClass:"text-2xl"}))))),this.divider(this.translate("Contacts")),s.createElement(m,{key:"contacts_"+this.state.contactsTableKey,uid:this.props.uid+"_table_contacts",parentForm:this,context:"Hello World",data:{data:e.VALUES},isInlineEditing:this.state.isInlineEditing,isUsedAsInput:!0,readonly:!this.state.isInlineEditing,descriptionSource:"props",onRowClick:()=>this.setState({isInlineEditing:!0}),onChange:e=>{this.updateRecord({VALUES:e.state.data.data})},onDeleteSelectionChange:e=>{this.updateRecord({VALUES:e.state.data.data??[]}),this.setState({contactsTableKey:Math.random()})},customEndpointParams:{idContact:e.id},description:{permissions:this.props.tableValuesDescription?.permissions??{},ui:{emptyMessage:s.createElement("div",{className:"p-2"},this.translate("No contacts yet."))},columns:{type:{type:"varchar",title:this.translate("Type"),enumValues:{email:this.translate("Email"),number:this.translate("Phone Number"),other:this.translate("Other")}},value:{type:"varchar",title:this.translate("Value")},id_category:{type:"lookup",title:this.translate("Category"),model:"HubletoApp/Community/Contacts/Models/Category"}},inputs:{type:{type:"varchar",title:this.translate("Type"),enumValues:{email:"Email",number:"Phone Number",other:"Other"}},value:{type:"varchar",title:this.translate("Value")},id_category:{type:"lookup",title:this.translate("Category"),model:"HubletoApp/Community/Contacts/Models/Category"}}}}),s.createElement("a",{className:"btn btn-add-outline mt-2",onClick:()=>{e.VALUES||(e.VALUES=[]),e.VALUES.push({id:this.state.newEntryId,id_contact:{_useMasterRecordId_:!0},type:"email"}),this.setState({isInlineEditing:!0,newEntryId:this.state.newEntryId-1})}},s.createElement("span",{className:"icon"},s.createElement("i",{className:"fas fa-add"})),s.createElement("span",{className:"text"},this.translate("Add contact")))),s.createElement("div",{className:"border-l border-gray-200"}),s.createElement("div",{className:"w-1/2"},s.createElement(l.A,{title:this.translate("Customer")},s.createElement(d.A,h({},this.getInputProps("id_customer"),{model:"HubletoApp/Community/Contacts/Models/Customer",endpoint:"customers/api/get-customer",value:e.id_customer,readonly:this.props.creatingNew,onChange:(e,t)=>{1==this.state.record.is_primary&&this.setState({primaryContactMessage:!0}),this.updateRecord({id_customer:t,is_primary:0})}}))),s.createElement(l.A,{title:this.translate("Tags")},s.createElement(i.A,h({},this.getInputProps("id_tag"),{value:this.state.record.TAGS,model:"HubletoApp/Community/Contacts/Models/Tag",targetColumn:"id_contact",sourceColumn:"id_tag",colorColumn:"color",onChange:(t,a)=>{1==this.state.record.is_primary&&this.setState({primaryContactMessage:!0}),e.TAGS=a,this.setState({record:e}),this.updateRecord({is_primary:0})}}))),this.state.record?.id_customer>0?s.createElement(s.Fragment,null,1==this.state.primaryContactMessage?s.createElement("div",{className:"text-yellow-500 block"},s.createElement("span",{className:"icon mr-2"},s.createElement("i",{className:"fas fa-triangle-exclamation"})),s.createElement("span",{className:"text"},this.translate("Due to some changes the Primary Contact has to be checked again"))):s.createElement(s.Fragment,null),s.createElement(l.A,{title:this.translate("Primary Contact")},s.createElement(p.A,h({},this.getInputProps("is_primary"),{value:this.state.record.is_primary,onChange:(e,t)=>{this.setState({isInlineEditing:!0}),1==t?(this.setState({primaryContactMessage:!1}),this.checkPrimaryContact(this.state.record)):this.updateRecord({is_primary:t})}})))):s.createElement(s.Fragment,null),this.inputWrapper("note",{cssClass:"bg-yellow-50"}),this.inputWrapper("is_valid"),t?this.inputWrapper("date_created"):null))),t&&a.length>0?s.createElement("div",{className:"card mt-2"},s.createElement("div",{className:"card-header"},this.translate("Custom data")),s.createElement("div",{className:"card-body"},a)):s.createElement(s.Fragment,null))}}},5358:(e,t,a)=>{var s={"./af":5124,"./af.js":5124,"./ar":4328,"./ar-dz":2855,"./ar-dz.js":2855,"./ar-kw":7355,"./ar-kw.js":7355,"./ar-ly":4130,"./ar-ly.js":4130,"./ar-ma":4523,"./ar-ma.js":4523,"./ar-ps":4,"./ar-ps.js":4,"./ar-sa":4089,"./ar-sa.js":4089,"./ar-tn":4563,"./ar-tn.js":4563,"./ar.js":4328,"./az":2240,"./az.js":2240,"./be":9162,"./be.js":9162,"./bg":5488,"./bg.js":5488,"./bm":6546,"./bm.js":6546,"./bn":735,"./bn-bd":3442,"./bn-bd.js":3442,"./bn.js":735,"./bo":3928,"./bo.js":3928,"./br":3267,"./br.js":3267,"./bs":5164,"./bs.js":5164,"./ca":9991,"./ca.js":9991,"./cs":9529,"./cs.js":9529,"./cv":1046,"./cv.js":1046,"./cy":7711,"./cy.js":7711,"./da":2943,"./da.js":2943,"./de":6752,"./de-at":6012,"./de-at.js":6012,"./de-ch":8954,"./de-ch.js":8954,"./de.js":6752,"./dv":2361,"./dv.js":2361,"./el":7890,"./el.js":7890,"./en-au":891,"./en-au.js":891,"./en-ca":281,"./en-ca.js":281,"./en-gb":1876,"./en-gb.js":1876,"./en-ie":1107,"./en-ie.js":1107,"./en-il":6212,"./en-il.js":6212,"./en-in":6446,"./en-in.js":6446,"./en-nz":6189,"./en-nz.js":6189,"./en-sg":9091,"./en-sg.js":9091,"./eo":3791,"./eo.js":3791,"./es":4659,"./es-do":2969,"./es-do.js":2969,"./es-mx":57,"./es-mx.js":57,"./es-us":4976,"./es-us.js":4976,"./es.js":4659,"./et":970,"./et.js":970,"./eu":7401,"./eu.js":7401,"./fa":4954,"./fa.js":4954,"./fi":8066,"./fi.js":8066,"./fil":6428,"./fil.js":6428,"./fo":3924,"./fo.js":3924,"./fr":4615,"./fr-ca":2028,"./fr-ca.js":2028,"./fr-ch":6571,"./fr-ch.js":6571,"./fr.js":4615,"./fy":2450,"./fy.js":2450,"./ga":4363,"./ga.js":4363,"./gd":8920,"./gd.js":8920,"./gl":2691,"./gl.js":2691,"./gom-deva":7609,"./gom-deva.js":7609,"./gom-latn":7314,"./gom-latn.js":7314,"./gu":9215,"./gu.js":9215,"./he":9548,"./he.js":9548,"./hi":8440,"./hi.js":8440,"./hr":7641,"./hr.js":7641,"./hu":9676,"./hu.js":9676,"./hy-am":6243,"./hy-am.js":6243,"./id":2342,"./id.js":2342,"./is":8311,"./is.js":8311,"./it":8630,"./it-ch":944,"./it-ch.js":944,"./it.js":8630,"./ja":6158,"./ja.js":6158,"./jv":319,"./jv.js":319,"./ka":3567,"./ka.js":3567,"./kk":2857,"./kk.js":2857,"./km":5683,"./km.js":5683,"./kn":4454,"./kn.js":4454,"./ko":5173,"./ko.js":5173,"./ku":4555,"./ku-kmr":6524,"./ku-kmr.js":6524,"./ku.js":4555,"./ky":6615,"./ky.js":6615,"./lb":2029,"./lb.js":2029,"./lo":4826,"./lo.js":4826,"./lt":9855,"./lt.js":9855,"./lv":5377,"./lv.js":5377,"./me":6001,"./me.js":6001,"./mi":9733,"./mi.js":9733,"./mk":4243,"./mk.js":4243,"./ml":4202,"./ml.js":4202,"./mn":9584,"./mn.js":9584,"./mr":5284,"./mr.js":5284,"./ms":6936,"./ms-my":5650,"./ms-my.js":5650,"./ms.js":6936,"./mt":1122,"./mt.js":1122,"./my":8629,"./my.js":8629,"./nb":6623,"./nb.js":6623,"./ne":2942,"./ne.js":2942,"./nl":8229,"./nl-be":3903,"./nl-be.js":3903,"./nl.js":8229,"./nn":131,"./nn.js":131,"./oc-lnc":4939,"./oc-lnc.js":4939,"./pa-in":2510,"./pa-in.js":2510,"./pl":8131,"./pl.js":8131,"./pt":7899,"./pt-br":160,"./pt-br.js":160,"./pt.js":7899,"./ro":4184,"./ro.js":4184,"./ru":7418,"./ru.js":7418,"./sd":9068,"./sd.js":9068,"./se":8179,"./se.js":8179,"./si":7727,"./si.js":7727,"./sk":6657,"./sk.js":6657,"./sl":9636,"./sl.js":9636,"./sq":3303,"./sq.js":3303,"./sr":4378,"./sr-cyrl":277,"./sr-cyrl.js":277,"./sr.js":4378,"./ss":3865,"./ss.js":3865,"./sv":8422,"./sv.js":8422,"./sw":6613,"./sw.js":6613,"./ta":1900,"./ta.js":1900,"./te":3072,"./te.js":3072,"./tet":8046,"./tet.js":8046,"./tg":9850,"./tg.js":9850,"./th":7563,"./th.js":7563,"./tk":6350,"./tk.js":6350,"./tl-ph":3972,"./tl-ph.js":3972,"./tlh":8911,"./tlh.js":8911,"./tr":9445,"./tr.js":9445,"./tzl":9013,"./tzl.js":9013,"./tzm":54,"./tzm-latn":4302,"./tzm-latn.js":4302,"./tzm.js":54,"./ug-cn":4225,"./ug-cn.js":4225,"./uk":219,"./uk.js":219,"./ur":6412,"./ur.js":6412,"./uz":2804,"./uz-latn":8556,"./uz-latn.js":8556,"./uz.js":2804,"./vi":8290,"./vi.js":8290,"./x-pseudo":6658,"./x-pseudo.js":6658,"./yo":3067,"./yo.js":3067,"./zh-cn":8939,"./zh-cn.js":8939,"./zh-hk":9731,"./zh-hk.js":9731,"./zh-mo":6702,"./zh-mo.js":6702,"./zh-tw":4203,"./zh-tw.js":4203};function r(e){var t=n(e);return a(t)}function n(e){if(!a.o(s,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return s[e]}r.keys=function(){return Object.keys(s)},r.resolve=n,e.exports=r,r.id=5358},5684:(e,t,a)=>{"use strict";var s=a(9471),r=a(6643),n=a(4721);class i extends n.A{static defaultProps={...n.A.defaultProps,model:"HubletoApp/Community/Events/Models/Team"};translationContext="HubletoApp\\Community\\Events::Components\\FormEventVenue";constructor(e){super(e)}renderTitle(){return s.createElement(s.Fragment,null,s.createElement("h2",null,"Record #",this.state.record.id??"0"),s.createElement("small",null,"Event venue"))}}class l extends r.A{static defaultProps={...r.A.defaultProps,formUseModalSimple:!0,model:"HubletoApp/Community/Events/Models/EventVenue"};translationContext="HubletoApp\\Community\\Events::Components\\TableEventVenues";constructor(e){super(e),this.state=this.getStateFromProps(e)}getStateFromProps(e){return{...super.getStateFromProps(e)}}getFormModalProps(){let e=super.getFormModalProps();return e.type="right wide",e}getEndpointParams(){return{...super.getEndpointParams(),idEvent:this.props.idEvent}}renderForm(){let e=this.getFormProps();return e.customEndpointParams.idEvent=this.props.idEvent,e.description||(e.description={}),e.description.defaultValues={id_event:this.props.idEvent},s.createElement(i,e)}}class o extends n.A{static defaultProps={...n.A.defaultProps,model:"HubletoApp/Community/Events/Models/Team"};translationContext="HubletoApp\\Community\\Events::Components\\FormEventAttendee";constructor(e){super(e)}renderTitle(){return s.createElement(s.Fragment,null,s.createElement("h2",null,"Record #",this.state.record.id??"0"),s.createElement("small",null,"Event attendee"))}}class c extends r.A{static defaultProps={...r.A.defaultProps,formUseModalSimple:!0,model:"HubletoApp/Community/Events/Models/EventAttendee"};translationContext="HubletoApp\\Community\\Events::Components\\TableEventAttendees";constructor(e){super(e),this.state=this.getStateFromProps(e)}getStateFromProps(e){return{...super.getStateFromProps(e)}}getFormModalProps(){let e=super.getFormModalProps();return e.type="right wide",e}getEndpointParams(){return{...super.getEndpointParams(),idEvent:this.props.idEvent}}renderForm(){let e=this.getFormProps();return e.customEndpointParams.idEvent=this.props.idEvent,e.description||(e.description={}),e.description.defaultValues={id_event:this.props.idEvent},s.createElement(o,e)}}class d extends n.A{static defaultProps={...n.A.defaultProps,model:"HubletoApp/Community/Events/Models/Team"};translationContext="HubletoApp\\Community\\Events::Components\\FormEventSpeaker";constructor(e){super(e)}renderTitle(){return s.createElement(s.Fragment,null,s.createElement("h2",null,"Record #",this.state.record.id??"0"),s.createElement("small",null,"EventSpeaker"))}}class m extends r.A{static defaultProps={...r.A.defaultProps,formUseModalSimple:!0,model:"HubletoApp/Community/Events/Models/EventSpeaker"};translationContext="HubletoApp\\Community\\Events::Components\\TableEventSpeakers";constructor(e){super(e),this.state=this.getStateFromProps(e)}getStateFromProps(e){return{...super.getStateFromProps(e)}}getFormModalProps(){let e=super.getFormModalProps();return e.type="right wide",e}getEndpointParams(){return{...super.getEndpointParams()}}renderForm(){let e=this.getFormProps();return s.createElement(d,e)}}class p extends n.A{static defaultProps={...n.A.defaultProps,model:"HubletoApp/Community/Events/Models/Team"};translationContext="HubletoApp\\Community\\Events::Components\\FormEvent";constructor(e){super(e)}renderTitle(){return s.createElement(s.Fragment,null,s.createElement("h2",null,"Record #",this.state.record.id??"0"),s.createElement("small",null,"Event"))}renderContent(){return s.createElement(s.Fragment,null,s.createElement("div",{className:"w-full flex gap-2"},s.createElement("div",{className:"flex-1 border-r border-gray-100"},this.inputWrapper("title"),this.inputWrapper("id_type"),this.inputWrapper("attendance_options"),this.inputWrapper("brief_description"),this.inputWrapper("full_description")),s.createElement("div",{className:"flex-1"},s.createElement("div",{className:"card mt-2"},s.createElement("div",{className:"card-header"},this.translate("Venues")),s.createElement("div",{className:"card-body"},this.state.id<0?s.createElement("div",{className:"badge badge-info"},"First create event, then you will be prompted to add its venues."):s.createElement(l,{uid:this.props.uid+"_table_venues",parentForm:this,customEndpointParams:{idEvent:this.state.id}}))))),s.createElement("div",{className:"w-full flex gap-2"},s.createElement("div",{className:"flex-1 border-r border-gray-100"},s.createElement("div",{className:"card mt-2"},s.createElement("div",{className:"card-header"},this.translate("Attendees")),s.createElement("div",{className:"card-body"},this.state.id<0?s.createElement("div",{className:"badge badge-info"},"First create event, then you will be prompted to add its attendees."):s.createElement(c,{uid:this.props.uid+"_table_attendees",parentForm:this,customEndpointParams:{idEvent:this.state.id}})))),s.createElement("div",{className:"flex-1 border-r border-gray-100"},s.createElement("div",{className:"card mt-2"},s.createElement("div",{className:"card-header"},this.translate("Speakers")),s.createElement("div",{className:"card-body"},this.state.id<0?s.createElement("div",{className:"badge badge-info"},"First create event, then you will be prompted to add its speakers."):s.createElement(m,{uid:this.props.uid+"_table_speakers",parentForm:this,customEndpointParams:{idEvent:this.state.id}}))))))}}class u extends r.A{static defaultProps={...r.A.defaultProps,formUseModalSimple:!0,model:"HubletoApp/Community/Events/Models/Event"};translationContext="HubletoApp\\Community\\Events::Components\\TableEvents";constructor(e){super(e),this.state=this.getStateFromProps(e)}getStateFromProps(e){return{...super.getStateFromProps(e)}}getFormModalProps(){let e=super.getFormModalProps();return e.type="right wide",e}getEndpointParams(){return{...super.getEndpointParams()}}renderForm(){let e=this.getFormProps();return s.createElement(p,e)}}class h extends n.A{static defaultProps={...n.A.defaultProps,model:"HubletoApp/Community/Events/Models/Team"};translationContext="HubletoApp\\Community\\Events::Components\\FormType";constructor(e){super(e)}renderTitle(){return s.createElement(s.Fragment,null,s.createElement("h2",null,"Record #",this.state.record.id??"0"),s.createElement("small",null,"Type"))}}class g extends r.A{static defaultProps={...r.A.defaultProps,formUseModalSimple:!0,model:"HubletoApp/Community/Events/Models/Type"};translationContext="HubletoApp\\Community\\Events::Components\\TableTypes";constructor(e){super(e),this.state=this.getStateFromProps(e)}getStateFromProps(e){return{...super.getStateFromProps(e)}}getFormModalProps(){let e=super.getFormModalProps();return e.type="right wide",e}getEndpointParams(){return{...super.getEndpointParams()}}renderForm(){let e=this.getFormProps();return s.createElement(h,e)}}class E extends n.A{static defaultProps={...n.A.defaultProps,model:"HubletoApp/Community/Events/Models/Team"};translationContext="HubletoApp\\Community\\Events::Components\\FormVenue";constructor(e){super(e)}renderTitle(){return s.createElement(s.Fragment,null,s.createElement("h2",null,"Record #",this.state.record.id??"0"),s.createElement("small",null,"Venue"))}}class b extends r.A{static defaultProps={...r.A.defaultProps,formUseModalSimple:!0,model:"HubletoApp/Community/Events/Models/Venue"};translationContext="HubletoApp\\Community\\Events::Components\\TableVenues";constructor(e){super(e),this.state=this.getStateFromProps(e)}getStateFromProps(e){return{...super.getStateFromProps(e)}}getFormModalProps(){let e=super.getFormModalProps();return e.type="right wide",e}getEndpointParams(){return{...super.getEndpointParams()}}renderForm(){let e=this.getFormProps();return s.createElement(E,e)}}class C extends n.A{static defaultProps={...n.A.defaultProps,model:"HubletoApp/Community/Events/Models/Team"};translationContext="HubletoApp\\Community\\Events::Components\\FormAttendee";constructor(e){super(e)}renderTitle(){return s.createElement(s.Fragment,null,s.createElement("h2",null,"Record #",this.state.record.id??"0"),s.createElement("small",null,"Attendee"))}}class y extends r.A{static defaultProps={...r.A.defaultProps,formUseModalSimple:!0,model:"HubletoApp/Community/Events/Models/Attendee"};translationContext="HubletoApp\\Community\\Events::Components\\TableAttendees";constructor(e){super(e),this.state=this.getStateFromProps(e)}getStateFromProps(e){return{...super.getStateFromProps(e)}}getFormModalProps(){let e=super.getFormModalProps();return e.type="right wide",e}getEndpointParams(){return{...super.getEndpointParams()}}renderForm(){let e=this.getFormProps();return s.createElement(C,e)}}class v extends n.A{static defaultProps={...n.A.defaultProps,model:"HubletoApp/Community/Events/Models/Team"};translationContext="HubletoApp\\Community\\Events::Components\\FormAgenda";constructor(e){super(e)}renderTitle(){return s.createElement(s.Fragment,null,s.createElement("h2",null,"Record #",this.state.record.id??"0"),s.createElement("small",null,"Agenda"))}}class f extends r.A{static defaultProps={...r.A.defaultProps,formUseModalSimple:!0,model:"HubletoApp/Community/Events/Models/Agenda"};translationContext="HubletoApp\\Community\\Events::Components\\TableAgendas";constructor(e){super(e),this.state=this.getStateFromProps(e)}getStateFromProps(e){return{...super.getStateFromProps(e)}}getFormModalProps(){let e=super.getFormModalProps();return e.type="right wide",e}getEndpointParams(){return{...super.getEndpointParams()}}renderForm(){let e=this.getFormProps();return s.createElement(v,e)}}class P extends n.A{static defaultProps={...n.A.defaultProps,model:"HubletoApp/Community/Events/Models/Team"};translationContext="HubletoApp\\Community\\Events::Components\\FormSpeaker";constructor(e){super(e)}renderTitle(){return s.createElement(s.Fragment,null,s.createElement("h2",null,"Record #",this.state.record.id??"0"),s.createElement("small",null,"Speaker"))}}class A extends r.A{static defaultProps={...r.A.defaultProps,formUseModalSimple:!0,model:"HubletoApp/Community/Events/Models/Speaker"};translationContext="HubletoApp\\Community\\Events::Components\\TableSpeakers";constructor(e){super(e),this.state=this.getStateFromProps(e)}getStateFromProps(e){return{...super.getStateFromProps(e)}}getFormModalProps(){let e=super.getFormModalProps();return e.type="right wide",e}getEndpointParams(){return{...super.getEndpointParams()}}renderForm(){let e=this.getFormProps();return s.createElement(P,e)}}globalThis.main.registerReactComponent("EventsTableEvents",u),globalThis.main.registerReactComponent("EventsTableTypes",g),globalThis.main.registerReactComponent("EventsTableVenues",b),globalThis.main.registerReactComponent("EventsTableAttendees",y),globalThis.main.registerReactComponent("EventsTableEventAttendees",c),globalThis.main.registerReactComponent("EventsTableEventVenues",l),globalThis.main.registerReactComponent("EventsTableAgendas",f),globalThis.main.registerReactComponent("EventsTableSpeakers",A),globalThis.main.registerReactComponent("EventsTableEventSpeakers",m)},5867:()=>{},5882:(e,t,a)=>{"use strict";a.d(t,{A:()=>l});var s=a(9471),r=a(4721),n=a(2198),i=a.n(n);class l extends r.A{static defaultProps={...r.A.defaultProps,model:"HubletoApp/Community/Calendar/Models/Activity"};translationContext="HubletoApp\\Community\\Calendar\\Loader::Components\\FormActivity";getActivitySourceReadable(){return"Event"}renderTitle(){return s.createElement(s.Fragment,null,s.createElement("h2",null,this.state.record.subject??""),s.createElement("small",null,this.getActivitySourceReadable()))}renderCustomInputs(){return s.createElement(s.Fragment,null)}renderContent(){const e=this.state.record,t=this.renderCustomInputs();let a=i()(e.date_end).diff(i()(e.date_start),"days"),r=i()(e.date_end+" "+e.time_end).diff(i()(e.date_end+" "+e.time_start),"minutes");return isNaN(a)&&(a=0),isNaN(r)&&(r=15),s.createElement(s.Fragment,null,t?s.createElement("div",{className:"p-2 mb-2 bg-blue-50"},t):null,s.createElement("div",{className:"flex gap-2 flex-col md:flex-row"},s.createElement("div",{className:"w-full"},this.inputWrapper("subject",{cssClass:"text-primary text-2xl"})),s.createElement("div",{className:"w-full"},this.inputWrapper("id_activity_type"))),this.inputWrapper("all_day"),s.createElement("div",{className:"mt-2 alert alert-info"},a," day(s), ",r," minutes"),s.createElement("div",{className:"flex gap-2 w-full flex-col md:flex-row"},s.createElement("div",{className:"w-full"},this.divider(this.translate("Start")),this.input("date_start",{onChange:(e,t)=>{this.updateRecord({date_end:i()(t).add(a,"days").format("YYYY-MM-DD")})}}),e.all_day?null:this.input("time_start",{onChange:(t,a)=>{console.log(a,i()(e.date_end+" "+a+":00"),i()(e.date_end+" "+a+":00").add(r,"minutes").format("HH:mm:ss")),this.updateRecord({time_end:i()(e.date_end+" "+a+":00").add(r,"minutes").format("HH:mm:ss")})}})),s.createElement("div",{className:"w-full"},this.divider(this.translate("End")),this.input("date_end"),e.all_day?null:this.input("time_end"))),this.inputWrapper("meeting_minutes_link"),s.createElement("div",{className:"flex gap-2 w-full flex-col md:flex-row"},s.createElement("div",{className:"w-full"},this.inputWrapper("completed")),s.createElement("div",{className:"w-full"},this.inputWrapper("id_owner"))))}}},6154:(e,t,a)=>{"use strict";var s=a(9471),r=a(9292),n=a(3041),i=a(2395),l=a(9605),o=a(2198),c=a.n(o);class d extends l.A{translationContext="HubletoApp\\Community\\Calendar\\Loader::Components\\FormActivitySelector";render(){var e=this.props.calendarConfigs;return s.createElement(s.Fragment,null,s.createElement("div",{className:"modal-header"},s.createElement("div",{className:"modal-header-left"}),s.createElement("div",{className:"modal-header-title"},this.translate("New event")),s.createElement("div",{className:"modal-header-right"},s.createElement("button",{className:"btn btn-close",onClick:()=>this.props.onCallback()},s.createElement("span",{className:"text !py-2"},"")))),s.createElement("div",{className:"badge m-4 px-4 text-2xl"},this.props.clickConfig?.date,"",this.props.clickConfig?.time),s.createElement("div",{className:"badge badge-info m-4 px-4 text-xl"},this.translate("Choose calendar to which the event should be created.")),s.createElement("div",{className:"flex gap-2 flex-col px-4 mt-4"},Object.keys(this.props.calendarConfigs).map((t,a)=>e[t].title?s.createElement(s.Fragment,null,s.createElement("button",{key:a,className:"btn btn-transparent btn-large",style:{borderLeft:"3em solid "+e[t].color},onClick:()=>{if(this.props.clickConfig?.time&&this.props.clickConfig?.date)var a=c()(`${this.props.clickConfig?.date} ${this.props.clickConfig?.time}`,"YYYY-MM-DD HH:mm:ss").add(30,"minutes");this.setState({formSelected:globalThis.main.renderReactElement(e[t].formComponent,{description:{defaultValues:{date_start:this.props.clickConfig?.date,time_start:this.props.clickConfig?.time,date_end:this.props.clickConfig?.date,time_end:a?.format("HH:mm:ss")}},id:-1,showInModal:!0,showInModalSimple:!0,onClose:()=>{this.setState({formSelected:null}),this.props.onCallback()},onSaveCallback:()=>{this.setState({formSelected:null}),this.props.onCallback()}})})}},t.icon?s.createElement("span",{className:"icon"},s.createElement("i",{className:e[t].icon})):null,s.createElement("span",{className:"text text-center self-center !h-auto text-lg"},e[t].title))):null)),this.state?.formSelected?s.createElement(i.A,{uid:"activity_form",isOpen:!0,type:"inside-parent"},this.state.formSelected):s.createElement(s.Fragment,null))}}var m=a(1612);class p extends l.A{translationContext="HubletoApp\\Community\\Calendar\\Loader::Components\\CalendarMain";constructor(e){super(e),this.refCalendar=s.createRef(),this.state={eventSource:this.props.eventSource??"",eventId:this.props.eventId??0,events:[],showIdActivity:0,dateClicked:"",timeClicked:"",newActivity:!1,fSources:Object.keys(this.props.configs),fOwnership:0}}getCalendarEventsEndpointUrl(e,t){return"calendar/api/get-calendar-events?fOwnership="+this.state.fOwnership+"&"+this.state.fSources.map(e=>"fSources[]="+e).join("&")+(e?"&source="+e:"")+(t?"&id="+t:"")}componentDidMount(){this.props.eventSource&&this.props.eventId&&m.A.get(this.getCalendarEventsEndpointUrl(this.props.eventSource,this.props.eventId),{},e=>{e&&this.setState({eventSource:"",eventId:0,activityFormComponent:globalThis.main.renderReactElement(e.SOURCEFORM,{id:e.id,showInModal:!0,showInModalSimple:!0,onClose:()=>{this.setState({activityFormComponent:null})},onSaveCallback:()=>{this.setState({activityFormComponent:null})}})})})}renderCell=e=>s.createElement(s.Fragment,null,s.createElement("b",null,e.timeText),s.createElement("span",{style:{marginLeft:4}},e.event.title),s.createElement("i",{style:{marginLeft:4}},"(",e.event.extendedProps.type,")"));render(){let e={uid:"activity_form",isOpen:!0,type:"right",...this.state.activityFormModalProps};return s.createElement("div",{className:"flex gap-2 flex-col md:flex-row"},s.createElement("div",{className:"flex flex-col gap-2 text-nowrap"},s.createElement("button",{className:"btn btn-primary-outline mb-2",onClick:()=>{this.setState({activityFormComponent:null,newActivity:!0,dateClicked:c()().format("YYYY-MM-DD"),timeClicked:c()().format("HH:mm:ss")})}},s.createElement("span",{className:"icon"},s.createElement("i",{className:"fas fa-plus"})),s.createElement("span",{className:"text"},this.translate("New activity"))),s.createElement("b",null,"Calendars"),s.createElement("div",{className:"list"},Object.keys(this.props.configs).map(e=>{const t=this.props.configs[e];return s.createElement("button",{className:"btn btn-small btn-list-item btn-transparent",style:{borderLeft:"1em solid "+t.color},onClick:()=>{let t=[];if(this.state.fSources.includes(e))for(let a in this.state.fSources)this.state.fSources[a]!=e&&t.push(this.state.fSources[a]);else t=this.state.fSources,t.push(e);this.setState({fSources:t})}},s.createElement("span",{className:"icon"},s.createElement("input",{type:"checkbox",checked:this.state.fSources.includes(e)})),s.createElement("span",{className:"text"},t.title))})),s.createElement("b",null,this.translate("Ownership")),s.createElement("div",{className:"list"},s.createElement("button",{className:"btn btn-small btn-list-item "+(0==this.state.fOwnership?"btn-primary":"btn-transparent"),onClick:()=>{this.setState({fOwnership:0})}},s.createElement("span",{className:"text"},this.translate("All"))),s.createElement("button",{className:"btn btn-small btn-list-item "+(1==this.state.fOwnership?"btn-primary":"btn-transparent"),onClick:()=>{this.setState({fOwnership:1})}},s.createElement("span",{className:"text"},this.translate("My activities"))))),s.createElement("div",{className:"w-full"},s.createElement(n.A,{ref:this.refCalendar,readonly:!1,views:"timeGridDay,timeGridWeek,dayGridMonth,listYear",height:this.props.height,initialView:"timeGridWeek",eventsEndpoint:globalThis.main.config.rootUrl+"/"+this.getCalendarEventsEndpointUrl(),onEventsLoaded:e=>{},onDateClick:(e,t,a)=>{(0,r.wp)("eventSource"),(0,r.wp)("eventId"),this.setState({activityFormComponent:null,newActivity:!0,dateClicked:e,timeClicked:"dayGridMonth"==a.view.type?null:t})},onEventClick:e=>{(0,r.Bg)("eventSource",e.event.extendedProps.source),(0,r.Bg)("eventId",e.event.id),this.setState({newActivity:!1,activityFormComponent:globalThis.main.renderReactElement(e.event.extendedProps.SOURCEFORM,{id:e.event.id,showInModal:!0,showInModalSimple:!0,onClose:()=>{this.setState({activityFormComponent:null})},onSaveCallback:()=>{this.setState({activityFormComponent:null})}})}),e.jsEvent.preventDefault()}})),this.state.activityFormComponent?s.createElement(i.A,e,this.state.activityFormComponent):s.createElement(s.Fragment,null),this.state.newActivity?s.createElement(i.A,{uid:"activity_new_form",isOpen:!0,type:"right"},s.createElement(d,{onCallback:()=>this.setState({newActivity:!1}),calendarConfigs:this.props.configs,clickConfig:{date:this.state.dateClicked,time:this.state.timeClicked}})):s.createElement(s.Fragment,null))}}var u=a(5882),h=a(1056);class g extends l.A{constructor(e){super(e),this.state={configs:e.configs,loading:!1,newCalendar:""}}componentDidMount(){}shareCalendar(e){this.setState({loading:!0,newCalendar:e,configs:this.state.configs},()=>{this.setState({loading:!1,newCalendar:e,configs:this.state.configs})})}refresh(){this.setState({loading:!0,newCalendar:"",configs:this.state.configs},()=>{m.A.get("calendar/api/get-shared-calendars",{},e=>{let t=this.state.configs;Object.entries(t).forEach(e=>{t[e[0]].shared=0}),e.forEach(e=>{e.calendar in t&&(t[e.calendar].shared+=1)}),this.setState({loading:!1,newCalendar:"",configs:t})})})}stopSharingConfirm(e){globalThis.main.showDialogConfirm(this.translate('You are about to remove all shared access to the calendar "'+e+'". Do you want to continue?',"HubletoApp\\Community\\Calendar\\Components\\CalendarShareTable"),{headerClassName:"dialog-danger-header",contentClassName:"dialog-danger-content",header:this.translate('Stop sharing "'+e+'"',"HubletoApp\\Community\\Calendar\\Components\\CalendarShareTable"),yesText:this.translate("Yes, remove all shares","HubletoApp\\Community\\Calendar\\Components\\CalendarShareTable"),yesButtonClass:"btn-danger",onYes:()=>{this.stopSharingCalendar(e)},noText:this.translate("No, keep current sharing","HubletoApp\\Community\\Calendar\\Components\\CalendarShareTable"),onNo:()=>{}})}stopSharingCalendar(e){this.setState({loading:!0,configs:this.state.configs},()=>{m.A.post("calendar/api/stop-sharing-calendar",{calendar:e},{},e=>{this.refresh()},e=>{this.refresh()})})}removeShare(e){let t=null;for(let a in e.state.data?.data)if(e.state.data?.data[a]._toBeDeleted_){t=e.state.data?.data[a];break}m.A.post("calendar/api/stop-sharing-calendar",{calendar:t?.calendar??"",share_key:t?.share_key??""},{},e=>{this.refresh()})}renderCalendars(e){return e.map(e=>s.createElement("tr",{key:e[0],style:{borderLeft:"1em solid "+e[1].color}},s.createElement("td",null,e[1].title),s.createElement("td",{className:"text-right"},1==e[1].shared&&"Shared 1 time",e[1].shared>1&&"Shared "+e[1].shared+" times",e[1].shared>0&&s.createElement("button",{onClick:()=>this.stopSharingConfirm(e[0]),className:"btn btn-transparent btn-small"},s.createElement("span",{className:"icon"},s.createElement("i",{className:"fas fa-chain-broken"})),s.createElement("span",{className:"text"},"Stop sharing")),s.createElement("button",{onClick:()=>this.shareCalendar(e[0]),className:"btn btn-transparent btn-small"},s.createElement("span",{className:"icon"},s.createElement("i",{className:"fas fa-share-nodes"})),s.createElement("span",{className:"text"},"Share calendar ",e[1].shared>=1&&"again")))))}render(){let e=this.renderCalendars(Object.entries(this.state.configs));return s.createElement(s.Fragment,null,s.createElement("div",{className:"card w-1/2 m-auto"},s.createElement("div",{className:"card-header"},"Share calendar as ICS"),s.createElement("div",{className:"card-body"},s.createElement("table",{className:"table-default dense w-full"},s.createElement("tbody",null,e)))),s.createElement("div",{className:"card w-1/2 m-auto mt-2"},s.createElement("div",{className:"card-header"},"List of all created shares"),s.createElement("div",{className:"card-body"},this.state.loading?s.createElement("div",{role:"status"},s.createElement("svg",{"aria-hidden":"true",className:"w-8 h-8 text-gray-200 animate-spin dark:text-gray-600 fill-blue-600",viewBox:"0 0 100 101",fill:"none",xmlns:"http://www.w3.org/2000/svg"},s.createElement("path",{d:"M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z",fill:"currentColor"}),s.createElement("path",{d:"M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z",fill:"currentFill"})),s.createElement("span",{className:"sr-only"},"Loading...")):s.createElement(h.A,{model:"HubletoApp/Community/Calendar/Models/SharedCalendar",formReactComponent:"SharedCalendarForm",description:{ui:{showHeader:!1}},recordId:""!=this.state.newCalendar?-1:0,onDeleteRecord:e=>this.removeShare(e),formProps:{description:{defaultValues:{calendar:this.state.newCalendar}}},formCustomProps:{onUpdate:()=>this.refresh()}}))))}}var E=a(4721);class b extends E.A{static defaultProps={...E.A.defaultProps,model:"HubletoApp/Community/Calendar/Models/SharedCalendar"};translationContext="HubletoApp\\Community\\Calendar\\Loader::Components\\FormSharedCalendar";renderTitle(){return s.createElement(s.Fragment,null,s.createElement("h2",null,this.state.record.subject??""),s.createElement("small",null,"Shared calendar"))}onAfterSaveRecord(e){super.onAfterSaveRecord(e),this.props.onUpdate()}onAfterDeleteRecord(e){super.onAfterDeleteRecord(e),this.props.onUpdate()}renderContent(){return s.createElement(s.Fragment,null,this.inputWrapper("id_owner"),this.inputWrapper("calendar"),this.inputWrapper("view_details"),this.inputWrapper("enabled"),s.createElement("div",{className:"flex align-middle justify-between"},s.createElement("div",null,this.inputWrapper("date_from")),s.createElement("div",null,this.inputWrapper("date_to"))),this.state.record.id>0&&s.createElement("div",{className:"flex gap-2 mt-4 input-element"},s.createElement("input",{type:"text",className:"flex-grow bg-muted",value:globalThis.app.config.rootUrl+"/calendar/"+this.state.record.share_key+"/ics",readOnly:!0}),s.createElement("button",{className:"btn btn-primary px-2",onClick:()=>navigator.clipboard.writeText(globalThis.app.config.rootUrl+"/calendar/"+this.state.record.share_key+"/ics")},"Copy share link")))}}globalThis.main.registerReactComponent("CalendarShareTable",g),globalThis.main.registerReactComponent("CalendarMain",p),globalThis.main.registerReactComponent("CalendarActivityForm",u.A),globalThis.main.registerReactComponent("SharedCalendarForm",b)},6872:(e,t,a)=>{"use strict";var s=a(9471),r=a(1056),n=a(9292),i=a(4721);class l extends i.A{static defaultProps={...i.A.defaultProps,model:"HubletoApp/Community/Products/Models/Product"};translationContext="HubletoApp\\Community\\Products\\Loader::Components\\FormProduct";constructor(e){super(e),this.state={...this.getStateFromProps(e)}}getStateFromProps(e){return{...super.getStateFromProps(e)}}renderTitle(){return-1==(0,n.P3)("recordId")?s.createElement("h2",null,globalThis.main.translate("New Product")):s.createElement("h2",null,this.state.record.title?this.state.record.title:"[Undefined Product Name]")}renderContent(){return this.state.record.id,s.createElement(s.Fragment,null,s.createElement("div",{className:"card"},s.createElement("div",{className:"card-body grid grid-cols-2 gap-2"},s.createElement("div",{className:"border-r border-gray-200"},this.inputWrapper("title",{cssClass:"text-2xl text-primary"}),this.inputWrapper("unit_price"),this.inputWrapper("vat"),this.inputWrapper("margin"),this.inputWrapper("unit"),this.inputWrapper("id_supplier")),s.createElement("div",{className:""},this.inputWrapper("image"),this.inputWrapper("description"),this.inputWrapper("id_product_group"),this.inputWrapper("type"),this.inputWrapper("count_in_package"),this.inputWrapper("is_on_sale"),this.inputWrapper("sale_ended")),s.createElement("div",{className:"border-r border-t border-gray-200"},this.inputWrapper("is_single_order_possible"),this.inputWrapper("show_price"),this.inputWrapper("packaging"),this.inputWrapper("needs_reordering"),this.inputWrapper("supplier")),s.createElement("div",{className:"border-t border-gray-200"},this.inputWrapper("price_after_reweight"),this.inputWrapper("storage_rules"),this.inputWrapper("table")))))}}class o extends r.A{static defaultProps={...r.A.defaultProps,orderBy:{field:"id",direction:"asc"},formUseModalSimple:!0,model:"HubletoApp/Community/Products/Models/Product"};translationContext="HubletoApp\\Community\\Products\\Loader::Components\\TableProducts";constructor(e){super(e),this.state=this.getStateFromProps(e)}getStateFromProps(e){return{...super.getStateFromProps(e)}}getFormModalProps(){let e=super.getFormModalProps();return e.type="right wide",e}getEndpointParams(){return{...super.getEndpointParams()}}renderHeaderRight(){return super.renderHeaderRight()}renderForm(){let e=this.getFormProps();return s.createElement(l,e)}}globalThis.main.registerReactComponent("ProductsTableProducts",o)},6901:()=>{},7130:()=>{},7237:(e,t,a)=>{"use strict";var s=a(9471),r=a(6643),n=a(4721);class i extends n.A{static defaultProps={...n.A.defaultProps,model:"HubletoApp/Community/Warehouses/Models/Team"};translationContext="HubletoApp\\Community\\Warehouses::Components\\FormLocation";constructor(e){super(e)}renderTitle(){return s.createElement(s.Fragment,null,s.createElement("h2",null,"Record #",this.state.record.id??"0"),s.createElement("small",null,"Location"))}renderContent(){return s.createElement(s.Fragment,null,s.createElement("div",{className:"w-full flex gap-2"},s.createElement("div",{className:"flex-1 border-r border-gray-100"},this.inputWrapper("id_warehouse"),this.inputWrapper("code"),this.inputWrapper("id_type"),this.inputWrapper("operational_status"),this.inputWrapper("id_operational_manager"),this.divider(this.translate("Capacity and occupancy")),s.createElement("div",{className:"flex gap-2"},s.createElement("div",{className:"w-full"},this.inputWrapper("capacity")),s.createElement("div",{className:"w-full"},this.inputWrapper("capacity_unit"))),this.inputWrapper("current_occupancy")),s.createElement("div",{className:"flex-1"},this.divider(this.translate("Placement")),this.inputWrapper("placement"),this.divider(this.translate("More information")),this.inputWrapper("description"),this.inputWrapper("photo_1"),this.inputWrapper("photo_2"),this.inputWrapper("photo_3"))))}}class l extends r.A{static defaultProps={...r.A.defaultProps,formUseModalSimple:!0,model:"HubletoApp/Community/Warehouses/Models/Location"};translationContext="HubletoApp\\Community\\Warehouses::Components\\FormLocations";constructor(e){super(e),this.state=this.getStateFromProps(e)}getStateFromProps(e){return{...super.getStateFromProps(e)}}getFormModalProps(){let e=super.getFormModalProps();return e.type="right wide",e}getEndpointParams(){return{...super.getEndpointParams(),idWarehouse:this.props.idWarehouse}}renderForm(){let e=this.getFormProps();return e.description||(e.description={}),e.description.defaultValues={id_warehouse:this.props.idWarehouse},console.log(e.description),s.createElement(i,e)}}class o extends n.A{static defaultProps={...n.A.defaultProps,model:"HubletoApp/Community/Warehouses/Models/Team"};translationContext="HubletoApp\\Community\\Warehouses::Components\\FormWarehouse";constructor(e){super(e)}renderTitle(){return s.createElement(s.Fragment,null,s.createElement("h2",null,"Record #",this.state.record.id??"0"),s.createElement("small",null,"Warehouse"))}renderContent(){return s.createElement(s.Fragment,null,s.createElement("div",{className:"w-full flex gap-2"},s.createElement("div",{className:"flex-1 border-r border-gray-100"},this.inputWrapper("name"),this.inputWrapper("id_type"),this.inputWrapper("operational_status"),this.inputWrapper("id_operation_manager"),this.divider(this.translate("Contact")),this.inputWrapper("contact_person"),this.inputWrapper("contact_email"),this.inputWrapper("contact_phone"),this.divider(this.translate("Capacity and occupancy")),s.createElement("div",{className:"flex gap-2"},s.createElement("div",{className:"w-full"},this.inputWrapper("capacity")),s.createElement("div",{className:"w-full"},this.inputWrapper("capacity_unit"))),this.inputWrapper("current_occupancy")),s.createElement("div",{className:"flex-1"},this.divider(this.translate("Address")),this.inputWrapper("address"),this.inputWrapper("address_plus_code"),this.inputWrapper("lng"),this.inputWrapper("lat"),this.divider(this.translate("More information")),this.inputWrapper("description"),this.inputWrapper("photo_1"),this.inputWrapper("photo_2"),this.inputWrapper("photo_3"))),s.createElement("div",{className:"card mt-2"},s.createElement("div",{className:"card-header"},this.translate("Locations")),s.createElement("div",{className:"card-body"},this.state.id<0?s.createElement("div",{className:"badge badge-info"},"First create warehouse, then you will be prompted to add its locations."):s.createElement(l,{uid:this.props.uid+"_table_locations",parentForm:this,idWarehouse:this.state.id,customEndpointParams:{idWarehouse:this.state.id}}))))}}class c extends r.A{static defaultProps={...r.A.defaultProps,formUseModalSimple:!0,model:"HubletoApp/Community/Warehouses/Models/Warehouse"};translationContext="HubletoApp\\Community\\Warehouses::Components\\FormWarehouses";constructor(e){super(e),this.state=this.getStateFromProps(e)}getStateFromProps(e){return{...super.getStateFromProps(e)}}getFormModalProps(){let e=super.getFormModalProps();return e.type="right wide",e}getEndpointParams(){return{...super.getEndpointParams()}}renderForm(){let e=this.getFormProps();return s.createElement(o,e)}}globalThis.main.registerReactComponent("WarehousesTableWarehouses",c)},7498:(e,t,a)=>{"use strict";a.d(t,{A:()=>l});var s=a(9471),r=a(9605),n=a(9348),i=a(1612);class l extends r.A{translationContext="HubletoApp\\Community\\Pipeline\\Loader::Components\\PipelineSelector";constructor(e){super(e),this.state=this.getStateFromProps(e)}getStateFromProps(e){return{pipelines:null,idPipeline:this.props.idPipeline,idPipelineStep:this.props.idPipelineStep,changePipeline:!1}}componentDidMount(){this.loadPipelines()}loadPipelines(){i.A.get("pipeline/api/get-pipelines",{},e=>{this.setState({pipelines:e.pipelines})})}onPipelineChange(e){this.setState({idPipeline:e},()=>{this.props.onPipelineChange&&this.props.onPipelineChange(e,0)})}onPipelineStepChange(e,t){this.setState({idPipelineStep:e},()=>{this.props.onPipelineStepChange&&this.props.onPipelineStepChange(e,t)})}render(){const e=this.state.pipelines,t=e?e[this.state.idPipeline]?.STEPS:null;if(!e)return s.createElement(n.z,{mode:"indeterminate",style:{height:"8px"}});let a="btn-light";return s.createElement(s.Fragment,null,s.createElement("div",{className:"card mt-2"},s.createElement("div",{className:"card-header"},this.state.changePipeline?s.createElement("div",{className:"input-body"},s.createElement("div",{className:"adios component input"},s.createElement("div",{className:"inner"},s.createElement("div",{className:"input-element"},Object.keys(e).map((t,a)=>s.createElement("button",{key:a,className:"btn "+(this.state.idPipeline==t?"btn-primary":"btn-transparent"),onClick:()=>{this.onPipelineChange(t)}},s.createElement("span",{className:"text"},e[t].name))))))):s.createElement("div",null,e[this.state.idPipeline].name,s.createElement("button",{className:"btn btn-transparent btn-small ml-2",onClick:()=>{this.setState({changePipeline:!0})}},s.createElement("span",{className:"text"},"Change pipeline")))),s.createElement("div",{className:"card-body"},s.createElement("div",{className:"flex flex-row mt-2 flex-wrap"},t&&t.length>0?t.map((e,t)=>("btn-primary"==a?a="btn-transparent":e.id==this.state.idPipelineStep&&(a="btn-primary"),s.createElement("button",{key:t,onClick:()=>this.onPipelineStepChange(e.id,e),className:`btn ${a} border-none rounded-none`},s.createElement("div",{className:"icon p-0",style:{borderTop:"1em solid transparent",borderBottom:"1em solid transparent",borderLeft:"1em solid "+e.color}}),s.createElement("div",{className:"text"},e.name,e.probability?s.createElement("small",{className:"whitespace-nowrap ml-2"},"(",e.probability," %)"):null)))):s.createElement("p",{className:"w-full text-center"},"Pipeline has no steps.")))))}}},7824:(e,t,a)=>{"use strict";var s=a(9471),r=a(4721),n=a(1056),i=a(1612);class l extends r.A{static defaultProps={...r.A.defaultProps,model:"HubletoApp/Community/Settings/Models/User"};translationContext="HubletoApp\\Community\\Settings\\Loader::Components\\FormUser";constructor(e){super(e)}onAfterLoadFormDescription(e){return i.A.get("api/get-apps-info",{},e=>{this.setState({appsInfo:e})}),e}renderTitle(){let e=((this.state.record.first_name??"")+" "+(this.state.record.middle_name??"")+" "+(this.state.record.last_name??"")).trim();return s.createElement(s.Fragment,null,s.createElement("h2",null,""==e?"-":e),s.createElement("small",null,"User"))}renderContent(){const e=this.state.record;let t=[];try{t=JSON.parse(e.apps)}catch(e){t=[]}return t||(t=[]),console.log(this.state.appsInfo,e,t),s.createElement(s.Fragment,null,s.createElement("div",{className:"w-full flex gap-2"},s.createElement("div",{className:"p-4 flex-1 text-center"},s.createElement("i",{className:"fas fa-user text-primary",style:{fontSize:"8em"}})),s.createElement("div",{className:"flex-6"},-1!=this.state.id||globalThis.main.isPremium?s.createElement(s.Fragment,null,s.createElement("div",{className:"flex gap-2 flex-col md:flex-row"},s.createElement("div",{className:"flex-1"},this.divider(this.translate("About the user")),this.inputWrapper("first_name"),this.inputWrapper("last_name"),this.inputWrapper("nick"),this.inputWrapper("email"),this.inputWrapper("language"),this.inputWrapper("id_default_company"),this.divider("Access to Hubleto"),this.inputWrapper("is_active",{readonly:this.state.id==globalThis.main.idUser}),this.inputWrapper("password"),this.divider("Permissions"),this.state.id<0?s.createElement("div",{className:"badge badge-info"},"First create user, then you will be prompted to assign roles."):s.createElement(n.A,{uid:"user_roles",model:"HubletoApp/Community/Settings/Models/UserHasRole",customEndpointParams:{idUser:this.state.id}})),s.createElement("div",{className:"flex-1 md:flex-row"},this.divider("Access to apps"),s.createElement("div",{className:"list"},this.state.appsInfo?s.createElement(s.Fragment,null,Object.keys(this.state.appsInfo).map(e=>{const a=this.state.appsInfo[e],r=a.permittedForAllUsers||t.includes(e);return s.createElement("button",{key:e,className:"btn btn-small btn-list-item "+(a.permittedForAllUsers?"btn-disabled":r?"btn-primary-outline":"btn-transparent"),onClick:()=>{if(!a.permittedForAllUsers){if(t.includes(e)){let a=[];for(let s in t)t[s]!=e&&a.push(t[s]);t=a}else t.push(e);this.updateRecord({apps:JSON.stringify(t)})}}},s.createElement("span",{className:"icon"},s.createElement("i",{className:"fas fa-"+(r?"square-check":"square")})),s.createElement("span",{className:"text"},a.manifest.name))})):null)))):s.createElement("div",{className:"badge badge-warning text-lg w-full block p-8"},"You may add new users only in Premium account.",s.createElement("br",null),s.createElement("br",null),s.createElement("a",{href:globalThis.main.config.rootUrl+"/cloud",className:"btn btn-primary"},s.createElement("span",{className:"icon"},s.createElement("i",{className:"fas fa-medal"})),s.createElement("span",{className:"text"},"Activate Premium account"))))))}}class o extends n.A{static defaultProps={...n.A.defaultProps,formUseModalSimple:!0,model:"HubletoApp/Community/Settings/Models/User"};translationContext="HubletoApp\\Community\\Settings\\Loader::Components\\TableUsers";constructor(e){super(e),this.state=this.getStateFromProps(e)}getFormModalProps(){let e=super.getFormModalProps();return e.type="centered",e}renderCell(e,t,a,r){return"roles"==e?a.ROLES.map((e,t)=>s.createElement("div",{className:"badge",key:a.id+"-roles-"+t},e.role)):"teams"==e?a.TEAMS.map((e,t)=>s.createElement("div",{className:"badge",key:a.id+"-roles-"+t,style:{borderLeft:"1em solid "+e.color}},e.name)):super.renderCell(e,t,a,r)}renderForm(){let e=this.getFormProps();return s.createElement(l,e)}}class c extends r.A{static defaultProps={...r.A.defaultProps,model:"HubletoApp/Community/Settings/Models/UserRole"};translationContext="HubletoApp\\Community\\Settings\\Loader::Components\\FormUserRole";constructor(e){super(e)}getStateFromProps(e){return{...super.getStateFromProps(e)}}renderTitle(){return s.createElement(s.Fragment,null,s.createElement("h2",null,this.state.record.role?this.state.record.role:"[Undefined Name]"))}renderContent(){const e=this.state.record;return e.id,s.createElement(s.Fragment,null,s.createElement("div",{className:"card"},s.createElement("div",{className:"card-body"},this.inputWrapper("role"),this.inputWrapper("description"),this.inputWrapper("grant_all"))),e.grant_all||e.id<=0?null:s.createElement(n.A,{uid:"user_role_permissions",model:"HubletoApp/Community/Settings/Models/RolePermission",customEndpointParams:{idRole:this.state.id}}))}}class d extends n.A{static defaultProps={...n.A.defaultProps,formUseModalSimple:!0,model:"HubletoApp/Community/Settings/Models/UserRole"};translationContext="HubletoApp\\Community\\Settings\\Loader::Components\\TableUserRoles";getFormModalProps(){let e=super.getFormModalProps();return e.type="right",e}constructor(e){super(e),this.state=this.getStateFromProps(e)}renderForm(){let e=this.getFormProps();return s.createElement(c,e)}}class m extends r.A{static defaultProps={...r.A.defaultProps,model:"HubletoApp/Community/Settings/Models/Team"};translationContext="HubletoApp\\Community\\Settings\\Loader::Components\\FormTeam";constructor(e){super(e)}renderTitle(){return s.createElement(s.Fragment,null,s.createElement("h2",null,this.state.record.name??"-"),s.createElement("small",null,"Team"))}renderContent(){return s.createElement(s.Fragment,null,s.createElement("div",{className:"w-full flex gap-2"},s.createElement("div",{className:"p-4 flex-1 text-center"},s.createElement("i",{className:"fas fa-users text-primary",style:{fontSize:"8em"}})),s.createElement("div",{className:"flex-6"},this.inputWrapper("name"),this.inputWrapper("color"),this.inputWrapper("description"),this.inputWrapper("id_manager"),this.divider("Team members"),this.state.id<0?s.createElement("div",{className:"badge badge-info"},"First create team, then you will be prompted to add members."):s.createElement(n.A,{uid:"teams_members",model:"HubletoApp/Community/Settings/Models/TeamMember",customEndpointParams:{idTeam:this.state.id}}))))}}class p extends n.A{static defaultProps={...n.A.defaultProps,formUseModalSimple:!0,model:"HubletoApp/Community/Settings/Models/Team"};translationContext="HubletoApp\\Community\\Settings\\Loader::Components\\TableTeams";constructor(e){super(e),this.state=this.getStateFromProps(e)}getFormModalProps(){let e=super.getFormModalProps();return e.type="centered",e}renderCell(e,t,a,r){return"members"==e?a.MEMBERS.map((e,t)=>s.createElement("div",{className:"badge",key:a.id+"-members-"+t},e.MEMBER.email)):super.renderCell(e,t,a,r)}renderForm(){let e=this.getFormProps();return s.createElement(m,e)}}globalThis.main.registerReactComponent("SettingsFormUser",l),globalThis.main.registerReactComponent("SettingsTableUsers",o),globalThis.main.registerReactComponent("SettingsTableUserRoles",d),globalThis.main.registerReactComponent("SettingsFormTeam",m),globalThis.main.registerReactComponent("SettingsTableTeams",p)},7913:(e,t,a)=>{"use strict";var s=a(9471),r=a(1056),n=a(4721);class i extends n.A{static defaultProps={...n.A.defaultProps,model:"HubletoApp/Community/Dashboards/Models/Dashboard"};translationContext="HubletoApp\\Community\\Dashboards\\Loader::Components\\FormDashboard";constructor(e){super(e)}getStateFromProps(e){return{...super.getStateFromProps(e)}}renderTitle(){return s.createElement(s.Fragment,null,s.createElement("h2",null,this.state.record.title??""))}renderContent(){return this.state.record,s.createElement(s.Fragment,null,s.createElement("div",{className:"card"},s.createElement("div",{className:"card-body"},this.inputWrapper("id_owner"),this.inputWrapper("title"),this.inputWrapper("slug"),this.inputWrapper("color"),this.inputWrapper("is_default"))),this.divider(this.translate("Panels")),this.state.id<0?s.createElement("div",{className:"badge badge-info"},"First create the dashboard, then you will be prompted to add panels."):s.createElement("div",{className:"mt-2"},s.createElement(r.A,{uid:"dashboard_panels",model:"HubletoApp/Community/Dashboards/Models/Panel",customEndpointParams:{idDashboard:this.state.id}})))}}class l extends r.A{static defaultProps={...r.A.defaultProps,formUseModalSimple:!0,model:"HubletoApp/Community/Dashboards/Models/Dashboard"};translationContext="HubletoApp\\Community\\Dashboards\\Loader::Components\\TableDashboards";getFormModalProps(){let e=super.getFormModalProps();return e.type="right",e}constructor(e){super(e),this.state=this.getStateFromProps(e)}renderForm(){let e=this.getFormProps();return e.description||(e.description={}),e.description.defaultValues={idDashboard:this.state.recordId},s.createElement(i,e)}}var o=a(1612),c=a(9348),d=a(9605),m=a(2395);class p extends n.A{static defaultProps={...n.A.defaultProps,model:"HubletoApp/Community/Dashboards/Models/Panel"};translationContext="HubletoApp\\Community\\Documents\\Loader::Components\\FormPanel";constructor(e){super(e),this.state=this.getStateFromProps(e)}getStateFromProps(e){return{...super.getStateFromProps(e)}}renderTitle(){return s.createElement(s.Fragment,null,s.createElement("h2",null,this.state.record.title?this.state.record.title:"-"),s.createElement("small",null,"Dashboard panel"))}renderContent(){return this.state.record,s.createElement(s.Fragment,null,this.inputWrapper("id_dashboard"),this.inputWrapper("board_url_slug",{cssClass:"text-2xl text-primary",onChange:(e,t)=>{const a=e.props.enumValues;this.updateRecord({title:a[t]??"-"})}}),this.inputWrapper("title"),this.inputWrapper("configuration"))}}class u extends d.A{constructor(e){super(e),this.state={panels:this.props.panels,showIdPanel:0}}componentDidMount(){this.loadPanelContents()}loadPanelContents(){let e=this.state.panels;for(let t in e){let a={};try{a=JSON.parse(e[t].configuration??"")}catch(e){a={}}e[t].contentLoaded||o.A.get(e[t].board_url_slug,a??{},a=>{try{this.state.panels[t].contentLoaded=!0,this.state.panels[t].content=a,this.setState({panels:e})}catch(e){console.error(e)}})}}renderPanel(e,t){return s.createElement("div",{key:t,className:"card"},s.createElement("div",{className:"card-header"},e.title,s.createElement("button",{className:"btn btn-transparent btn-small",onClick:()=>{this.setState({showIdPanel:e.id})}},s.createElement("span",{className:"icon"},s.createElement("i",{className:"fas fa-cog"})))),e.contentLoaded?s.createElement("div",{className:"card-body",dangerouslySetInnerHTML:{__html:e.content}}):s.createElement("div",{className:"card-body"},s.createElement(c.z,{mode:"indeterminate",style:{height:"2em"}})))}render(){setTimeout(()=>{globalThis.main.renderReactElements()},100);const e=this.props.panels,t=Array.from(e.slice(0,Math.ceil(e.length/2))),a=Array.from(e.slice(Math.ceil(e.length/2)));return s.createElement(s.Fragment,null,s.createElement("div",{className:"flex flex-col gap-2 md:flex-row"},s.createElement("div",{className:"flex flex-col gap-2"},t.map((e,t)=>this.renderPanel(e,t))),s.createElement("div",{className:"flex flex-col gap-2"},a.map((e,t)=>this.renderPanel(e,t)))),s.createElement("button",{className:"btn btn-add mt-2",onClick:()=>{this.setState({showIdPanel:-1})}},s.createElement("span",{className:"icon"},s.createElement("i",{className:"fas fa-plus"})),s.createElement("span",{className:"text"},this.translate("Add new panel"))),0!=this.state.showIdPanel?s.createElement(m.A,{uid:"add_new_panel_modal",isOpen:!0,type:"right"},s.createElement(p,{uid:"add_new_panel_form",customEndpointParams:{idDashboard:this.props.idDashboard},id:this.state.showIdPanel,showInModal:!0,showInModalSimple:!0,onClose:()=>{this.setState({showIdPanel:0})}})):s.createElement(s.Fragment,null))}}globalThis.main.registerReactComponent("DashboardsDashboard",u),globalThis.main.registerReactComponent("DashboardsTableDashboards",l)},8242:(e,t,a)=>{"use strict";a.d(t,{A:()=>i});var s=a(9471),r=a(4721),n=a(9292);class i extends r.A{static defaultProps={...r.A.defaultProps,model:"HubletoApp/Community/Documents/Models/Document"};translationContext="HubletoApp\\Community\\Documents\\Loader::Components\\FormDocument";constructor(e){super(e),this.state=this.getStateFromProps(e)}getStateFromProps(e){return{...super.getStateFromProps(e)}}renderTitle(){return-1==(0,n.P3)("recordId")?s.createElement("h2",null,this.translate("New Document")):s.createElement(s.Fragment,null,s.createElement("h2",null,this.state.record.name?this.state.record.name:""),s.createElement("small",null,this.translate("Document")))}renderContent(){const e=this.state.record,t=(e.id,!this.state.description.defaultValues?.creatingForModel);return s.createElement(s.Fragment,null,s.createElement("div",{className:"card mt-4"},s.createElement("div",{className:"card-body"},this.inputWrapper("id_folder"),this.inputWrapper("name",{cssClass:"text-2xl text-primary"}),this.inputWrapper("file"),this.inputWrapper("hyperlink"),e.origin_link&&t?s.createElement("a",{href:this.state.record.origin_link,className:"btn brn-primary mt-2"},s.createElement("span",{className:"icon"},s.createElement("i",{className:"fas fa-link"})),s.createElement("span",{className:"text"},this.translate("Go to origin entry"))):s.createElement(s.Fragment,null))))}}},8399:(e,t,a)=>{"use strict";a.d(t,{A:()=>l});var s=a(9471),r=a(6643),n=a(4721);class i extends n.A{static defaultProps={...n.A.defaultProps,model:"HubletoApp/Community/Worksheets/Models/Team",tabs:{default:{title:"Task"}}};translationContext="HubletoApp\\Community\\Worksheets::Components\\FormActivity";constructor(e){super(e)}renderTitle(){return s.createElement(s.Fragment,null,s.createElement("h2",null,"Activity"),s.createElement("small",null))}renderTab(e){if(this.state.record,"default"===e)return s.createElement(s.Fragment,null,s.createElement("div",{className:"flex gap-2 flex-col md:flex-row"},s.createElement("div",{className:"w-full"},this.inputWrapper("id_task")),s.createElement("div",{className:"w-full"},this.inputWrapper("id_worker"))),this.inputWrapper("description"),s.createElement("div",{className:"flex gap-2 flex-col md:flex-row"},s.createElement("div",{className:"w-full"},this.inputWrapper("date_worked"),this.inputWrapper("duration")),s.createElement("div",{className:"w-full"},this.inputWrapper("id_type"),this.inputWrapper("is_approved"),this.inputWrapper("datetime_created"))))}}class l extends r.A{static defaultProps={...r.A.defaultProps,formUseModalSimple:!0,model:"HubletoApp/Community/Worksheets/Models/Activity"};translationContext="HubletoApp\\Community\\Activities::Components\\TableActivities";constructor(e){super(e),this.state=this.getStateFromProps(e)}getStateFromProps(e){return{...super.getStateFromProps(e)}}getFormModalProps(){let e=super.getFormModalProps();return e.type="centered small theme-secondary",e}getEndpointParams(){return{...super.getEndpointParams(),idTask:this.props.idTask}}renderForm(){let e=this.getFormProps();return e.customEndpointParams.idTask=this.props.idTask,e.description||(e.description={}),e.description.defaultValues={id_task:this.props.idTask},s.createElement(i,e)}}},8526:(e,t,a)=>{"use strict";var s=a(9471),r=a(1612),n=a(1056),i=a(4721);class l extends i.A{static defaultProps={...i.A.defaultProps,model:"HubletoApp/Community/Notifications/Models/Notification"};translationContext="HubletoApp\\Community\\Notifications\\Loader::Components\\FormNotification";constructor(e){super(e),this.state=this.getStateFromProps(e)}getStateFromProps(e){return{...super.getStateFromProps(e)}}renderTitle(){return s.createElement(s.Fragment,null,s.createElement("h2",null,this.state.record.subject?this.state.record.subject:""),s.createElement("small",null,"Notification"))}renderContent(){return s.createElement(s.Fragment,null,s.createElement("div",{className:"flex gap-2"},s.createElement("div",{className:"flex-3"},this.inputWrapper("id_to"),this.inputWrapper("subject"),this.inputWrapper("body")),s.createElement("div",{className:"flex-1"},this.inputWrapper("id_from"),this.inputWrapper("priority"),this.inputWrapper("category"),this.inputWrapper("tags"),this.inputWrapper("datetime_sent"),this.inputWrapper("color"))))}}class o extends n.A{static defaultProps={...n.A.defaultProps,formUseModalSimple:!0,orderBy:{field:"id",direction:"desc"},model:"HubletoApp/Community/Notifications/Models/Notification"};translationContext="HubletoApp\\Community\\Notifications\\Loader::Components\\TableNotifications";constructor(e){super(e),this.state={...this.getStateFromProps(e)}}getEndpointParams(){return{...super.getEndpointParams(),folder:this.props.folder}}getFormModalProps(){let e=super.getFormModalProps();return e.type="right",e}rowClassName(e){return"inbox"==this.props.folder?e.read?"":"bg-yellow-50 text-yellow-800":""}renderActionsColumn(e,t){const a=this.findRecordById(e.id);if("inbox"==this.props.folder)return a.read?s.createElement("button",{className:"btn btn-small btn-transparent",onClick:t=>{t.preventDefault(),r.A.get("notifications/api/mark-as-unread",{idNotification:e.id},e=>{this.loadData()})}},s.createElement("span",{className:"icon"},s.createElement("i",{className:"fas fa-eye-slash"})),s.createElement("span",{className:"text"},"Mark as unread")):s.createElement("button",{className:"btn btn-small btn-transparent",onClick:t=>{t.preventDefault(),r.A.get("notifications/api/mark-as-read",{idNotification:e.id},e=>{this.loadData()})}},s.createElement("span",{className:"icon"},s.createElement("i",{className:"fas fa-eye"})),s.createElement("span",{className:"text"},"Mark as read"))}renderForm(){let e=this.getFormProps();return s.createElement(l,e)}}globalThis.main.registerReactComponent("NotificationsTableNotifications",o)},8932:(e,t,a)=>{"use strict";var s=a(8947);globalThis.main.registerReactComponent("ContactsTableContacts",s.A)},8947:(e,t,a)=>{"use strict";a.d(t,{A:()=>o});var s=a(9471),r=a(6643),n=a(5247),i=a(1612),l=a(9348);class o extends r.A{static defaultProps={...r.A.defaultProps,orderBy:{field:"id",direction:"desc"},formUseModalSimple:!0,model:"HubletoApp/Community/Contacts/Models/Contact"};translationContext="HubletoApp\\Community\\Customers\\Loader::Components\\TableContacts";getFormModalProps(){return{...super.getFormModalProps(),type:this.props.customEndpointParams?.idCustomer?"right theme-secondary":"right wide"}}getFormProps(){var e=super.getFormProps();return{...super.getFormProps(),onSaveCallback:(t,a)=>{e.onSaveCallback(t,a),this.props.parentForm&&this.props.parentForm.reload()},onDeleteCallback:(t,a)=>{e.onDeleteCallback(t,a),this.props.parentForm&&this.props.parentForm.reload()}}}onAfterLoadTableDescription(e){return i.A.get("api/table/describe",{model:"HubletoApp/Community/Contacts/Models/Value",idContact:this.props.recordId??e.idContact},e=>{this.setState({tableValuesDescription:e})}),e}renderCell(e,t,a,r){if("virt_tags"==e)return s.createElement(s.Fragment,null,a.TAGS.map((e,t)=>s.createElement("div",{key:t,style:{backgroundColor:e.TAG.color},className:"badge"},e.TAG.name)));if(a.VALUES&&a.VALUES.length>0){if("virt_email"==e){let e=0;return s.createElement("div",{className:"flex flex-row gap-2 flex-wrap max-w-lg"},a.VALUES.map((t,r)=>"email"==t.type&&e<2?(e+=1,s.createElement("div",{className:"border border-gray-400 rounded px-1",key:a.id+"-email-"+r},t.value," ",t.CATEGORY?s.createElement(s.Fragment,null,"(",t.CATEGORY.name,")"):null)):null))}if("virt_number"==e){let e=0;return s.createElement("div",{className:"flex flex-row gap-2 flex-wrap max-w-lg"},a.VALUES.map((t,r)=>"number"==t.type&&e<2?(e+=1,s.createElement("div",{className:"border border-gray-400 rounded px-1",key:a.id+"-number-"+r},t.value," ",t.CATEGORY?s.createElement(s.Fragment,null,"(",t.CATEGORY.name,")"):null)):null))}return super.renderCell(e,t,a,r)}return super.renderCell(e,t,a,r)}renderForm(){let e=this.getFormProps();return e.tableValuesDescription=this.state.tableValuesDescription,s.createElement(n.A,e)}render(){return this.props.parentForm?this.state.data?s.createElement(s.Fragment,null,this.renderHeaderButtons(),this.renderFulltextSearch(),this.renderFormModal(),s.createElement("div",{className:"flex gap-2 flex-wrap mt-2"},Object.keys(this.state.data?.data).map(e=>{const t=this.state.data.data[e];return s.createElement("div",{key:e},s.createElement("button",{className:"btn btn-transparent",onClick:()=>{this.setState({recordId:t.id})}},s.createElement("span",{className:"icon flex flex-col gap-2"},s.createElement("i",{className:"fas fa-user text-2xl"}),t.is_primary?s.createElement("div",{className:"badge badge-violet"},this.translate("Primary")):null),s.createElement("span",{className:"text",style:{maxHeight:"10em"}},s.createElement("div",{className:"flex gap-2"},t.salutation??"",s.createElement("b",null,t.first_name??""),s.createElement("b",null,t.last_name??"")),s.createElement("div",{className:"flex gap-2"},t.TAGS.map((e,t)=>s.createElement("div",{key:t,className:"rounded",style:{color:e.TAG.color,border:"1px solid "+e.TAG.color,padding:"0 3px"}},s.createElement("small",null,e.TAG.name)))),t.VALUES.map((e,t)=>s.createElement("div",{key:t},s.createElement("small",null,e.value))))))}))):s.createElement(l.z,{mode:"indeterminate",style:{height:"8px"}}):super.render()}}},9100:(e,t,a)=>{"use strict";a.d(t,{A:()=>A});var s=a(9471),r=a(6643),n=a(4721),i=a(3568),l=a(436),o=a(1612),c=a(3041),d=a(470),m=a(1056);class p extends m.A{static defaultProps={...m.A.defaultProps,formUseModalSimple:!0,model:"HubletoApp/Community/Leads/Models/LeadDocument"};translationContext="HubletoApp\\Community\\Leads\\Loader::Components\\TableLeadDocuments";constructor(e){super(e),this.state=this.getStateFromProps(e)}getStateFromProps(e){return{...super.getStateFromProps(e)}}}var u=a(2395),h=a(8242),g=a(4876),E=a(2908),b=a(2198),C=a.n(b);class y extends m.A{static defaultProps={...m.A.defaultProps,formUseModalSimple:!0,model:"HubletoApp/Community/Leads/Models/LeadHistory"};translationContext="HubletoApp\\Community\\Leads\\Loader::Components\\TableLeadHistory";constructor(e){super(e),this.state=this.getStateFromProps(e)}getStateFromProps(e){return{...super.getStateFromProps(e)}}}function v(){return v=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},v.apply(null,arguments)}class f extends n.A{static defaultProps={...n.A.defaultProps,model:"HubletoApp/Community/Leads/Models/Lead",tabs:{default:{title:"Lead"},calendar:{title:"Calendar"},documents:{title:"Documents"},history:{title:"History"}}};translationContext="HubletoApp\\Community\\Leads\\Loader::Components\\FormLead";constructor(e){super(e),this.refLogActivityInput=s.createRef(),this.state={...this.getStateFromProps(e),newEntryId:this.props.newEntryId??-1,showIdDocument:0,showIdActivity:0,activityTime:"",activityDate:"",activitySubject:"",activityAllDay:!1,tableLeadDocumentsDescription:null,tablesKey:0}}componentDidUpdate(e,t){t.isInlineEditing!=this.state.isInlineEditing&&this.setState({tablesKey:Math.random()})}getStateFromProps(e){return{...super.getStateFromProps(e)}}onAfterLoadFormDescription(e){return o.A.get("api/table/describe",{model:"HubletoApp/Community/Leads/Models/LeadDocument",idLead:this.state.id},e=>{this.setState({tableLeadDocumentsDescription:e})}),e}onAfterSaveRecord(e){let t=this.getEndpointParams(),a=e.savedRecord.is_archived;0==t.showArchive&&1==a||1==t.showArchive&&0==a?(this.props.onClose(),this.props.parentTable.loadData()):super.onAfterSaveRecord(e)}renderTitle(){return s.createElement(s.Fragment,null,s.createElement("h2",null,this.state.record.title?this.state.record.title:"-"),s.createElement("small",null,"Lead"))}renderSubTitle(){return s.createElement("small",null,this.translate("Lead"))}moveToArchive(e){o.A.get("leads/api/move-to-archive",{recordId:e},e=>{"success"==e.status&&this.props.parentTable.setState({recordId:null},()=>{this.props.parentTable.loadData()})})}moveToArchiveConfirm(e){globalThis.main.showDialogConfirm(s.createElement("div",null,this.translate("Are you sure you want to move this lead to archive?")),{header:this.translate("Move to archive"),yesText:this.translate("Yes, move to archive"),onYes:()=>this.moveToArchive(e),noText:this.translate("No, do not move to archive"),onNo:()=>{}})}logCompletedActivity(){o.A.get("leads/api/log-activity",{idLead:this.state.record.id,activity:this.refLogActivityInput.current.value},e=>{this.loadRecord(),this.refLogActivityInput.current.value=""})}scheduleActivity(){this.setState({showIdActivity:-1,activityDate:C()().add(1,"week").format("YYYY-MM-DD"),activityTime:C()().add(1,"week").format("H:00:00"),activitySubject:this.refLogActivityInput.current.value,activityAllDay:!1})}renderTopMenu(){return s.createElement(s.Fragment,null,super.renderTopMenu(),this.state.record.is_archived?null:s.createElement("a",{className:"btn btn-transparent",onClick:()=>this.moveToArchiveConfirm(this.state.record.id)},s.createElement("span",{className:"icon"},s.createElement("i",{className:"fas fa-box-archive"})),s.createElement("span",{className:"text"},"Move to archive")))}renderTab(e){const t=this.state.record;switch(e){case"default":const e=s.createElement("div",{className:"card card-body shadow-blue-200"},s.createElement("div",{className:"mb-2"},s.createElement(c.A,{onCreateCallback:()=>this.loadRecord(),readonly:t.is_archived,initialView:"dayGridMonth",headerToolbar:{start:"title",center:"",end:"prev,today,next"},eventsEndpoint:globalThis.main.config.rootUrl+"/calendar/api/get-calendar-events?source=leads&idLead="+t.id,onDateClick:(e,t,a)=>{this.setState({activityDate:e,activityTime:t,activityAllDay:!1,showIdActivity:-1})},onEventClick:e=>{this.setState({showIdActivity:parseInt(e.event.id)}),e.jsEvent.preventDefault()}})),s.createElement("div",{className:"adios component input"},s.createElement("div",{className:"input-element w-full flex gap-2"},s.createElement("input",{className:"w-full bg-blue-50 border border-blue-800 p-1 text-blue-800 placeholder-blue-300",placeholder:this.translate("Type recent activity here"),ref:this.refLogActivityInput,onKeyUp:e=>{13==e.keyCode&&(e.shiftKey?this.scheduleActivity():this.logCompletedActivity())},onChange:e=>{this.refLogActivityInput.current.value=e.target.value}}))),s.createElement("div",{className:"mt-2"},s.createElement("button",{onClick:()=>{this.logCompletedActivity()},className:"btn btn-blue-outline btn-small w-full"},s.createElement("span",{className:"icon"},s.createElement("i",{className:"fas fa-check"})),s.createElement("span",{className:"text"},this.translate("Log completed activity")),s.createElement("span",{className:"shortcut"},this.translate("Enter"))),s.createElement("button",{onClick:()=>{this.scheduleActivity()},className:"btn btn-small w-full btn-blue-outline"},s.createElement("span",{className:"icon"},s.createElement("i",{className:"fas fa-clock"})),s.createElement("span",{className:"text"},this.translate("Schedule activity")),s.createElement("span",{className:"shortcut"},this.translate("Shift+Enter")))),this.divider(this.translate("Most recent activities")),t.ACTIVITIES?s.createElement("div",{className:"list"},t.ACTIVITIES.reverse().slice(0,7).map((e,t)=>s.createElement(s.Fragment,null,s.createElement("button",{key:t,className:"btn btn-small btn-transparent btn-list-item "+(e.completed?"bg-green-50":"bg-red-50"),onClick:()=>this.setState({showIdActivity:e.id})},s.createElement("span",{className:"icon"},e.date_start," ",e.time_start,s.createElement("br",null),"@",e["_LOOKUP[id_owner]"]),s.createElement("span",{className:"text"},e.subject,e.completed?null:s.createElement("div",{className:"text-red-800"},this.translate("Not completed yet"))))))):null);return s.createElement(s.Fragment,null,1==t.is_archived?s.createElement("div",{className:"alert-warning mt-2 mb-1"},s.createElement("span",{className:"icon mr-2"},s.createElement("i",{className:"fas fa-triangle-exclamation"})),s.createElement("span",{className:"text"},this.translate("This lead is archived."))):null,s.createElement("div",{className:"flex gap-2 mt-2"},s.createElement("div",{className:"flex-2"},s.createElement("div",{className:"card card-body flex flex-row gap-2"},s.createElement("div",{className:"grow"},s.createElement("div",{className:"flex gap-2"},s.createElement("div",{className:"w-full"},this.inputWrapper("id_campaign",{readonly:t.is_archived})),s.createElement("div",{className:"w-full"},this.inputWrapper("identifier",{readonly:t.is_archived}))),s.createElement(l.A,{title:"Contact",required:!0},s.createElement(d.A,v({},this.getInputProps("id_contact"),{model:"HubletoApp/Community/Contacts/Models/Contact",customEndpointParams:{idCustomer:t.id_customer},readonly:t.is_archived,value:t.id_contact,urlAdd:"contacts/add",onChange:(e,a)=>{this.updateRecord({id_contact:a}),0==t.id_contact&&(t.id_contact=null,this.setState({record:t}))}}))),t.CONTACT&&t.CONTACT.VALUES?s.createElement("div",{className:"ml-4 text-sm p-2 bg-lime-100 text-lime-900 mb-2"},t.CONTACT.VALUES.map((e,t)=>s.createElement("div",{key:t},e.value))):null,this.inputWrapper("title",{cssClass:"text-2xl text-primary",readonly:t.is_archived}),this.inputWrapper("id_level",{readonly:t.is_archived,uiStyle:"buttons"}),this.inputWrapper("status",{readonly:t.is_archived,uiStyle:"buttons",onChange:(e,t)=>{this.updateRecord({lost_reason:null})}}),this.inputWrapper("note",{cssClass:"bg-yellow-50",readonly:t.is_archived}),4==this.state.record.status?this.inputWrapper("lost_reason",{readonly:t.is_archived}):null),s.createElement("div",{className:"border-l border-gray-200"}),s.createElement("div",{className:"grow"},s.createElement("div",{className:"flex flex-row *:w-1/2"},this.inputWrapper("price",{cssClass:"text-2xl",readonly:!!t.is_archived}),this.inputWrapper("id_currency")),this.inputWrapper("score",{readonly:t.is_archived}),this.inputWrapper("id_owner",{readonly:t.is_archived}),this.inputWrapper("id_manager",{readonly:t.is_archived}),this.inputWrapper("id_team",{readonly:t.is_archived}),this.inputWrapper("date_expected_close",{readonly:t.is_archived}),this.inputWrapper("source_channel",{readonly:t.is_archived}),s.createElement(l.A,{title:"Tags"},s.createElement(i.A,v({},this.getInputProps("tags_input"),{value:this.state.record.TAGS,readonly:t.is_archived,model:"HubletoApp/Community/Leads/Models/Tag",targetColumn:"id_lead",sourceColumn:"id_tag",colorColumn:"color",onChange:(e,a)=>{t.TAGS=a,this.setState({record:t})}}))),s.createElement(l.A,{title:"Customer"},s.createElement(d.A,v({},this.getInputProps("id_customer"),{model:"HubletoApp/Community/Customers/Models/Customer",urlAdd:"customers/add",readonly:t.is_archived,value:t.id_customer,onChange:(e,a)=>{this.updateRecord({id_customer:a,id_contact:null}),0==t.id_customer&&(t.id_customer=null,this.setState({record:t}))}}))),this.inputWrapper("shared_folder",{readonly:t.is_archived}),this.inputWrapper("date_created"),this.inputWrapper("is_archived")))),this.state.id>0?e:null));case"calendar":return s.createElement(s.Fragment,null,s.createElement(c.A,{onCreateCallback:()=>this.loadRecord(),readonly:t.is_archived,initialView:"timeGridWeek",views:"timeGridDay,timeGridWeek,dayGridMonth,listYear",eventsEndpoint:globalThis.main.config.rootUrl+"/calendar/api/get-calendar-events?source=leads&idLead="+t.id,onDateClick:(e,t,a)=>{this.setState({activityDate:e,activityTime:t,activityAllDay:!1,showIdActivity:-1})},onEventClick:e=>{this.setState({showIdActivity:parseInt(e.event.id)}),e.jsEvent.preventDefault()}}),0==this.state.showIdActivity?s.createElement(s.Fragment,null):s.createElement(u.A,{uid:"activity_form",isOpen:!0,type:"right"},s.createElement(g.A,{id:this.state.showIdActivity,isInlineEditing:!0,description:{defaultValues:{id_lead:t.id,id_contact:t.id_contact,date_start:this.state.activityDate,time_start:"00:00:00"==this.state.activityTime?null:this.state.activityTime,date_end:this.state.activityDate,all_day:this.state.activityAllDay,subject:this.state.activitySubject}},idCustomer:t.id_customer,showInModal:!0,showInModalSimple:!0,onClose:()=>{this.setState({showIdActivity:0})},onSaveCallback:(e,t)=>{"success"==t.status&&this.setState({showIdActivity:0})}})));case"documents":return s.createElement(s.Fragment,null,s.createElement("div",{className:"divider"},s.createElement("div",null,s.createElement("div",null,s.createElement("div",null)),s.createElement("div",null,s.createElement("span",null,this.translate("Local documents"))))),t.is_archived?null:s.createElement("a",{className:"btn btn-add-outline mb-2",onClick:()=>this.setState({showIdDocument:-1})},s.createElement("span",{className:"icon"},s.createElement("i",{className:"fas fa-add"})),s.createElement("span",{className:"text"},this.translate("Add document"))),s.createElement(p,{key:this.state.tablesKey+"_table_lead_document",uid:this.props.uid+"_table_lead_document",data:{data:t.DOCUMENTS},descriptionSource:"both",customEndpointParams:{idLead:t.id},description:{permissions:this.state.tableLeadDocumentsDescription?.permissions,ui:{showFooter:!1,showHeader:!1},columns:{id_document:{type:"lookup",title:this.translate("Document"),model:"HubletoApp/Community/Documents/Models/Document"},hyperlink:{type:"varchar",title:this.translate("Link"),cellRenderer:(e,t,a)=>s.createElement(l.A,null,s.createElement(E.A,v({},this.getInputProps("link_input"),{value:t.DOCUMENT.hyperlink,readonly:!0})))}},inputs:{id_document:{type:"lookup",title:this.translate("Document"),model:"HubletoApp/Community/Documents/Models/Document"},hyperlink:{type:"varchar",title:this.translate("Link"),readonly:!0}}},isUsedAsInput:!0,readonly:1!=t.is_archived&&!this.state.isInlineEditing,onRowClick:(e,t)=>{this.setState({showIdDocument:t.id_document})},onDeleteSelectionChange:e=>{this.updateRecord({DOCUMENTS:e.state.data?.data??[]}),this.setState({tablesKey:Math.random()})}}),0!=this.state.showIdDocument?s.createElement(u.A,{uid:"document_form",isOpen:!0,type:"right"},s.createElement(h.A,{id:this.state.showIdDocument,onClose:()=>this.setState({showIdDocument:0}),showInModal:!0,descriptionSource:"both",description:{defaultValues:{creatingForModel:"HubletoApp/Community/Leads/Models/LeadDocument",creatingForId:this.state.record.id,origin_link:window.location.pathname+"?recordId="+this.state.record.id}},isInlineEditing:this.state.showIdDocument<0,showInModalSimple:!0,onSaveCallback:(e,t)=>{(t.status="success")&&(this.loadRecord(),this.setState({showIdDocument:0}))},onDeleteCallback:(e,t)=>{(t.status="success")&&(this.loadRecord(),this.setState({showIdDocument:0}))}})):null);case"history":return t.HISTORY&&t.HISTORY.length>0&&t.HISTORY.length>1&&t.HISTORY[0].id<t.HISTORY[t.HISTORY.length-1].id&&(t.HISTORY=this.state.record.HISTORY.reverse()),s.createElement(s.Fragment,null,s.createElement("div",{className:"card"},s.createElement("div",{className:"card-body [&_*]:whitespace-normal"},s.createElement(y,{uid:this.props.uid+"_table_lead_history",data:{data:t.HISTORY},descriptionSource:"props",onRowClick:e=>{},description:{permissions:{canCreate:!1,canDelete:!1,canRead:!0,canUpdate:!1},ui:{showFooter:!1,showHeader:!1},columns:{description:{type:"varchar",title:this.translate("Description")},change_date:{type:"date",title:this.translate("Change Date")}},inputs:{description:{type:"varchar",title:this.translate("Description"),readonly:!0},change_date:{type:"date",title:this.translate("Change Date")}}},readonly:!0}))))}}}var P=a(191);class A extends r.A{static defaultProps={...r.A.defaultProps,orderBy:{field:"id",direction:"desc"},formUseModalSimple:!0,model:"HubletoApp/Community/Leads/Models/Lead"};translationContext="HubletoApp\\Community\\Leads\\Loader::Components\\TableLeads";constructor(e){super(e),this.state={...this.getStateFromProps(e),showSetStatusDialog:!1,rerenderKey:Math.random(),selectedBulkStatus:0}}getFormModalProps(){let e=super.getFormModalProps();return e.type="right wide",e}getEndpointParams(){return{...super.getEndpointParams(),idCustomer:this.props.idCustomer,idCampaign:this.props.idCampaign}}renderCell(e,t,a,r){return"tags"==e?s.createElement(s.Fragment,null,a.TAGS.map((e,t)=>s.createElement("div",{style:{backgroundColor:e.TAG.color},className:"badge",key:a.id+"-tags-"+t},e.TAG.name))):"DEAL"==e?a.DEAL?s.createElement(s.Fragment,null,s.createElement("a",{className:"btn btn-transparent btn-small",href:"deals/"+a.DEAL.id,target:"_blank"},s.createElement("span",{className:"icon"},s.createElement("i",{className:"fas fa-arrow-right"})),s.createElement("span",{className:"text"},a.DEAL.identifier))):null:super.renderCell(e,t,a,r)}onAfterLoadTableDescription(e){return e.columns.DEAL={type:"varchar",title:globalThis.main.translate("Deal")},e}renderForm(){let e=this.getFormProps();return e.customEndpointParams.idCustomer=this.props.idCustomer,e.customEndpointParams.idCampaign=this.props.idCampaign,s.createElement(f,e)}saveBulkStatusChange(){o.A.post("leads/save-bulk-status-change",{record:this.state.selection},{},e=>{"success"==e.status&&(this.setState({showSetStatusDialog:!1,selection:null}),this.loadData())})}bulkStatusChange(e){if(this.state.selection.length>0){let t=this.state.selection;Object.entries(t).map((t,a)=>t[1].status=e),this.setState({selection:t,rerenderKey:Math.random()})}}renderContent(){let e=s.createElement(s.Fragment,null,s.createElement("button",{className:"btn btn-edit",onClick:()=>this.saveBulkStatusChange()},s.createElement("span",{className:"icon"},s.createElement("i",{className:"fas fa-save"})),s.createElement("span",{className:"text"},"Save")));return s.createElement(s.Fragment,null,super.renderContent(),this.state.showSetStatusDialog?s.createElement(P.A,{uid:this.props.uid+"_form_bulk_status_change",isOpen:!0,title:this.translate("Bulk change Lead status"),type:"centered",showHeader:!0,headerLeft:e,onClose:()=>{this.setState({showSetStatusDialog:!1})}},s.createElement(s.Fragment,null,s.createElement("div",{className:"w-[100%] flex flex-row justify-end items-center gap-2 mb-2"},s.createElement("span",{className:"text font-bold"},this.translate("Bulk change status"),":"),s.createElement("select",{className:"w-1/4 mr-[15px]",value:this.state.selectedBulkStatus,onChange:e=>{this.setState({selectedBulkStatus:e.target.value}),this.bulkStatusChange(e.target.value)}},s.createElement("option",{value:0},this.translate("No interaction yet")),s.createElement("option",{value:1},this.translate("Contacted")),s.createElement("option",{value:2},this.translate("In Progress")),s.createElement("option",{value:3},this.translate("Closed")),s.createElement("option",{value:20},"C",this.translate("onverted to deal")))),s.createElement(r.A,{key:this.state.rerenderKey,model:this.model,data:{data:this.state.selection},readonly:!0,uid:this.props.uid+"table_leads_mass_status_change",descriptionSource:"props",isInlineEditing:!0,onRowClick:()=>null,onChange:e=>{this.setState({selection:e.state.data?.data})},description:{columns:{identifier:{type:"varchar",title:this.translate("Identifier"),readonly:!0,cellRenderer:(e,t,a)=>s.createElement(s.Fragment,null,t.identifier)},title:{type:"varchar",title:this.translate("Title"),readonly:!0,cellRenderer:(e,t,a)=>s.createElement(s.Fragment,null,t.title)},company_name:{type:"varchar",title:this.translate("Company"),readonly:!0,cellRenderer:(e,t,a)=>s.createElement(s.Fragment,null,t.CUSTOMER.name)},status:{type:"interger",title:this.translate("Status"),readonly:!0}},inputs:{identifier:{type:"varchar",title:this.translate("Identifier"),readonly:!0},title:{type:"varchar",title:this.translate("Title"),readonly:!0},company_name:{type:"varchar",title:this.translate("Company"),readonly:!0},status:{type:"interger",title:this.translate("Status"),readonly:!0,enumValues:{0:this.translate("No interaction yet"),1:this.translate("Contacted"),2:this.translate("In Progress"),3:this.translate("Closed"),20:this.translate("Converted to deal")}}}}}))):null)}}},9534:(e,t,a)=>{"use strict";a.d(t,{A:()=>c});var s=a(9471),r=a(6643),n=a(4721),i=a(7498),l=a(8399);class o extends n.A{static defaultProps={...n.A.defaultProps,model:"HubletoApp/Community/Tasks/Models/Task",tabs:{default:{title:"Task"}}};translationContext="HubletoApp\\Community\\Tasks::Components\\FormTask";constructor(e){super(e)}renderTitle(){return s.createElement(s.Fragment,null,s.createElement("h2",null,(this.state.record.identifier??"")+" - "+(this.state.record.title??"")),s.createElement("small",null,"Task"))}renderTab(e){const t=this.state.record;if("default"===e)return s.createElement(s.Fragment,null,s.createElement("div",{className:"w-full flex gap-2 flex-col md:flex-row"},s.createElement("div",{className:"flex-1 border-r border-gray-100"},this.inputWrapper("identifier"),this.inputWrapper("title"),this.inputWrapper("description"),this.inputWrapper("id_developer"),this.inputWrapper("id_tester"),this.inputWrapper("shared_folder"),this.inputWrapper("hours_estimation"),this.inputWrapper("is_closed")),s.createElement("div",{className:"flex-1"},this.state.id<=0?null:s.createElement(i.A,{idPipeline:t.id_pipeline,idPipelineStep:t.id_pipeline_step,onPipelineChange:(e,t)=>{this.updateRecord({id_pipeline:e,id_pipeline_step:t})},onPipelineStepChange:e=>{this.updateRecord({id_pipeline_step:e})}}),this.inputWrapper("priority"),this.inputWrapper("duration_days"),this.inputWrapper("date_start"),this.inputWrapper("date_deadline"),this.inputWrapper("is_milestone"),this.inputWrapper("notes"),this.inputWrapper("date_created"),s.createElement("div",{className:"flex w-full gap-2"},this.inputWrapper("external_model"),this.inputWrapper("external_id")))),this.divider("Worksheet"),this.state.id<0?s.createElement("div",{className:"badge badge-info"},"First create the task, then you will be prompted to create leads."):s.createElement(l.A,{uid:this.props.uid+"_table_activities",tag:"TaskActivities",parentForm:this,idTask:t.id}))}}class c extends r.A{static defaultProps={...r.A.defaultProps,formUseModalSimple:!0,model:"HubletoApp/Community/Tasks/Models/Task"};translationContext="HubletoApp\\Community\\Tasks::Components\\TableTasks";constructor(e){super(e),this.state=this.getStateFromProps(e)}getStateFromProps(e){return{...super.getStateFromProps(e)}}getFormModalProps(){let e=super.getFormModalProps();return e.type="right wide",e}getEndpointParams(){return{...super.getEndpointParams(),externalModel:this.props.externalModel,externalId:this.props.externalId}}renderForm(){let e=this.getFormProps();return e.customEndpointParams.externalModel=this.props.externalModel,e.customEndpointParams.externalId=this.props.externalId,e.description||(e.description={}),e.description.defaultValues={external_model:this.props.externalModel,external_id:this.props.externalId},s.createElement(o,e)}}},9768:(e,t,a)=>{"use strict";var s=a(9471),r=a(1612),n=a(1056),i=a(4721);class l extends i.A{static defaultProps={...i.A.defaultProps,model:"HubletoApp/Community/Mail/Models/Mail"};translationContext="HubletoApp\\Community\\Mail\\Loader::Components\\FormMail";constructor(e){super(e),this.state=this.getStateFromProps(e)}getStateFromProps(e){return{...super.getStateFromProps(e)}}renderTitle(){return s.createElement(s.Fragment,null,s.createElement("h2",null,this.state.record.subject?this.state.record.subject:""),s.createElement("small",null,"Mail ",this.state.record.is_template?"Template":null))}sendMail(){}renderSaveButton(){return s.createElement(s.Fragment,null,s.createElement("button",{onClick:()=>this.saveRecord(),className:"btn btn-add-outline"},s.createElement("span",{className:"icon"},s.createElement("i",{className:"fa-solid fa-"+(this.state.record.is_template?"file-lines":"file-pen")})),s.createElement("span",{className:"text"},this.translate(this.state.record.is_template?"Save template":"Save draft"))))}renderHeaderLeft(){return s.createElement(s.Fragment,null,super.renderHeaderLeft(),this.state.record.is_template?null:s.createElement("button",{onClick:()=>this.sendMail(),className:"btn btn-add"},s.createElement("span",{className:"icon"},s.createElement("i",{className:"fas fa-paper-plane"})),s.createElement("span",{className:"text"},this.translate("Send"))))}renderContent(){return s.createElement(s.Fragment,null,s.createElement("div",{className:"flex gap-2"},s.createElement("div",{className:"flex-3"},this.inputWrapper("to"),this.inputWrapper("cc"),this.inputWrapper("bcc"),this.inputWrapper("subject"),this.inputWrapper("body")),s.createElement("div",{className:"flex-1"},this.inputWrapper("from"),this.inputWrapper("priority"),this.inputWrapper("datetime_created"),this.inputWrapper("datetime_sent"),this.inputWrapper("color"),this.inputWrapper("is_draft"),this.inputWrapper("is_template"))))}}class o extends n.A{static defaultProps={...n.A.defaultProps,formUseModalSimple:!0,orderBy:{field:"id",direction:"desc"},model:"HubletoApp/Community/Mail/Models/Mail"};translationContext="HubletoApp\\Community\\Mail\\Loader::Components\\ListFolder";constructor(e){super(e),this.state={...this.getStateFromProps(e)}}getEndpointParams(){return{...super.getEndpointParams(),folder:this.props.folder}}getFormModalProps(){let e=super.getFormModalProps();return e.type="right",e}rowClassName(e){return"inbox"==this.props.folder?e.read?"":"bg-yellow-50 text-yellow-800":""}renderActionsColumn(e,t){const a=this.findRecordById(e.id);if("inbox"==this.props.folder)return a.read?s.createElement("button",{className:"btn btn-small btn-transparent",onClick:t=>{t.preventDefault(),r.A.get("messages/api/mark-as-unread",{idMail:e.id},e=>{this.loadData()})}},s.createElement("span",{className:"icon"},s.createElement("i",{className:"fas fa-eye-slash"})),s.createElement("span",{className:"text"},"Mark as unread")):s.createElement("button",{className:"btn btn-small btn-transparent",onClick:t=>{t.preventDefault(),r.A.get("messages/api/mark-as-read",{idMail:e.id},e=>{this.loadData()})}},s.createElement("span",{className:"icon"},s.createElement("i",{className:"fas fa-eye"})),s.createElement("span",{className:"text"},"Mark as read"))}renderForm(){let e=this.getFormProps();return s.createElement(l,e)}}globalThis.main.registerReactComponent("MailListFolder",o)}},r={};function n(e){var t=r[e];if(void 0!==t)return t.exports;var a=r[e]={id:e,loaded:!1,exports:{}};return s[e].call(a.exports,a,a.exports,n),a.loaded=!0,a.exports}n.m=s,e=[],n.O=(t,a,s,r)=>{if(!a){var i=1/0;for(d=0;d<e.length;d++){for(var[a,s,r]=e[d],l=!0,o=0;o<a.length;o++)(!1&r||i>=r)&&Object.keys(n.O).every(e=>n.O[e](a[o]))?a.splice(o--,1):(l=!1,r<i&&(i=r));if(l){e.splice(d--,1);var c=s();void 0!==c&&(t=c)}}return t}r=r||0;for(var d=e.length;d>0&&e[d-1][2]>r;d--)e[d]=e[d-1];e[d]=[a,s,r]},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},a=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,n.t=function(e,s){if(1&s&&(e=this(e)),8&s)return e;if("object"==typeof e&&e){if(4&s&&e.__esModule)return e;if(16&s&&"function"==typeof e.then)return e}var r=Object.create(null);n.r(r);var i={};t=t||[null,a({}),a([]),a(a)];for(var l=2&s&&e;("object"==typeof l||"function"==typeof l)&&!~t.indexOf(l);l=a(l))Object.getOwnPropertyNames(l).forEach(t=>i[t]=()=>e[t]);return i.default=()=>e,n.d(r,i),r},n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var a=t.getElementsByTagName("script");if(a.length)for(var s=a.length-1;s>-1&&(!e||!/^http(s?):/.test(e));)e=a[s--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})(),(()=>{n.b=document.baseURI||self.location.href;var e={150:0};n.O.j=t=>0===e[t];var t=(t,a)=>{var s,r,[i,l,o]=a,c=0;if(i.some(t=>0!==e[t])){for(s in l)n.o(l,s)&&(n.m[s]=l[s]);if(o)var d=o(n)}for(t&&t(a);c<i.length;c++)r=i[c],n.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return n.O(d)},a=self.webpackChunk_hubleto_project=self.webpackChunk_hubleto_project||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})(),n.nc=void 0,n.O(void 0,[96],()=>n(4432)),n.O(void 0,[96],()=>n(5241)),n.O(void 0,[96],()=>n(6154)),n.O(void 0,[96],()=>n(1596)),n.O(void 0,[96],()=>n(4319)),n.O(void 0,[96],()=>n(8932)),n.O(void 0,[96],()=>n(4358)),n.O(void 0,[96],()=>n(7913)),n.O(void 0,[96],()=>n(3396)),n.O(void 0,[96],()=>n(6901)),n.O(void 0,[96],()=>n(5867)),n.O(void 0,[96],()=>n(1895)),n.O(void 0,[96],()=>n(2213)),n.O(void 0,[96],()=>n(866)),n.O(void 0,[96],()=>n(1767)),n.O(void 0,[96],()=>n(5684)),n.O(void 0,[96],()=>n(3283)),n.O(void 0,[96],()=>n(2062)),n.O(void 0,[96],()=>n(9768)),n.O(void 0,[96],()=>n(8526)),n.O(void 0,[96],()=>n(3266)),n.O(void 0,[96],()=>n(4418)),n.O(void 0,[96],()=>n(6872)),n.O(void 0,[96],()=>n(2850)),n.O(void 0,[96],()=>n(1244)),n.O(void 0,[96],()=>n(7824)),n.O(void 0,[96],()=>n(2233)),n.O(void 0,[96],()=>n(7130)),n.O(void 0,[96],()=>n(7237));var i=n.O(void 0,[96],()=>n(2770));i=n.O(i)})();